<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />


<meta name="author" content="Isobel Beasley" />

<meta name="date" content="2025-09-26" />

<title>Mapping GWAS traits to ICD 10</title>

<script src="site_libs/header-attrs-2.29/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/cosmo.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/jqueryui-1.13.2/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<link href="site_libs/highlightjs-9.12.0/textmate.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>

<link rel="icon" href="https://github.com/workflowr/workflowr-assets/raw/main/img/reproducible.png">
<!-- Add a small amount of space between sections. -->
<style type="text/css">
div.section {
  padding-top: 12px;
}
</style>



<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>









<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark the anchor link active (and if it's in a dropdown, also mark that active)
  var dropdown = menuAnchor.closest('li.dropdown');
  if (window.bootstrap) { // Bootstrap 4+
    menuAnchor.addClass('active');
    dropdown.find('> .dropdown-toggle').addClass('active');
  } else { // Bootstrap 3
    menuAnchor.parent().addClass('active');
    dropdown.addClass('active');
  }

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before, .tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "\e259";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "\e258";
  font-family: 'Glyphicons Halflings';
  border: none;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-bs-toggle="collapse" data-target="#navbar" data-bs-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">genomics_ancest_disease_dispar</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">Home</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">



<h1 class="title toc-ignore">Mapping GWAS traits to ICD 10</h1>
<h4 class="author">Isobel Beasley</h4>
<h4 class="date">2025-09-26</h4>

</div>


<p>
<button type="button" class="btn btn-default btn-workflowr btn-workflowr-report" data-toggle="collapse" data-target="#workflowr-report">
<span class="glyphicon glyphicon-list" aria-hidden="true"></span>
workflowr <span class="glyphicon glyphicon-ok text-success"
aria-hidden="true"></span>
</button>
</p>
<div id="workflowr-report" class="collapse">
<ul class="nav nav-tabs">
<li class="active">
<a data-toggle="tab" href="#summary">Summary</a>
</li>
<li>
<a data-toggle="tab" href="#checks"> Checks <span
class="glyphicon glyphicon-ok text-success" aria-hidden="true"></span>
</a>
</li>
<li>
<a data-toggle="tab" href="#versions">Past versions</a>
</li>
</ul>
<div class="tab-content">
<div id="summary" class="tab-pane fade in active">
<p>
<strong>Last updated:</strong> 2025-10-08
</p>
<p>
<strong>Checks:</strong> <span
class="glyphicon glyphicon-ok text-success" aria-hidden="true"></span> 7
<span class="glyphicon glyphicon-exclamation-sign text-danger"
aria-hidden="true"></span> 0
</p>
<p>
<strong>Knit directory:</strong>
<code>genomics_ancest_disease_dispar/</code> <span
class="glyphicon glyphicon-question-sign" aria-hidden="true"
title="This is the local directory in which the code in this file was executed.">
</span>
</p>
<p>
This reproducible <a href="https://rmarkdown.rstudio.com">R Markdown</a>
analysis was created with <a
  href="https://github.com/workflowr/workflowr">workflowr</a> (version
1.7.1). The <em>Checks</em> tab describes the reproducibility checks
that were applied when the results were created. The <em>Past
versions</em> tab lists the development history.
</p>
<hr>
</div>
<div id="checks" class="tab-pane fade">
<div id="workflowr-checks" class="panel-group">
<div class="panel panel-default">
<div class="panel-heading">
<p class="panel-title">
<a data-toggle="collapse" data-parent="#workflowr-checks" href="#strongRMarkdownfilestronguptodate">
<span class="glyphicon glyphicon-ok text-success"
aria-hidden="true"></span> <strong>R Markdown file:</strong> up-to-date
</a>
</p>
</div>
<div id="strongRMarkdownfilestronguptodate"
class="panel-collapse collapse">
<div class="panel-body">
<p>Great! Since the R Markdown file has been committed to the Git
repository, you know the exact version of the code that produced these
results.</p>
</div>
</div>
</div>
<div class="panel panel-default">
<div class="panel-heading">
<p class="panel-title">
<a data-toggle="collapse" data-parent="#workflowr-checks" href="#strongEnvironmentstrongempty">
<span class="glyphicon glyphicon-ok text-success"
aria-hidden="true"></span> <strong>Environment:</strong> empty </a>
</p>
</div>
<div id="strongEnvironmentstrongempty" class="panel-collapse collapse">
<div class="panel-body">
<p>Great job! The global environment was empty. Objects defined in the
global environment can affect the analysis in your R Markdown file in
unknown ways. For reproduciblity it’s best to always run the code in an
empty environment.</p>
</div>
</div>
</div>
<div class="panel panel-default">
<div class="panel-heading">
<p class="panel-title">
<a data-toggle="collapse" data-parent="#workflowr-checks" href="#strongSeedstrongcodesetseed20220216code">
<span class="glyphicon glyphicon-ok text-success"
aria-hidden="true"></span> <strong>Seed:</strong>
<code>set.seed(20220216)</code> </a>
</p>
</div>
<div id="strongSeedstrongcodesetseed20220216code"
class="panel-collapse collapse">
<div class="panel-body">
<p>The command <code>set.seed(20220216)</code> was run prior to running
the code in the R Markdown file. Setting a seed ensures that any results
that rely on randomness, e.g. subsampling or permutations, are
reproducible.</p>
</div>
</div>
</div>
<div class="panel panel-default">
<div class="panel-heading">
<p class="panel-title">
<a data-toggle="collapse" data-parent="#workflowr-checks" href="#strongSessioninformationstrongrecorded">
<span class="glyphicon glyphicon-ok text-success"
aria-hidden="true"></span> <strong>Session information:</strong>
recorded </a>
</p>
</div>
<div id="strongSessioninformationstrongrecorded"
class="panel-collapse collapse">
<div class="panel-body">
<p>Great job! Recording the operating system, R version, and package
versions is critical for reproducibility.</p>
</div>
</div>
</div>
<div class="panel panel-default">
<div class="panel-heading">
<p class="panel-title">
<a data-toggle="collapse" data-parent="#workflowr-checks" href="#strongCachestrongnone">
<span class="glyphicon glyphicon-ok text-success"
aria-hidden="true"></span> <strong>Cache:</strong> none </a>
</p>
</div>
<div id="strongCachestrongnone" class="panel-collapse collapse">
<div class="panel-body">
<p>Nice! There were no cached chunks for this analysis, so you can be
confident that you successfully produced the results during this
run.</p>
</div>
</div>
</div>
<div class="panel panel-default">
<div class="panel-heading">
<p class="panel-title">
<a data-toggle="collapse" data-parent="#workflowr-checks" href="#strongFilepathsstrongrelative">
<span class="glyphicon glyphicon-ok text-success"
aria-hidden="true"></span> <strong>File paths:</strong> relative </a>
</p>
</div>
<div id="strongFilepathsstrongrelative" class="panel-collapse collapse">
<div class="panel-body">
<p>Great job! Using relative paths to the files within your workflowr
project makes it easier to run your code on other machines.</p>
</div>
</div>
</div>
<div class="panel panel-default">
<div class="panel-heading">
<p class="panel-title">
<a data-toggle="collapse" data-parent="#workflowr-checks" href="#strongRepositoryversionstrongahrefhttpsgithubcomIJbeasleygenomicsancestdiseasedispartreecb8a570c803f4d528369b7b99fca0dcae3fa735ctargetblankcb8a570a">
<span class="glyphicon glyphicon-ok text-success"
aria-hidden="true"></span> <strong>Repository version:</strong>
<a href="https://github.com/IJbeasley/genomics_ancest_disease_dispar/tree/cb8a570c803f4d528369b7b99fca0dcae3fa735c" target="_blank">cb8a570</a>
</a>
</p>
</div>
<div
id="strongRepositoryversionstrongahrefhttpsgithubcomIJbeasleygenomicsancestdiseasedispartreecb8a570c803f4d528369b7b99fca0dcae3fa735ctargetblankcb8a570a"
class="panel-collapse collapse">
<div class="panel-body">
<p>
Great! You are using Git for version control. Tracking code development
and connecting the code version to the results is critical for
reproducibility.
</p>
<p>
The results in this page were generated with repository version
<a href="https://github.com/IJbeasley/genomics_ancest_disease_dispar/tree/cb8a570c803f4d528369b7b99fca0dcae3fa735c" target="_blank">cb8a570</a>.
See the <em>Past versions</em> tab to see a history of the changes made
to the R Markdown and HTML files.
</p>
<p>
Note that you need to be careful to ensure that all relevant files for
the analysis have been committed to Git prior to generating the results
(you can use <code>wflow_publish</code> or
<code>wflow_git_commit</code>). workflowr only checks the R Markdown
file, but you know if there are other scripts or data files that it
depends on. Below is the status of the Git repository when the results
were generated:
</p>
<pre><code>
Ignored files:
    Ignored:    .DS_Store
    Ignored:    .Rproj.user/
    Ignored:    data/.DS_Store
    Ignored:    data/gbd/.DS_Store
    Ignored:    data/gbd/IHME-GBD_2021_DATA-d8cf695e-1.csv
    Ignored:    data/gbd/ihme_gbd_2019_global_disease_burden_rate_all_ages.csv
    Ignored:    data/gbd/ihme_gbd_2019_global_paf_rate_percent_all_ages.csv
    Ignored:    data/gbd/ihme_gbd_2021_global_disease_burden_rate_all_ages.csv
    Ignored:    data/gbd/ihme_gbd_2021_global_paf_rate_percent_all_ages.csv
    Ignored:    data/gwas_catalog/
    Ignored:    data/icd/.DS_Store
    Ignored:    data/icd/IHME_GBD_2019_COD_CAUSE_ICD_CODE_MAP_Y2020M10D15.XLSX
    Ignored:    data/icd/IHME_GBD_2019_NONFATAL_CAUSE_ICD_CODE_MAP_Y2020M10D15.XLSX
    Ignored:    data/icd/IHME_GBD_2021_COD_CAUSE_ICD_CODE_MAP_Y2024M05D16.XLSX
    Ignored:    data/icd/IHME_GBD_2021_NONFATAL_CAUSE_ICD_CODE_MAP_Y2024M05D16.XLSX
    Ignored:    data/icd/UK_Biobank_master_file.tsv
    Ignored:    data/icd/cdc_valid_icd10_Sep_23_2025.xlsx
    Ignored:    data/icd/cdc_valid_icd9_Sep_23_2025.xlsx
    Ignored:    data/icd/manual_disease_icd10_mappings.xlsx
    Ignored:    data/icd/phecode_international_version_unrolled.csv
    Ignored:    data/icd/semiautomatic_ICD-pheno.txt
    Ignored:    data/icd/~$IHME_GBD_2019_COD_CAUSE_ICD_CODE_MAP_Y2020M10D15.XLSX
    Ignored:    data/icd/~$IHME_GBD_2019_NONFATAL_CAUSE_ICD_CODE_MAP_Y2020M10D15.XLSX
    Ignored:    data/who/
    Ignored:    diseases.txt
    Ignored:    manual_icd10_mappings.xlsx
    Ignored:    not_found_diseases.txt
    Ignored:    orig_phecode_map.csv
    Ignored:    original_phecodes_pheinfo.csv
    Ignored:    output/.DS_Store
    Ignored:    output/gwas_cat/
    Ignored:    output/gwas_study_info_cohort_corrected.csv
    Ignored:    output/gwas_study_info_trait_corrected.csv
    Ignored:    output/gwas_study_info_trait_ontology_info.csv
    Ignored:    output/gwas_study_info_trait_ontology_info_l1.csv
    Ignored:    output/gwas_study_info_trait_ontology_info_l2.csv
    Ignored:    output/icd_map/
    Ignored:    output/trait_ontology/
    Ignored:    renv/
    Ignored:    sup_table.xlsx
    Ignored:    zooma.tsv
    Ignored:    zooma_res.tsv

Untracked files:
    Untracked:  analysis/garbage_icd_codes.Rmd
    Untracked:  analysis/gwas_to_gbd.Rmd
    Untracked:  disease_mapping.R

Unstaged changes:
    Modified:   analysis/disease_inves_by_ancest.Rmd
    Modified:   analysis/gbd_data_plots.Rmd
    Modified:   analysis/index.Rmd
    Modified:   analysis/level_1_disease_group_non_cancer.Rmd
    Modified:   analysis/level_2_disease_group.Rmd
    Modified:   analysis/trait_ontology_categorization.Rmd
    Modified:   data/icd/README.md

</code></pre>
<p>
Note that any generated files, e.g. HTML, png, CSS, etc., are not
included in this status report because it is ok for generated content to
have uncommitted changes.
</p>
</div>
</div>
</div>
</div>
<hr>
</div>
<div id="versions" class="tab-pane fade">
<p>
These are the previous versions of the repository in which changes were
made to the R Markdown (<code>analysis/map_trait_to_icd10.Rmd</code>)
and HTML (<code>docs/map_trait_to_icd10.html</code>) files. If you’ve
configured a remote Git repository (see <code>?wflow_git_remote</code>),
click on the hyperlinks in the table below to view the files as they
were in that past version.
</p>
<div class="table-responsive">
<table class="table table-condensed table-hover">
<thead>
<tr>
<th>
File
</th>
<th>
Version
</th>
<th>
Author
</th>
<th>
Date
</th>
<th>
Message
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
Rmd
</td>
<td>
<a href="https://github.com/IJbeasley/genomics_ancest_disease_dispar/blob/cb8a570c803f4d528369b7b99fca0dcae3fa735c/analysis/map_trait_to_icd10.Rmd" target="_blank">cb8a570</a>
</td>
<td>
IJbeasley
</td>
<td>
2025-10-08
</td>
<td>
Updating disease icd code mapping
</td>
</tr>
<tr>
<td>
html
</td>
<td>
<a href="https://rawcdn.githack.com/IJbeasley/genomics_ancest_disease_dispar/41d6fe5b65f1628ed48b63351422535aad788c41/docs/map_trait_to_icd10.html" target="_blank">41d6fe5</a>
</td>
<td>
IJbeasley
</td>
<td>
2025-09-28
</td>
<td>
Build site.
</td>
</tr>
<tr>
<td>
Rmd
</td>
<td>
<a href="https://github.com/IJbeasley/genomics_ancest_disease_dispar/blob/97d340dae80dcce5fec2e5fe2db9d93851769ae1/analysis/map_trait_to_icd10.Rmd" target="_blank">97d340d</a>
</td>
<td>
IJbeasley
</td>
<td>
2025-09-28
</td>
<td>
workflowr::wflow_publish("analysis/map_trait_to_icd10.Rmd")
</td>
</tr>
</tbody>
</table>
</div>
<hr>
</div>
</div>
</div>
<div id="set-up" class="section level1">
<h1>Set up</h1>
<pre class="r"><code>library(dplyr)
library(stringr)
library(data.table)</code></pre>
<div id="ontology-help---for-getting-disease-subtypes"
class="section level2">
<h2>Ontology help - for getting disease subtypes</h2>
<pre class="r"><code>source(here::here(&quot;code/get_term_descendants.R&quot;))</code></pre>
<div id="load-data" class="section level3">
<h3>Load Data</h3>
<pre class="r"><code>gwas_study_info &lt;- fread(here::here(&quot;output/gwas_cat/gwas_study_info_group_v2.csv&quot;))


gwas_study_info = gwas_study_info |&gt;
    mutate(collected_all_disease_terms = stringi::stri_trans_general(collected_all_disease_terms, &quot;Latin-ASCII&quot;)
           )</code></pre>
</div>
</div>
</div>
<div id="automatic-mapping-of-gwas-traits-to-icd-10"
class="section level1">
<h1>Automatic mapping of GWAS traits to ICD 10</h1>
<div id="create-a-mapping-table" class="section level2">
<h2>Create a mapping table</h2>
<pre class="r"><code>disease_mapping &lt;- gwas_study_info |&gt;
  filter(DISEASE_STUDY == T) |&gt;
  filter(collected_all_disease_terms != &quot; &quot;) |&gt;
  filter(collected_all_disease_terms != &quot;&quot;) |&gt;
  tidyr::separate_longer_delim(cols = collected_all_disease_terms, 
                               delim = &quot;, &quot;) |&gt;
  select(`DISEASE/TRAIT`, 
         collected_all_disease_terms, 
         PUBMED_ID) |&gt;
  distinct()

print(&quot;Number of unique disease trait &amp; study pairs&quot;)</code></pre>
<pre><code>[1] &quot;Number of unique disease trait &amp; study pairs&quot;</code></pre>
<pre class="r"><code>nrow(disease_mapping)</code></pre>
<pre><code>[1] 37378</code></pre>
<pre class="r"><code>diseases &lt;- stringr::str_split(pattern = &quot;, &quot;,
                               gwas_study_info$collected_all_disease_terms[gwas_study_info$collected_all_disease_terms != &quot;&quot;])  |&gt;
  unlist() |&gt;
  stringr::str_trim()

diseases &lt;- unique(diseases)

print(&quot;Number of unique disease terms&quot;)</code></pre>
<pre><code>[1] &quot;Number of unique disease terms&quot;</code></pre>
<pre class="r"><code>print(length(diseases))</code></pre>
<pre><code>[1] 1687</code></pre>
</div>
<div id="get-icd10-codes-from-phecodes" class="section level2">
<h2>Get ICD10 codes from PheCodes</h2>
<div id="get-phecodes-for-diseases" class="section level3">
<h3>Get Phecodes for diseases</h3>
<pre class="r"><code>disease_mapping &lt;- disease_mapping |&gt;
  mutate(
    phecode = str_extract(`DISEASE/TRAIT`, &quot;(?&lt;=PheCode )[^)]+&quot;)
  ) |&gt;
  mutate(phecode = as.numeric(phecode))</code></pre>
</div>
<div id="convert-phecodes-to-icd10" class="section level3">
<h3>Convert Phecodes to ICD10</h3>
<pre class="r"><code># phecode to ICD10 mapping from https://wei-lab.app.vumc.org/phecode-data/phecode_international_version

phecodes &lt;- fread(here::here(&quot;data/icd/phecode_international_version_unrolled.csv&quot;))

phecode_icd_map =
  phecodes |&gt;
  select(icd10_code = ICD10, 
         phecode = PheCode
         )

# if more than one ICD10 code per phecode, collapse into a single row
phecode_icd_map =
  phecode_icd_map |&gt;
group_by(phecode) |&gt;
  summarise(icd10_code = 
            str_flatten(unique(icd10_code), collapse = &quot;, &quot;, na.rm = T), 
            .groups = &quot;drop&quot;)

# phecode icd 10 map
phecode_icd_map = 
  phecode_icd_map |&gt;
  mutate(icd10_code_origin = &quot;Study PheCode Mapping&quot;)

disease_mapping =
left_join(disease_mapping,
          phecode_icd_map,
          by = &quot;phecode&quot;,
          relationship = &quot;many-to-one&quot;,
          na_matches = &quot;never&quot;)

# disease_mapping =
#   disease_mapping |&gt;
#   mutate(icd10_code_origin = &quot;Study PheCode&quot;)

disease_mapping |&gt;
  filter(!is.na(icd10_code_origin)) |&gt;
  nrow()</code></pre>
<pre><code>[1] 3273</code></pre>
<pre class="r"><code>disease_mapping |&gt;
  filter(!is.na(icd10_code_origin)) |&gt;
  head()</code></pre>
<pre><code>                                               DISEASE/TRAIT
1                          Neurofibromatosis (PheCode 199.4)
2                   Myeloproliferative disease (PheCode 200)
3                          Polycythemia vera (PheCode 200.1)
4                            Hodgkin&#39;s disease (PheCode 201)
5 Cancer of other lymphoid, histiocytic tissue (PheCode 202)
6                      Non-Hodgkins lymphoma (PheCode 202.2)
  collected_all_disease_terms PUBMED_ID phecode
1           neurofibromatosis  30104761   199.4
2 myeloproliferative disorder  30104761   200.0
3           polycythemia vera  30104761   200.1
4           hodgkins lymphoma  30104761   201.0
5     lymphatic system cancer  30104761   202.0
6       non-hodgkins lymphoma  30104761   202.2
                                                                                                                                                                                           icd10_code
1                                                                                                                                                                                               Q85.0
2                                                                                 C88.7, C94.4, C94.5, D46, D46.0, D46.1, D46.2, D46.4, D46.7, D46.9, D47.0, D47.1, D47.3, D47.7, D47.9, D57.8, D75.2
3                                                                                                                                                                                                 D45
4                                                                                                                                                       C81, C81.0, C81.1, C81.2, C81.3, C81.7, C81.9
5                                                                                                                                                                   C96.0, C96.1, C96.2, C96.3, Z85.7
6 B21.1, C82.0, C82.1, C82.2, C82.7, C83, C83.0, C83.1, C83.2, C83.4, C83.5, C83.6, C83.7, C83.8, C83.9, C84, C84.0, C84.1, C84.2, C84.3, C84.4, C84.5, C85, C85.1, C85.7, C85.9, C96.7, C96.9, L41.2
      icd10_code_origin
1 Study PheCode Mapping
2 Study PheCode Mapping
3 Study PheCode Mapping
4 Study PheCode Mapping
5 Study PheCode Mapping
6 Study PheCode Mapping</code></pre>
</div>
<div id="missing-icd10-codes-for-phecodes" class="section level3">
<h3>Missing ICD10 codes for PheCodes</h3>
<pre class="r"><code>disease_mapping |&gt;
    filter(is.na(icd10_code) &amp; !is.na(phecode)) |&gt; 
    nrow()</code></pre>
<pre><code>[1] 316</code></pre>
<pre class="r"><code>phecode = c(&quot;38.30&quot;,
            &quot;79.90&quot;,
            &quot;110.00&quot;,
            &quot;530.13&quot;,
            &quot;562.20&quot;,
            &quot;580.10&quot;,
            &quot;174.00&quot;,
            &quot;174.20&quot;,
            &quot;189.10&quot;,
            &quot;218.00&quot;,
            &quot;228.10&quot;,
            &quot;224.00&quot;,
            &quot;250.15&quot;,
            &quot;250.25&quot;,
            &quot;250.40&quot;,
            &quot;285.21&quot;,
            &quot;292.11&quot;,
            &quot;362.26&quot;,
            &quot;362.23&quot;,
            &quot;362.27&quot;,
            &quot;362.50&quot;,
            &quot;452.20&quot;,
            &quot;528.10&quot;,
            &quot;535.90&quot;,
            &quot;724.10&quot;,
            &quot;724.22&quot;,
            &quot;740.00&quot;,
            &quot;743.10&quot;,
            &quot;743.12&quot;,
            &quot;743.13&quot;,
            &quot;172.21&quot;,
            &quot;274.00&quot;,
            &quot;286.00&quot;,
            &quot;282.00&quot;,
            &quot;280.00&quot;,
            &quot;272.00&quot;,
            &quot;276.00&quot;,
            &quot;338.00&quot;,
            &quot;350.00&quot;,
            &quot;401.00&quot;,
            &quot;411.00&quot;,
            &quot;414.20&quot;,
            &quot;415.1&quot;,
            &quot;427.21&quot;,
            &quot;429.00&quot;,
            &quot;585.00&quot;,
            &quot;735.22&quot;,
            &quot;724.00&quot;,
            &quot;722.00&quot;,
            &quot;716.10&quot;,
            &quot;709.00&quot;,
            &quot;706.00&quot;,
            &quot;592.00&quot;,
            &quot;571.00&quot;,
            &quot;580.00&quot;,
            &quot;170.00&quot;,
            &quot;172.00&quot;,
            &quot;264.00&quot;,
            &quot;291.00&quot;,
            &quot;555.00&quot;,
            &quot;562.00&quot;,
            &quot;578.00&quot;)

icd10_code = c(&quot;A49.9&quot;,
               &quot;B34.9&quot;,
               &quot;B35, B36&quot;,
               &quot;K22.7&quot;,
               &quot;K57&quot;,
               &quot;N00, N01, N02, N03, N04, N05, N06, N07&quot;,
               &quot;Z85.3&quot;,
               &quot;C50&quot;,
               &quot;C64, C65&quot;,
               &quot;D25, D26&quot;,
               &quot;D18.0&quot;,
               &quot;E00, E00.0, E00.1, E00.2, E00.9, E01.8, E02, E03.0, E03.1, E03.2, E03.3, E03.8, E03.9, E89.0&quot;,
               &quot;E10.5&quot;,
               &quot;E11.5&quot;,
               &quot;R73.0&quot;,
               &quot;D63&quot;,
               &quot;R47.0&quot;,
               &quot;H35.3&quot;,
               &quot;H35.3&quot;,
               &quot;H35.3&quot;,
               &quot;H35.5&quot;,
               &quot;I80&quot;,
               &quot;K12.30&quot;,
               &quot;K29.7, K29.8, K29.9&quot;,
               &quot;M43.2&quot;,
               &quot;M21.5&quot;,
               &quot;M13.9, M15.0, M15.1, M15.2, M15.3, M15.4, M16, M16.0, M16.1, M16.3, M16.6, M16.7, M16.9, M17.1, M17.4, M17.5, M18.0, M18.1, M18.5, M18.9, M19.0, M19.2&quot;,
               &quot;M81&quot;,
               &quot;M81.8&quot;,
               &quot;M81.8&quot;,
               &quot;C44&quot;,
               &quot;M10, M10.0, M10.1, M10.2, M10.4, M10.9, M11.0, M11.1, M11.2, M11.8, M11.9, M67.9&quot;,
               &quot;D65, D66, D67, D68, D68, D68.0, D68.1, D68.2, D68.3, D68.4, D68.8, D68.9, O72.3, O99.1&quot;,
               &quot;D55, D55.0, D55.1, D55.2, D55.3, D55.8, D55.9, D56, D56.0, D56.1, D56.2, D56.3, D56.4, D56.8, D56.9, D57, D57.0, D57.1, D57.2, D57.3, D57.8, D58, D58.0, D58.1, D58.2, D58.8, D58.9, M90.4&quot;,
               &quot;D50, D50.0, D50.1, D50.8, D50.9&quot;,
               &quot;E78.0, E78.1, E78.2, E78.3, E78.4, E78.5, E78.9&quot;,
               &quot;E86, E87.0, E87.1, E87.2, E87.3, E87.4, E87.5, E87.6, E87.7, E87.8, R63.1&quot;,
               &quot;R52.0, R52.2, R52.9&quot;,
               &quot;R25, R25.0, R25.1, R25.2, R25.3, R25.8, R26, R26.0, R26.1, R26.8, R27, R27.0, R27.8, R29.0, R29.2, R43, R43.0, R43.1, R43.2&quot;,
               &quot;I10, I11, I11.0, I11.9, I12, I12.0, I12.9, I13, I13.0, I13.1, I13.2, I13.9, I15, I15.0, I15.1, I15.2, I15.8, I15.9, I67.4&quot;,
               &quot;I20, I20.0, I20.1, I20.8, I20.9, I21, I21.0, I21.1, I21.2, I21.3, I21.4, I21.9, I22, I22.0, I22.1, I22.8, I22.9, I23, I23.0, I23.1, I23.2, I23.3, I23.6, I23.8, I24, I24.0, I24.1, I24.8, I24.9, I25, I25.1, I25.2, I25.3, I25.4, I25.5, I25.6, I25.8, I25.9, I34.1, I51.0, I51.3, Z95.1, Z95.5&quot;,
               &quot;I25.10&quot;,
               &quot;I26, I26.0&quot;,
               &quot;I48&quot;,
               &quot;I51.8&quot;,
               &quot;N17, N17.0, N17.1, N17.2, N17.8, N17.9, N18, N18.0, N18.9, N19, Y60.2, Y61.2, Y62.0, Y84.1, Z49.1, Z49.2, Z99.2&quot;,
               &quot;M21.5&quot;,
               &quot;M40.2, M43.2, M43.8, M48.8, M49.8, M50.0, M99.6&quot;,
               &quot;G55.1, M46.4, M50, M50.0, M50.0, M50.1, M50.2, M50.3, M50.8, M50.9, M51.3, M51.4, M96.1&quot;,
               &quot;M13.0&quot;,
               &quot;L94.3, M33, M33.0, M33.1, M33.2, M33.9, M34, M34.0, M34.1, M34.2, M34.8, M34.9, M35.0, M35.1, M35.5, M35.8, M35.9, M36.0, M36.8, M65.3, N16.4&quot;,
               &quot;K09.8, L70, L70.0, L70.1, L70.2, L70.3, L70.4, L70.5, L70.8, L70.9, L72, L72.0, L72.1, L72.2, L72.8, L72.9, L73.0, L85.3&quot;,
               &quot;N30, N30.0, N30.1, N30.2, N30.3, N30.8, N30.9, N34, N34.0, N34.2, N34.3, N35.1, N37&quot;,
                &quot;K70.4, K72, K72.1, K72.9, K74.0, K74.1, K74.2, K74.3, K74.4, K74.5, K74.6, K75.0, K75.1, K76.0, K76.6, K76.7&quot;,
               &quot;B52.0, N00.0, N00.1, N00.2, N00.3, N00.4, N00.5, N00.6, N00.7, N01, N01.0, N01.1, N01.2, N01.3, N01.4, N01.5, N01.6, N01.7, N01.9, N02.0, N02.1, N02.2, N02.3, N02.4, N02.5, N02.6, N02.7, N03, N03.0, N03.1, N03.2, N03.3, N03.4, N03.5, N03.6, N03.7, N03.9, N04, N04.0, N04.1, N04.2, N04.3, N04.4, N04.5, N04.6, N04.7, N04.8, N04.9, N05, N05.0, N05.1, N05.2, N05.3, N05.4, N05.5, N05.6, N05.7, N05.9, N06.0, N06.1, N06.2, N06.3, N06.4, N06.5, N06.6, N06.7, N07.0, N07.1, N07.2, N07.3, N07.4, N07.5, N07.6, N07.7, N08, N08.1, N08.2, N08.3, N08.4, N08.5, N08.8, N14, N14.0, N14.1, N14.2, N14.3, N14.4, N15.0, N15.8, N16.1, N16.2, N16.3, N16.4, N16.5&quot;,
               &quot;C40, C40.0, C40.1, C40.2, C40.3, C40.8, C40.9, C41, C41.0, C41.1, C41.2, C41.3, C41.4, C41.9, C47, C47.0, C47.1, C47.2, C47.3, C47.4, C47.5, C47.6, C47.8, C47.9, C49, C49.0, C49.1, C49.2, C49.3, C49.4, C49.5, C49.6, C49.8, C49.9&quot;,
&quot;C43, C43.0, C43.1, C43.2, C43.3, C43.4, C43.5, C43.6, C43.7, C43.8, C43.9, C44.0, C44.1, C44.2, C44.3, C44.4, C44.5, C44.6, C44.7, C44.8, C44.9, D03, D03.0, D03.1, D03.2, D03.3, D03.4, D03.5, D03.6, D03.7, D03.8, D03.9, D04, D04.0, D04.1, D04.2, D04.3, D04.4, D04.5, D04.6, D04.7, D04.8, D04.9&quot;,
&quot;R62.0, R62.8, R62.9&quot;,
&quot;F06, F06.1, F07.0, F07.1, F07.2, F07.8, F07.9, F23, F23.0, F23.1, F23.8, F23.9, G47.1, R40.0, R40.1&quot;,
&quot;K50, K50.0, K50.1, K50.8, K50.9, K51, K51.0, K51.1, K51.2, K51.3, K51.4, K51.5, K51.8, K51.9&quot;,
&quot;K57, K57.0, K57.1, K57.2, K57.3, K57.4, K57.5, K57.8, K57.9&quot;,
&quot;K62.5, K92.0, K92.1, K92.2&quot;)

icd10_code_origin = rep(&quot;Study PheCode (Manual Mapping)&quot;, 
                        length(phecode))

to_add = data.frame(phecode, 
                    icd10_code, 
                    icd10_code_origin)

to_add = 
  to_add |&gt;
  mutate(phecode = as.numeric(phecode))

disease_mapping =
  rows_patch(disease_mapping,
             to_add,
             unmatched = &quot;ignore&quot;)</code></pre>
<pre><code>Matching, by = &quot;phecode&quot;</code></pre>
</div>
</div>
<div id="get-icd10-codes-from-author-provided-diseasetrait-column"
class="section level2">
<h2>Get ICD10 codes from author provided DISEASE/TRAIT column</h2>
<pre class="r"><code>disease_mapping =
  disease_mapping |&gt;
  mutate(icd10_code = ifelse(grepl(&quot;ICD10&quot;, `DISEASE/TRAIT`),
                             str_extract(`DISEASE/TRAIT`, &quot;(?&lt;=ICD10 )[^:]+(?=:)&quot;),
                             icd10_code),
         icd10_code_origin = ifelse(grepl(&quot;ICD10&quot;, `DISEASE/TRAIT`),
                                    &quot;Study Provided&quot;,
                                    icd10_code_origin)
)


disease_mapping |&gt;
  filter(icd10_code_origin == &quot;Study Provided&quot;) |&gt;
  nrow()</code></pre>
<pre><code>[1] 3568</code></pre>
<pre class="r"><code># disease_mapping =
# disease_mapping |&gt;
#   group_by(collected_all_disease_terms) |&gt;
#   summarise(icd10_code = str_flatten(unique(icd10_code), 
#                                      collapse = &quot;, &quot;, 
#                                      na.rm = T), 
#             .groups = &quot;drop&quot;)</code></pre>
<div id="how-many-diseases-are-not-mapped-yet" class="section level3">
<h3>How many diseases are not mapped yet?</h3>
<pre class="r"><code>disease_mapping_matched =
  disease_mapping |&gt;
  filter(icd10_code != &quot;&quot; | !is.na(icd10_code))

not_found_diseases &lt;- diseases[!diseases %in% disease_mapping_matched$collected_all_disease_terms] 
not_found_diseases &lt;- not_found_diseases[not_found_diseases != &quot;&quot;]

print(&quot;Number of diseases not mapped to a single ICD10 code yet:&quot;)</code></pre>
<pre><code>[1] &quot;Number of diseases not mapped to a single ICD10 code yet:&quot;</code></pre>
<pre class="r"><code>print(length(not_found_diseases))</code></pre>
<pre><code>[1] 459</code></pre>
</div>
</div>
<div id="get-icd10-codes-by-matching-terms" class="section level2">
<h2>Get ICD10 codes by matching terms</h2>
<div id="match-disease-terms-to-phenotypes-corresponding-to-phecodes"
class="section level3">
<h3>Match disease terms to phenotypes (corresponding to PheCodes)</h3>
<pre class="r"><code>phenotype_icd_map =
  phecodes |&gt;
group_by(Phenotype) |&gt;
  summarise(icd10_code = 
            str_flatten(ICD10, collapse = &quot;, &quot;, na.rm = T), 
            .groups = &quot;drop&quot;)

matched_phenotypes =
phenotype_icd_map #|&gt;
#filter(tolower(Phenotype) %in% not_found_diseases)

matched_phenotypes =
matched_phenotypes |&gt;
  mutate(collected_all_disease_terms = tolower(Phenotype)) |&gt;
  select(collected_all_disease_terms, icd10_code) |&gt;
  mutate(icd10_code_origin = &quot;Phecode Phenotype Match&quot;)

# match by collected_all_disease_terms
disease_mapping = 
disease_mapping |&gt;
rows_patch(matched_phenotypes,
           unmatched = &quot;ignore&quot;)

# match by DISEASE/TRAIT
matched_phenotypes =
  matched_phenotypes |&gt;
  rename(`DISEASE/TRAIT` = collected_all_disease_terms)

disease_mapping =
disease_mapping |&gt;
rows_patch(matched_phenotypes,
           unmatched = &quot;ignore&quot;)

disease_mapping |&gt;
  filter(icd10_code_origin == &quot;Phecode Phenotype Match&quot;) |&gt;
  nrow()</code></pre>
<pre><code>[1] 4596</code></pre>
</div>
<div id="how-many-diseases-are-not-mapped-yet-1" class="section level3">
<h3>How many diseases are not mapped yet?</h3>
<pre class="r"><code># disease_mapping =
#   disease_mapping |&gt;
#   filter(icd10_code != &quot;&quot;)

matched &lt;- c(disease_mapping_matched$collected_all_disease_terms,
             matched_phenotypes$collected_all_disease_terms)</code></pre>
<pre><code>Warning: Unknown or uninitialised column: `collected_all_disease_terms`.</code></pre>
<pre class="r"><code>not_found_diseases &lt;- diseases[!diseases %in% 
                               matched
                               ] 

not_found_diseases &lt;- not_found_diseases[not_found_diseases != &quot;&quot;]

print(length(not_found_diseases))</code></pre>
<pre><code>[1] 459</code></pre>
</div>
<div id="match-disease-terms-to-icd-10-descriptions"
class="section level3">
<h3>Match disease terms to ICD 10 descriptions</h3>
<pre class="r"><code>matched_icd10_desc  = 
phecodes |&gt;
    #filter(tolower(iconv(ICD_DESCRIPTION, to = &quot;UTF-8&quot;)) %in% not_found_diseases) |&gt;
    mutate(collected_all_disease_terms = tolower(iconv(ICD_DESCRIPTION, to = &quot;UTF-8&quot;))) |&gt;
    select(collected_all_disease_terms,    
           icd10_code = ICD10) 


matched_icd10_desc =
  matched_icd10_desc |&gt;
  group_by(collected_all_disease_terms) |&gt;
  summarise(icd10_code = str_flatten(unique(icd10_code), 
                                     collapse = &quot;, &quot;, 
                                     na.rm = T), 
            .groups = &quot;drop&quot;)

# match by collected_all_disease_terms
matched_icd10_desc = 
  matched_icd10_desc |&gt;
    mutate(icd10_code_origin = &quot;ICD Description Match&quot;)

disease_mapping = 
disease_mapping |&gt;
rows_patch(matched_icd10_desc,
           unmatched = &quot;ignore&quot;)

# match by DISEASE/TRAIT
matched_icd10_desc =
  matched_icd10_desc |&gt;
  rename(`DISEASE/TRAIT` = collected_all_disease_terms)

disease_mapping =
  rows_patch(disease_mapping,
             matched_icd10_desc,
             unmatched = &quot;ignore&quot;)

disease_mapping |&gt;
  filter(icd10_code_origin == &quot;ICD Description Match&quot;) |&gt;
  nrow()</code></pre>
<pre><code>[1] 12161</code></pre>
</div>
<div id="how-many-diseases-are-not-mapped-yet-2" class="section level3">
<h3>How many diseases are not mapped yet?</h3>
<pre class="r"><code># disease_mapping =
#   disease_mapping |&gt;
#   filter(icd10_code != &quot;&quot;)

matched &lt;- c(disease_mapping_matched$collected_all_disease_terms,
             matched_phenotypes$collected_all_disease_terms,
             to_add$collected_all_disease_terms)</code></pre>
<pre><code>Warning: Unknown or uninitialised column: `collected_all_disease_terms`.</code></pre>
<pre class="r"><code>not_found_diseases &lt;- diseases[!diseases %in%  matched] 
not_found_diseases &lt;- not_found_diseases[not_found_diseases != &quot;&quot;]

print(length(not_found_diseases))</code></pre>
<pre><code>[1] 459</code></pre>
<pre class="r"><code>disease_mapping |&gt;
  filter(is.na(icd10_code_origin)) |&gt;
  nrow()</code></pre>
<pre><code>[1] 13674</code></pre>
</div>
</div>
</div>
<div id="manual-mapping-of-gwas-traits-to-icd-10"
class="section level1">
<h1>Manual mapping of GWAS traits to ICD 10</h1>
<pre class="r"><code>manual_icd10_map &lt;-
  readxl::read_xlsx(here::here(&quot;data/icd/manual_disease_icd10_mappings.xlsx&quot;))

manual_icd10_map =
  manual_icd10_map |&gt;
  select(collected_all_disease_terms = mapped_trait, 
         icd10_code) |&gt;
  mutate(icd10_code_origin = &quot;Manual Mapping (collected_all_disease_terms)&quot;)

# disease_mapping =
#   bind_rows(disease_mapping, to_add) |&gt;
#   distinct()
disease_mapping =
  rows_patch(disease_mapping,
             manual_icd10_map,
             unmatched = &quot;ignore&quot;)</code></pre>
<pre><code>Matching, by = &quot;collected_all_disease_terms&quot;</code></pre>
<pre class="r"><code>disease_mapping |&gt;
  filter(icd10_code_origin == &quot;Manual Mapping (collected_all_disease_terms)&quot;) |&gt;
  nrow()</code></pre>
<pre><code>[1] 1194</code></pre>
<div id="how-many-diseases-are-not-mapped-yet-3" class="section level3">
<h3>How many diseases are not mapped yet?</h3>
<pre class="r"><code># disease_mapping =
#   disease_mapping |&gt;
#   filter(icd10_code != &quot;&quot;)

matched &lt;- c(disease_mapping_matched$collected_all_disease_terms,
             matched_phenotypes$collected_all_disease_terms,
             to_add$collected_all_disease_terms,
             manual_icd10_map$collected_all_disease_terms)</code></pre>
<pre><code>Warning: Unknown or uninitialised column: `collected_all_disease_terms`.</code></pre>
<pre class="r"><code>not_found_diseases &lt;- diseases[!diseases %in% matched] 
not_found_diseases &lt;- not_found_diseases[not_found_diseases != &quot;&quot;]

print(length(not_found_diseases))</code></pre>
<pre><code>[1] 133</code></pre>
</div>
</div>
<div id="inferring-icd10-codes-from-similar-study-icd10-codes"
class="section level1">
<h1>Inferring ICD10 codes from similar study ICD10 codes</h1>
<pre class="r"><code># similar studies:
study_icd_map =
disease_mapping |&gt;
filter(!is.na(icd10_code)) |&gt;
filter(icd10_code_origin == &quot;Study Provided&quot; | icd10_code_origin == &quot;Study PheCode Mapping&quot;) 

study_icd_map =
  study_icd_map |&gt;
  select(collected_all_disease_terms, icd10_code) |&gt;
  distinct()

study_icd_map =
  study_icd_map |&gt;
  group_by(collected_all_disease_terms) |&gt;
  summarise(icd10_code = str_flatten(unique(sort(icd10_code)), 
                                     collapse = &quot;, &quot;, 
                                     na.rm = T), 
            .groups = &quot;drop&quot;)

study_icd_map = 
  study_icd_map |&gt;
  mutate(icd10_code_origin = &quot;Inferred from similar studies&quot;)

disease_mapping = 
  rows_patch(disease_mapping,
             study_icd_map,
             unmatched = &quot;ignore&quot;)</code></pre>
<pre><code>Matching, by = &quot;collected_all_disease_terms&quot;</code></pre>
<pre class="r"><code>disease_mapping |&gt; 
  filter(!is.na(icd10_code)) |&gt; filter(collected_all_disease_terms == &quot;adhd&quot;)</code></pre>
<pre><code>                                                                                                                                                                                                DISEASE/TRAIT
1                                                                                                                                  Attention deficit hyperactivity disorder and obsessive compulsive disorder
2                                                                                                                                                    Attention deficit hyperactivity disorder or cannabis use
3                                                                                                                                                                    Attention deficit hyperactivity disorder
4                                                                                                                           Response to methylphenidate treatment in attention-deficit/hyperactivity disorder
5                                                                                                                                                                    Attention deficit hyperactivity disorder
6                                                                                                                        Oppositional defiant disorder dimensions in attention-deficit hyperactivity disorder
7                                                                                                                                                Attention function in attention deficit hyperactive disorder
8                                                                                                                                                  Aggressiveness in attention deficit hyperactivity disorder
9                                                                                                                        Oppositional defiant disorder dimensions in attention-deficit hyperactivity disorder
10                                                                                                                                                                   Attention deficit hyperactivity disorder
11                                                                                                                Attention deficit hyperactivity disorder symptoms (maternal expressed emotions interaction)
12                                                                                                                                              Attention deficit hyperactivity disorder and conduct disorder
13                                                                                                                                                                   Attention deficit hyperactivity disorder
14                                                                                                                                               Attention deficit hyperactivity disorder (combined symptoms)
15                                                                                                                              Attention deficit hyperactivity disorder (hyperactivity-impulsivity symptoms)
16                                                                                                                                            Attention deficit hyperactivity disorder (inattention symptoms)
17                                                                                                                                                                   Attention deficit hyperactivity disorder
18                                                                                                                                                   Attention deficit hyperactivity disorder (time to onset)
19                                                                                                                                                                   Attention deficit hyperactivity disorder
20                                                                                                                                                Attention deficit hyperactivity disorder motor coordination
21                                                                                                                                                                   Attention deficit hyperactivity disorder
22                                                                                                                                                                   Attention deficit hyperactivity disorder
23                                                                                                                                                                   Attention deficit hyperactivity disorder
24                                                              Autism spectrum disorder, attention deficit-hyperactivity disorder, bipolar disorder, major depressive disorder, and schizophrenia (combined)
25                                                                                                                                                                   Attention deficit hyperactivity disorder
26                                                                                                                                                                   Attention deficit hyperactivity disorder
27                                                                                                                                                                   Attention deficit hyperactivity disorder
28                                                                                                                                                                   Attention deficit hyperactivity disorder
29                                                                                                                      Executive inhibition (Stroop WIT and CIT) in attention deficit hyperactivity disorder
30                                                                                                                            Bipolar disorder (age of onset &lt;21) or attention deficit hyperactivity disorder
31                                                                                                                                               Bipolar disorder or attention deficit hyperactivity disorder
32                                                                                                                                                 Attention deficit hyperactivity disorder (sex interaction)
33                                                                                                                                                 Sex difference in attention deficit hyperactivity disorder
34                                                                                                                                                                   Attention deficit hyperactivity disorder
35                                                                                                       Attention deficit hyperactivity disorder or educational attainment (years of education) (pleiotropy)
36                                                                                                                                                     Attention deficit hyperactivity disorder symptom score
37                                                                                                              Attention deficit hyperactivity disorder, intelligence or educational attainment (pleiotropy)
38                                                                                                                                                                                 Executive function in ADHD
39                                                                                                                                                                   Attention deficit hyperactivity disorder
40                                                                                                                                                        Persistent attention-deficit hyperactivity disorder
41                                                                                                                                                        Asthma and attention deficit hyperactivity disorder
42                                                                                                                                                                                            Mental disorder
43                                                                                                                                                         Psychiatric disorder without cannabis use disorder
44                                                                                                                          Irritable bowel syndrome or attention-deficit/hyperactivity disorder (pleiotropy)
45                                                                                                                              Peptic ulcer disease or attention-deficit/hyperactivity disorder (pleiotropy)
46                                                                                                                   Gastroesophageal reflux disease or attention-deficit/hyperactivity disorder (pleiotropy)
47                                                                                                                                                                   Attention deficit hyperactivity disorder
48                                                                                                                                                            Attention deficit hyperactivity disorder (MTAG)
49                                                                                                                                                       Substance uses or psychiatric disorders (pleiotropy)
50                                                                                                                                Attention deficit hyperactivity disorder or hippocampal volume (pleiotropy)
51                                                                                                                          Attention deficit hyperactivity disorder or nucleus accumbens volume (pleiotropy)
52                                                                                                                            Attention deficit hyperactivity disorder or caudate nucleus volume (pleiotropy)
53                                                                                                                               Attention deficit hyperactivity disorder or intracranial volume (pleiotropy)
54                                                                                                                                    Attention deficit hyperactivity disorder or putamen volume (pleiotropy)
55                                                                                                                                   Attention deficit hyperactivity disorder or amygdala volume (pleiotropy)
56                                                                                                                                   Attention deficit hyperactivity disorder or pallidum volume (pleiotropy)
57                                                                                                                                   Attention deficit hyperactivity disorder or thalamus volume (pleiotropy)
58                                                                                                                                    Attention deficit hyperactivity disorder (ADuLT model adjusted for sex)
59                                                                                                                                                     Attention deficit hyperactivity disorder (ADuLT model)
60                                                                                                                               Attention deficit hyperactivity disorder (ADuLT model adjusted for age, sex)
61                                                                                                                                   Attention deficit hyperactivity disorder (SPACox model adjusted for sex)
62                                                                                                                                           Attention deficit hyperactivity disorder (adjusted for age, sex)
63                                                                                                                                                Attention deficit hyperactivity disorder (adjusted for sex)
64                                                                                                                                                                   Attention deficit hyperactivity disorder
65                                                                                                                              Attention deficit hyperactivity disorder (SPACox model adjusted for age, sex)
66                                                                                                                              Attention deficit hyperactivity disorder or risk-taking behavior (pleiotropy)
67                                                                                                                       Attention deficit hyperactivity disorder (first diagnosed in adulthood vs childhood)
68                                                                                                                                                                   Attention deficit hyperactivity disorder
69                                                                                                                                         Substance use disorder in attention deficit hyperactivity disorder
70                                                                                                                                       Autism spectrum disorder in attention deficit hyperactivity disorder
71                                                                                                                                      Attention deficit hyperactivity disorder first diagnosed in adulthood
72                                                                                                                            Attention deficit hyperactivity disorder or Substance use disorder (pleiotropy)
73                                                                                                                          Attention deficit hyperactivity disorder or autism spectrum disorder (pleiotropy)
74                                                                                                                                        Attention deficit hyperactivity disorder and Substance use disorder
75                                                                                                                                      Attention deficit hyperactivity disorder and Autism spectrum disorder
76                                                                                                                                            ADHD vs autism spectrum disorder (ordinary least squares (OLS))
77                                                                                                                                       ADHD vs obsessive compulsive disorder (ordinary least squares (OLS))
78                                                                                                                         ADHD vs Tourette&#39;s syndrome and other tic disorders (ordinary least squares (OLS))
79                                                                                                                                                    Bipolar disorder vs ADHD (ordinary least squares (OLS))
80                                                                                                                                           Major depressive disorder vs ADHD (ordinary least squares (OLS))
81                                                                                                                                                       Schizophrenia vs ADHD (ordinary least squares (OLS))
82                                                                                                                                                    ADHD vs anorexia nervosa (ordinary least squares (OLS))
83                                                                                                                                                            Externalizing behaviour (multivariate analysis)
84                                                                                                                                                                   Attention deficit hyperactivity disorder
85                                                                                                                                           Education attainment or attention deficit hyperactivity disorder
86                                                                                                                          Attention deficit hyperactivity disorder or autism spectrum disorder (pleiotropy)
87                                                                                  Type 2 diabetes and Attention deficit hiperactivty disorder or Major depressive disorder or obsessive compulsive disorder
88                                                                                              Type 2 diabetes and Attention deficit hiperactivty disorder or schyzophrenia or obsessive compulsive disorder
89                                                                              Type 2 diabetes and Attention deficit hiperactivty disorder or Anorexia nervosa or Major depressive disorder or schyzophrenia
90                                                                                                                                                Type 2 diabetes and Attention deficit hiperactivty disorder
91                                                                                                                               Type 2 diabetes and Attention deficit hiperactivty disorder or schyzophrenia
92                                                                                                               Type 2 diabetes and Attention deficit hiperactivty disorder or obsessive compulsive disorder
93                                                                                                                            Type 2 diabetes and Attention deficit hiperactivty disorder or Anorexia nervosa
94                                                                                                           Type 2 diabetes and Attention deficit hiperactivty disorder or Anorexia nervosa or schyzophrenia
95                                                                                               Type 2 diabetes and Attention deficit hiperactivty disorder or Anorexia nervosa or Major depressive disorder
96                                                                                           Type 2 diabetes and Attention deficit hiperactivty disorder or Anorexia nervosa or obsessive compulsive disorder
97                                                                                                                   Type 2 diabetes and Attention deficit hiperactivty disorder or Major depressive disorder
98                                                                                                  Type 2 diabetes and Attention deficit hiperactivty disorder or Major depressive disorder or schyzophrenia
99                                                                 Type 2 diabetes and Attention deficit hiperactivty disorder or Major depressive disorder or schyzophrenia or obsessive compulsive disorder
100                                                                         Type 2 diabetes and Attention deficit hiperactivty disorder or Anorexia nervosa or schyzophrenia or obsessive compulsive disorder
101                                                             Type 2 diabetes and Attention deficit hiperactivty disorder or Anorexia nervosa or Major depressive disorder or obsessive compulsive disorder
102                                            Type 2 diabetes and Attention deficit hiperactivty disorder or Anorexia nervosa or Major depressive disorder or schyzophrenia or obsessive compulsive disorder
103                                                                                                                                                  Attention deficit hyperactivity disorder (PheCode 313.1)
104                                                                                                                                                                  Attention deficit hyperactivity disorder
105                                                                                                                                                     Attention deficit hyperactivity disorder (persistent)
106                                                                                                                                                      Attention deficit hyperactivity disorder (childhood)
107                                                                                                                                                           Attention deficit hyperactivity disorder (MTAG)
108                                                                                                                                                                                Neuropsychiatric disorders
109                                                                                                                                                                  Attention deficit hyperactivity disorder
110                                                                                                                                           Attention deficit hyperactivity disorder (inattention symptoms)
111                                                                                                                             Attention deficit hyperactivity disorder (hyperactivity-impulsivity symptoms)
112                                                                                                                                                                  Attention deficit hyperactivity disorder
113                                                                                                                                                               Disruptive behavior (multivariate analysis)
114                                                                                                         Attention deficit hyperactivity disorder or autism spectrum disorder or intelligence (pleiotropy)
115                                                                                                                                                    Executive inhibition (color interference time) in ADHD
116                                                                                                                                                     Executive inhibition (word interference time) in ADHD
117                                                                                                                                                                                           Mental disorder
118                                                                                                                                                      Psychiatric diseases (pleiotropy) (HIPO component 1)
119 Anorexia nervosa, attention-deficit/hyperactivity disorder, autism spectrum disorder, bipolar disorder, major depression, obsessive-compulsive disorder, schizophrenia, or Tourette syndrome (pleiotropy)
120                                                                                                                                           Attention deficit hyperactivity disorder (inattention symptoms)
121                                                                                                                                            Emotional lability in attention deficit hyperactivity disorder
122                                                                                                                                                    Attention deficit hyperactivity disorder symptom score
123                                                                                                                                                                    Stimulant treatment initiation in ADHD
124                                                                                                                                                               Stimulant treatment discontinuation in ADHD
125                                                                                                                                                                 Switch to non-stimulant treatment in ADHD
126                                                                                                                                  Disruptive behavior disorder in attention deficit hyperactivity disorder
127                                                                                                                                                                  Attention deficit hyperactivity disorder
128                                                                                                                                 Disruptive behavior disorder and attention deficit hyperactivity disorder
129                                                                                                                                                      Attention deficit hyperactivity disorder (childhood)
130                                                                                                                                                     Attention deficit hyperactivity disorder (persistent)
131                                                                                                                                                 Attention deficit hyperactivity disorder (late-diagnosed)
132                                                                                             Obesity class I and Attention deficit hyperactivity disorder or Anorexia nervosa or Major depressive disorder
133                                                                                          Obesity class I and Attention deficit hyperactivity disorder or Anorexia nervosa or Obsesive-compulsive disorder
134                                                                                                         Obesity class I and Attention deficit hyperactivity disorder or Anorexia nervosa or Schizophrenia
135                                                                                              Obesity class I and Attention deficit hyperactivity disorder or Anorexia nervosa or Autism spectrum disorder
136                                                                                 Obesity class I and Attention deficit hyperactivity disorder or Major depressive disorder or Obsesive-compulsive disorder
137                                                                                                Obesity class I and Attention deficit hyperactivity disorder or Major depressive disorder or Schizophrenia
138                                                                                     Obesity class I and Attention deficit hyperactivity disorder or Major depressive disorder or Autism spectrum disorder
139                                                                                             Obesity class I and Attention deficit hyperactivity disorder or Obsesive-compulsive disorder or Schizophrenia
140                                                                                  Obesity class I and Attention deficit hyperactivity disorder or Obsesive-compulsive disorder or Autism spectrum disorder
141                                                                                                 Obesity class I and Attention deficit hyperactivity disorder or Schizophrenia or Autism spectrum disorder
142                                                                            Obesity class I and Attention deficit hyperactivity disorder or Anorexia nervosa or Major depressive disorder or Schizophrenia
143                                                                                                                         Obesity class II and Attention deficit hyperactivity disorder or Anorexia nervosa
144                                                                                                                            Obesity class II and Attention deficit hyperactivity disorder or Schizophrenia
145                                                                                                                Obesity class II and Attention deficit hyperactivity disorder or Major depressive disorder
146                                                                                                             Obesity class II and Attention deficit hyperactivity disorder or Obsesive-compulsive disorder
147                                                                                                                 Obesity class I and Attention deficit hyperactivity disorder or Major depressive disorder
148                                                                                                                          Obesity class I and Attention deficit hyperactivity disorder or Anorexia nervosa
149                                                                                                              Obesity class I and Attention deficit hyperactivity disorder or Obsesive-compulsive disorder
150                                                                                                                             Obesity class I and Attention deficit hyperactivity disorder or Schizophrenia
151                                                                                                                  Obesity class I and Attention deficit hyperactivity disorder or Autism spectrum disorder
152                                                             Obesity class I and Attention deficit hyperactivity disorder or Anorexia nervosa or Major depressive disorder or Obsesive-compulsive disorder
153                                                                 Obesity class I and Attention deficit hyperactivity disorder or Anorexia nervosa or Major depressive disorder or Autism spectrum disorder
154                                                                         Obesity class I and Attention deficit hyperactivity disorder or Anorexia nervosa or Obsesive-compulsive disorder or Schizophrenia
155                                                              Obesity class I and Attention deficit hyperactivity disorder or Anorexia nervosa or Obsesive-compulsive disorder or Autism spectrum disorder
156                                                                             Obesity class I and Attention deficit hyperactivity disorder or Anorexia nervosa or Schizophrenia or Autism spectrum disorder
157                                                                Obesity class I and Attention deficit hyperactivity disorder or Major depressive disorder or Obsesive-compulsive disorder or Schizophrenia
158                                                     Obesity class I and Attention deficit hyperactivity disorder or Major depressive disorder or Obsesive-compulsive disorder or Autism spectrum disorder
159                                                                    Obesity class I and Attention deficit hyperactivity disorder or Major depressive disorder or Schizophrenia or Autism spectrum disorder
160                                                                 Obesity class I and Attention deficit hyperactivity disorder or Obsesive-compulsive disorder or Schizophrenia or Autism spectrum disorder
161                                 Obesity class I and Attention deficit hyperactivity disorder or Anorexia nervosa or Major depressive disorder or Obsesive-compulsive disorder or Autism spectrum disorder
162                                            Obesity class I and Attention deficit hyperactivity disorder or Anorexia nervosa or Major depressive disorder or Obsesive-compulsive disorder or Schizophrenia
163                                                Obesity class I and Attention deficit hyperactivity disorder or Anorexia nervosa or Major depressive disorder or Schizophrenia or Autism spectrum disorder
164                                    Obesity class I and Attention deficit hyperactivity disorder or Major depressive disorder or Obsesive-compulsive disorder or Schizophrenia or Autism spectrum disorder
165                                             Obesity class I and Attention deficit hyperactivity disorder or Anorexia nervosa or Obsesive-compulsive disorder or Schizophrenia or Autism spectrum disorder
166                Obesity class I and Attention deficit hyperactivity disorder or Anorexia nervosa or Major depressive disorder or Obsesive-compulsive disorder or Schizophrenia or Autism spectrum disorder
167                                                                                                                                             Obesity class II and attention deficit hyperactivity disorder
168                                                                                            Obesity class II and Attention deficit hyperactivity disorder or Anorexia nervosa or Major depressive disorder
169                                                                                         Obesity class II and Attention deficit hyperactivity disorder or Anorexia nervosa or Obsesive-compulsive disorder
170                                                                                Obesity class II and Attention deficit hyperactivity disorder or Major depressive disorder or Obsesive-compulsive disorder
171                                                                                                        Obesity class II and Attention deficit hyperactivity disorder or Anorexia nervosa or Schizophrenia
172                                                                                               Obesity class II and Attention deficit hyperactivity disorder or Major depressive disorder or Schizophrenia
173                                                                                            Obesity class II and Attention deficit hyperactivity disorder or Obsesive-compulsive disorder or Schizophrenia
174                                                            Obesity class II and Attention deficit hyperactivity disorder or Anorexia nervosa or Major depressive disorder or Obsesive-compulsive disorder
175                                                                           Obesity class II and Attention deficit hyperactivity disorder or Anorexia nervosa or Major depressive disorder or Schizophrenia
176                                                                        Obesity class II and Attention deficit hyperactivity disorder or Anorexia nervosa or Obsesive-compulsive disorder or Schizophrenia
177                                                               Obesity class II and Attention deficit hyperactivity disorder or Major depressive disorder or Obsesive-compulsive disorder or Schizophrenia
178                                           Obesity class II and Attention deficit hyperactivity disorder or Anorexia nervosa or Major depressive disorder or Obsesive-compulsive disorder or Schizophrenia
179                                                                                                                                            Obesity class III and attention deficit hyperactivity disorder
180                                                                                                                        Obesity class III and Attention deficit hyperactivity disorder or Anorexia nervosa
181                                                                                                               Obesity class III and Attention deficit hyperactivity disorder or Major depressive disorder
182                                                                                           Obesity class III and Attention deficit hyperactivity disorder or Anorexia nervosa or Major depressive disorder
183                                                                                                                                              Obesity class I and Attention deficit hyperactivity disorder
    collected_all_disease_terms PUBMED_ID phecode        icd10_code
1                          adhd  28386217      NA F90, F90.1, F90.9
2                          adhd  30610198      NA F90, F90.1, F90.9
3                          adhd  28809852      NA F90, F90.1, F90.9
4                          adhd  29382897      NA F90, F90.1, F90.9
5                          adhd  30478444      NA F90, F90.1, F90.9
6                          adhd  26184070      NA F90, F90.1, F90.9
7                          adhd  26174813      NA F90, F90.1, F90.9
8                          adhd  27021288      NA F90, F90.1, F90.9
9                          adhd  27021288      NA F90, F90.1, F90.9
10                         adhd  20732626      NA F90, F90.1, F90.9
11                         adhd  18846501      NA F90, F90.1, F90.9
12                         adhd  18951430      NA F90, F90.1, F90.9
13                         adhd  20732627      NA F90, F90.1, F90.9
14                         adhd  23527680      NA F90, F90.1, F90.9
15                         adhd  23527680      NA F90, F90.1, F90.9
16                         adhd  23527680      NA F90, F90.1, F90.9
17                         adhd  22420046      NA F90, F90.1, F90.9
18                         adhd  18937294      NA F90, F90.1, F90.9
19                         adhd  18821565      NA F90, F90.1, F90.9
20                         adhd  21473668      NA F90, F90.1, F90.9
21                         adhd  18839057      NA F90, F90.1, F90.9
22                         adhd  23728934      NA F90, F90.1, F90.9
23                         adhd  20732625      NA F90, F90.1, F90.9
24                         adhd  23453885      NA F90, F90.1, F90.9
25                         adhd  18980221      NA F90, F90.1, F90.9
26                         adhd  21784300      NA F90, F90.1, F90.9
27                         adhd  22012869      NA F90, F90.1, F90.9
28                         adhd  18821564      NA F90, F90.1, F90.9
29                         adhd  28416812      NA F90, F90.1, F90.9
30                         adhd  27890468      NA F90, F90.1, F90.9
31                         adhd  27890468      NA F90, F90.1, F90.9
32                         adhd  29325848      NA F90, F90.1, F90.9
33                         adhd  29325848      NA F90, F90.1, F90.9
34                         adhd  29325848      NA F90, F90.1, F90.9
35                         adhd  29413154      NA F90, F90.1, F90.9
36                         adhd  27663945      NA F90, F90.1, F90.9
37                         adhd  32061372      NA F90, F90.1, F90.9
38                         adhd  29769613      NA F90, F90.1, F90.9
39                         adhd  25875332      NA F90, F90.1, F90.9
40                         adhd  25284319      NA F90, F90.1, F90.9
41                         adhd  31619474      NA F90, F90.1, F90.9
42                         adhd  31209380      NA F90, F90.1, F90.9
43                         adhd  31209380      NA F90, F90.1, F90.9
44                         adhd  36753304      NA F90, F90.1, F90.9
45                         adhd  36753304      NA F90, F90.1, F90.9
46                         adhd  36753304      NA F90, F90.1, F90.9
47                         adhd  32606422      NA F90, F90.1, F90.9
48                         adhd  32606422      NA F90, F90.1, F90.9
49                         adhd  32762793      NA F90, F90.1, F90.9
50                         adhd  30818988      NA F90, F90.1, F90.9
51                         adhd  30818988      NA F90, F90.1, F90.9
52                         adhd  30818988      NA F90, F90.1, F90.9
53                         adhd  30818988      NA F90, F90.1, F90.9
54                         adhd  30818988      NA F90, F90.1, F90.9
55                         adhd  30818988      NA F90, F90.1, F90.9
56                         adhd  30818988      NA F90, F90.1, F90.9
57                         adhd  30818988      NA F90, F90.1, F90.9
58                         adhd  37689771      NA F90, F90.1, F90.9
59                         adhd  37689771      NA F90, F90.1, F90.9
60                         adhd  37689771      NA F90, F90.1, F90.9
61                         adhd  37689771      NA F90, F90.1, F90.9
62                         adhd  37689771      NA F90, F90.1, F90.9
63                         adhd  37689771      NA F90, F90.1, F90.9
64                         adhd  37689771      NA F90, F90.1, F90.9
65                         adhd  37689771      NA F90, F90.1, F90.9
66                         adhd  38565336      NA F90, F90.1, F90.9
67                         adhd  38036780      NA F90, F90.1, F90.9
68                         adhd  38036780      NA F90, F90.1, F90.9
69                         adhd  38036780      NA F90, F90.1, F90.9
70                         adhd  38036780      NA F90, F90.1, F90.9
71                         adhd  38036780      NA F90, F90.1, F90.9
72                         adhd  38036780      NA F90, F90.1, F90.9
73                         adhd  38036780      NA F90, F90.1, F90.9
74                         adhd  38036780      NA F90, F90.1, F90.9
75                         adhd  38036780      NA F90, F90.1, F90.9
76                         adhd  33686288      NA F90, F90.1, F90.9
77                         adhd  33686288      NA F90, F90.1, F90.9
78                         adhd  33686288      NA F90, F90.1, F90.9
79                         adhd  33686288      NA F90, F90.1, F90.9
80                         adhd  33686288      NA F90, F90.1, F90.9
81                         adhd  33686288      NA F90, F90.1, F90.9
82                         adhd  33686288      NA F90, F90.1, F90.9
83                         adhd  34446935      NA F90, F90.1, F90.9
84                         adhd  37865391      NA F90, F90.1, F90.9
85                         adhd  38250258      NA F90, F90.1, F90.9
86                         adhd  35717853      NA F90, F90.1, F90.9
87                         adhd  36738649      NA F90, F90.1, F90.9
88                         adhd  36738649      NA F90, F90.1, F90.9
89                         adhd  36738649      NA F90, F90.1, F90.9
90                         adhd  36738649      NA F90, F90.1, F90.9
91                         adhd  36738649      NA F90, F90.1, F90.9
92                         adhd  36738649      NA F90, F90.1, F90.9
93                         adhd  36738649      NA F90, F90.1, F90.9
94                         adhd  36738649      NA F90, F90.1, F90.9
95                         adhd  36738649      NA F90, F90.1, F90.9
96                         adhd  36738649      NA F90, F90.1, F90.9
97                         adhd  36738649      NA F90, F90.1, F90.9
98                         adhd  36738649      NA F90, F90.1, F90.9
99                         adhd  36738649      NA F90, F90.1, F90.9
100                        adhd  36738649      NA F90, F90.1, F90.9
101                        adhd  36738649      NA F90, F90.1, F90.9
102                        adhd  36738649      NA F90, F90.1, F90.9
103                        adhd  39024449   313.1 F90, F90.1, F90.9
104                        adhd  32279069      NA F90, F90.1, F90.9
105                        adhd  32279069      NA F90, F90.1, F90.9
106                        adhd  32279069      NA F90, F90.1, F90.9
107                        adhd  33479212      NA F90, F90.1, F90.9
108                        adhd  33479212      NA F90, F90.1, F90.9
109                        adhd  30563984      NA F90, F90.1, F90.9
110                        adhd  32595297      NA F90, F90.1, F90.9
111                        adhd  32595297      NA F90, F90.1, F90.9
112                        adhd  32595297      NA F90, F90.1, F90.9
113                        adhd  36324656      NA F90, F90.1, F90.9
114                        adhd  35764056      NA F90, F90.1, F90.9
115                        adhd  38430954      NA F90, F90.1, F90.9
116                        adhd  38430954      NA F90, F90.1, F90.9
117                        adhd  30692689      NA F90, F90.1, F90.9
118                        adhd  30289880      NA F90, F90.1, F90.9
119                        adhd  31835028      NA F90, F90.1, F90.9
120                        adhd  31959275      NA F90, F90.1, F90.9
121                        adhd  31085060      NA F90, F90.1, F90.9
122                        adhd  30659475      NA F90, F90.1, F90.9
123                        adhd  34154395      NA F90, F90.1, F90.9
124                        adhd  34154395      NA F90, F90.1, F90.9
125                        adhd  34154395      NA F90, F90.1, F90.9
126                        adhd  33495439      NA F90, F90.1, F90.9
127                        adhd  33495439      NA F90, F90.1, F90.9
128                        adhd  33495439      NA F90, F90.1, F90.9
129                        adhd  35927488      NA F90, F90.1, F90.9
130                        adhd  35927488      NA F90, F90.1, F90.9
131                        adhd  35927488      NA F90, F90.1, F90.9
132                        adhd  36137488      NA F90, F90.1, F90.9
133                        adhd  36137488      NA F90, F90.1, F90.9
134                        adhd  36137488      NA F90, F90.1, F90.9
135                        adhd  36137488      NA F90, F90.1, F90.9
136                        adhd  36137488      NA F90, F90.1, F90.9
137                        adhd  36137488      NA F90, F90.1, F90.9
138                        adhd  36137488      NA F90, F90.1, F90.9
139                        adhd  36137488      NA F90, F90.1, F90.9
140                        adhd  36137488      NA F90, F90.1, F90.9
141                        adhd  36137488      NA F90, F90.1, F90.9
142                        adhd  36137488      NA F90, F90.1, F90.9
143                        adhd  36137488      NA F90, F90.1, F90.9
144                        adhd  36137488      NA F90, F90.1, F90.9
145                        adhd  36137488      NA F90, F90.1, F90.9
146                        adhd  36137488      NA F90, F90.1, F90.9
147                        adhd  36137488      NA F90, F90.1, F90.9
148                        adhd  36137488      NA F90, F90.1, F90.9
149                        adhd  36137488      NA F90, F90.1, F90.9
150                        adhd  36137488      NA F90, F90.1, F90.9
151                        adhd  36137488      NA F90, F90.1, F90.9
152                        adhd  36137488      NA F90, F90.1, F90.9
153                        adhd  36137488      NA F90, F90.1, F90.9
154                        adhd  36137488      NA F90, F90.1, F90.9
155                        adhd  36137488      NA F90, F90.1, F90.9
156                        adhd  36137488      NA F90, F90.1, F90.9
157                        adhd  36137488      NA F90, F90.1, F90.9
158                        adhd  36137488      NA F90, F90.1, F90.9
159                        adhd  36137488      NA F90, F90.1, F90.9
160                        adhd  36137488      NA F90, F90.1, F90.9
161                        adhd  36137488      NA F90, F90.1, F90.9
162                        adhd  36137488      NA F90, F90.1, F90.9
163                        adhd  36137488      NA F90, F90.1, F90.9
164                        adhd  36137488      NA F90, F90.1, F90.9
165                        adhd  36137488      NA F90, F90.1, F90.9
166                        adhd  36137488      NA F90, F90.1, F90.9
167                        adhd  36137488      NA F90, F90.1, F90.9
168                        adhd  36137488      NA F90, F90.1, F90.9
169                        adhd  36137488      NA F90, F90.1, F90.9
170                        adhd  36137488      NA F90, F90.1, F90.9
171                        adhd  36137488      NA F90, F90.1, F90.9
172                        adhd  36137488      NA F90, F90.1, F90.9
173                        adhd  36137488      NA F90, F90.1, F90.9
174                        adhd  36137488      NA F90, F90.1, F90.9
175                        adhd  36137488      NA F90, F90.1, F90.9
176                        adhd  36137488      NA F90, F90.1, F90.9
177                        adhd  36137488      NA F90, F90.1, F90.9
178                        adhd  36137488      NA F90, F90.1, F90.9
179                        adhd  36137488      NA F90, F90.1, F90.9
180                        adhd  36137488      NA F90, F90.1, F90.9
181                        adhd  36137488      NA F90, F90.1, F90.9
182                        adhd  36137488      NA F90, F90.1, F90.9
183                        adhd  36137488      NA F90, F90.1, F90.9
                icd10_code_origin
1   Inferred from similar studies
2   Inferred from similar studies
3   Inferred from similar studies
4   Inferred from similar studies
5   Inferred from similar studies
6   Inferred from similar studies
7   Inferred from similar studies
8   Inferred from similar studies
9   Inferred from similar studies
10  Inferred from similar studies
11  Inferred from similar studies
12  Inferred from similar studies
13  Inferred from similar studies
14  Inferred from similar studies
15  Inferred from similar studies
16  Inferred from similar studies
17  Inferred from similar studies
18  Inferred from similar studies
19  Inferred from similar studies
20  Inferred from similar studies
21  Inferred from similar studies
22  Inferred from similar studies
23  Inferred from similar studies
24  Inferred from similar studies
25  Inferred from similar studies
26  Inferred from similar studies
27  Inferred from similar studies
28  Inferred from similar studies
29  Inferred from similar studies
30  Inferred from similar studies
31  Inferred from similar studies
32  Inferred from similar studies
33  Inferred from similar studies
34  Inferred from similar studies
35  Inferred from similar studies
36  Inferred from similar studies
37  Inferred from similar studies
38  Inferred from similar studies
39  Inferred from similar studies
40  Inferred from similar studies
41  Inferred from similar studies
42  Inferred from similar studies
43  Inferred from similar studies
44  Inferred from similar studies
45  Inferred from similar studies
46  Inferred from similar studies
47  Inferred from similar studies
48  Inferred from similar studies
49  Inferred from similar studies
50  Inferred from similar studies
51  Inferred from similar studies
52  Inferred from similar studies
53  Inferred from similar studies
54  Inferred from similar studies
55  Inferred from similar studies
56  Inferred from similar studies
57  Inferred from similar studies
58  Inferred from similar studies
59  Inferred from similar studies
60  Inferred from similar studies
61  Inferred from similar studies
62  Inferred from similar studies
63  Inferred from similar studies
64  Inferred from similar studies
65  Inferred from similar studies
66  Inferred from similar studies
67  Inferred from similar studies
68  Inferred from similar studies
69  Inferred from similar studies
70  Inferred from similar studies
71  Inferred from similar studies
72  Inferred from similar studies
73  Inferred from similar studies
74  Inferred from similar studies
75  Inferred from similar studies
76  Inferred from similar studies
77  Inferred from similar studies
78  Inferred from similar studies
79  Inferred from similar studies
80  Inferred from similar studies
81  Inferred from similar studies
82  Inferred from similar studies
83  Inferred from similar studies
84  Inferred from similar studies
85  Inferred from similar studies
86  Inferred from similar studies
87  Inferred from similar studies
88  Inferred from similar studies
89  Inferred from similar studies
90  Inferred from similar studies
91  Inferred from similar studies
92  Inferred from similar studies
93  Inferred from similar studies
94  Inferred from similar studies
95  Inferred from similar studies
96  Inferred from similar studies
97  Inferred from similar studies
98  Inferred from similar studies
99  Inferred from similar studies
100 Inferred from similar studies
101 Inferred from similar studies
102 Inferred from similar studies
103         Study PheCode Mapping
104 Inferred from similar studies
105 Inferred from similar studies
106 Inferred from similar studies
107 Inferred from similar studies
108 Inferred from similar studies
109 Inferred from similar studies
110 Inferred from similar studies
111 Inferred from similar studies
112 Inferred from similar studies
113 Inferred from similar studies
114 Inferred from similar studies
115 Inferred from similar studies
116 Inferred from similar studies
117 Inferred from similar studies
118 Inferred from similar studies
119 Inferred from similar studies
120 Inferred from similar studies
121 Inferred from similar studies
122 Inferred from similar studies
123 Inferred from similar studies
124 Inferred from similar studies
125 Inferred from similar studies
126 Inferred from similar studies
127 Inferred from similar studies
128 Inferred from similar studies
129 Inferred from similar studies
130 Inferred from similar studies
131 Inferred from similar studies
132 Inferred from similar studies
133 Inferred from similar studies
134 Inferred from similar studies
135 Inferred from similar studies
136 Inferred from similar studies
137 Inferred from similar studies
138 Inferred from similar studies
139 Inferred from similar studies
140 Inferred from similar studies
141 Inferred from similar studies
142 Inferred from similar studies
143 Inferred from similar studies
144 Inferred from similar studies
145 Inferred from similar studies
146 Inferred from similar studies
147 Inferred from similar studies
148 Inferred from similar studies
149 Inferred from similar studies
150 Inferred from similar studies
151 Inferred from similar studies
152 Inferred from similar studies
153 Inferred from similar studies
154 Inferred from similar studies
155 Inferred from similar studies
156 Inferred from similar studies
157 Inferred from similar studies
158 Inferred from similar studies
159 Inferred from similar studies
160 Inferred from similar studies
161 Inferred from similar studies
162 Inferred from similar studies
163 Inferred from similar studies
164 Inferred from similar studies
165 Inferred from similar studies
166 Inferred from similar studies
167 Inferred from similar studies
168 Inferred from similar studies
169 Inferred from similar studies
170 Inferred from similar studies
171 Inferred from similar studies
172 Inferred from similar studies
173 Inferred from similar studies
174 Inferred from similar studies
175 Inferred from similar studies
176 Inferred from similar studies
177 Inferred from similar studies
178 Inferred from similar studies
179 Inferred from similar studies
180 Inferred from similar studies
181 Inferred from similar studies
182 Inferred from similar studies
183 Inferred from similar studies</code></pre>
<pre class="r"><code>icd10_code = c(&quot;F90, F90.1, F90.9&quot;,
               &quot;F00. G30&quot;,
               &quot;O45&quot;,
               &quot;H25&quot;,
               &quot;H25.1&quot;)

collected_all_disease_terms = c(&quot;adhd&quot;,
                                &quot;alzheimers disease&quot;,
                                &quot;abruptio placentae&quot;,
                                &quot;age-related cataract&quot;,
                                &quot;age-related nuclear cataract&quot;)

icd10_code_origin = c(&quot;Inferred from similar study&quot;)

to_add = data.frame(collected_all_disease_terms, 
                    icd10_code, 
                    icd10_code_origin)

disease_mapping =
  rows_patch(disease_mapping,
             to_add,
             unmatched = &quot;ignore&quot;)</code></pre>
<pre><code>Matching, by = &quot;collected_all_disease_terms&quot;</code></pre>
</div>
<div id="completing-missing-combinations" class="section level1">
<h1>Completing missing combinations</h1>
</div>
<div id="saving-disease-mapping" class="section level1">
<h1>Saving disease mapping</h1>
<div id="add-description-of-icd10-codes-to-mapping-table"
class="section level2">
<h2>Add description of ICD10 codes to mapping table</h2>
<div id="prepare-fix-disease-mappings" class="section level3">
<h3>Prepare / fix disease mappings</h3>
<div id="fixing-multiple-icd10-codes-missing-commas"
class="section level4">
<h4>Fixing multiple ICD10 codes missing commas</h4>
<pre class="r"><code>disease_mapping = 
  disease_mapping |&gt; 
  mutate(icd10_code = str_replace_all(
    icd10_code,
    pattern = &quot;F40 F41 F42&quot;,
    replacement = &quot;F40, F41, F42&quot;
    )
  )

disease_mapping = 
  disease_mapping |&gt; 
  mutate(icd10_code = str_replace_all(
    icd10_code,
    pattern = &quot;G47.8. G47.9&quot;,
    replacement = &quot;G47.8, G47.9&quot;
    )
  )</code></pre>
</div>
<div id="converting-icd-10-cm-codes-to-who-icd-10"
class="section level4">
<h4>Converting ICD-10 cm codes to WHO ICD-10</h4>
<pre class="r"><code>disease_mapping =
  disease_mapping |&gt;
  mutate(icd10_code = str_split(icd10_code, &quot;,\\s*&quot;)) |&gt;
  tidyr::unnest(icd10_code) 


disease_mapping = 
  disease_mapping |&gt; 
    mutate(icd10_code = str_replace_all(
    icd10_code,
    pattern = &quot;B37.49&quot;,
    replacement = &quot;B37.4&quot;
    )
    ) 

disease_mapping = 
  disease_mapping |&gt; 
    mutate(icd10_code = str_replace_all(
    icd10_code,
    pattern = &quot;E05.90&quot;,
    replacement = &quot;E05.9&quot;
    )
    ) 

disease_mapping = 
  disease_mapping |&gt; 
  mutate(icd10_code = str_replace_all(
    icd10_code,
    pattern = &quot;E11.319|E11.31|E11.329.9|E11.329.|E11.32|E11.3.&quot;,
    replacement = &quot;E11.3&quot;
    )
  )

disease_mapping = 
  disease_mapping |&gt; 
  mutate(icd10_code = str_replace_all(
    icd10_code,
    pattern = &quot;E11.3.&quot;,
    replacement = &quot;E11.3&quot;
    )
  )

disease_mapping = 
  disease_mapping |&gt; 
  mutate(icd10_code = str_replace_all(
    icd10_code,
    pattern = &quot;E13.621.|E13.62&quot;,
    replacement = &quot;E11.3&quot;
    )
  )

disease_mapping = 
  disease_mapping |&gt; 
    mutate(icd10_code = str_replace_all(
    icd10_code,
    pattern = &quot;E78.00&quot;,
    replacement = &quot;E78.0&quot;
    )
    ) 

disease_mapping = 
  disease_mapping |&gt; 
    mutate(icd10_code = str_replace_all(
    icd10_code,
    pattern = &quot;F10.10&quot;,
    replacement = &quot;F10.1&quot;
    )
    ) 

disease_mapping = 
  disease_mapping |&gt; 
    mutate(icd10_code = str_replace_all(
    icd10_code,
    pattern = &quot;F17.201.|F17.20&quot;,
    replacement = &quot;F17.2&quot;
    )
    ) 

disease_mapping = 
  disease_mapping |&gt; 
    mutate(icd10_code = str_replace_all(
    icd10_code,
    pattern = &quot;F430&quot;,
    replacement = &quot;F43.0&quot;
    )
    ) 

disease_mapping = 
  disease_mapping |&gt; 
    mutate(icd10_code = str_replace_all(
    icd10_code,
    pattern = &quot;G47.00&quot;,
    replacement = &quot;G47.0&quot;
    )
    ) 

disease_mapping = 
  disease_mapping |&gt; 
    mutate(icd10_code = str_replace_all(
    icd10_code,
    pattern = &quot;H01.00|H01.09.&quot;,
    replacement = &quot;H01.0&quot;
    )
    ) 

disease_mapping = 
  disease_mapping |&gt; 
    mutate(icd10_code = str_replace_all(
    icd10_code,
    pattern = &quot;H01.09.&quot;,
    replacement = &quot;H01.0&quot;
    )
    ) 

disease_mapping = 
  disease_mapping |&gt; 
    mutate(icd10_code = str_replace_all(
    icd10_code,
    pattern = &quot;H029&quot;,
    replacement = &quot;H02.9&quot;
    )
    ) 

disease_mapping = 
  disease_mapping |&gt; 
    mutate(icd10_code = str_replace_all(
    icd10_code,
    pattern = &quot;H60.90&quot;,
    replacement = &quot;H60.9&quot;
    )
    ) 

disease_mapping = 
  disease_mapping |&gt; 
    mutate(icd10_code = str_replace_all(
    icd10_code,
    pattern = &quot;H60.90&quot;,
    replacement = &quot;H60.9&quot;
    )
    ) 

disease_mapping = 
  disease_mapping |&gt; 
    mutate(icd10_code = str_replace_all(
    icd10_code,
    pattern = &quot;H91.8X9.&quot;,
    replacement = &quot;H91.8&quot;
    )
    ) 

disease_mapping = 
  disease_mapping |&gt; 
    mutate(icd10_code = str_replace_all(
    icd10_code,
    pattern = &quot;H91.90&quot;,
    replacement = &quot;H91.9&quot;
    )
    ) 

disease_mapping = 
  disease_mapping |&gt; 
    mutate(icd10_code = str_replace_all(
    icd10_code,
    pattern = &quot;H93.299.|H93.29&quot;,
    replacement = &quot;H01&quot;
    )
    ) 

disease_mapping = 
  disease_mapping |&gt; 
    mutate(icd10_code = str_replace_all(
    icd10_code,
    pattern = &quot;I70.20&quot;,
    replacement = &quot;I70.2&quot;
    )
    ) 

disease_mapping = 
  disease_mapping |&gt; 
    mutate(icd10_code = str_replace_all(
    icd10_code,
    pattern = &quot;I82.409.|I82.40|I82.4&quot;,
    replacement = &quot;I82&quot;
    )
    ) 

disease_mapping = 
  disease_mapping |&gt; 
    mutate(icd10_code = str_replace_all(
    icd10_code,
    pattern = &quot;J30.9&quot;,
    replacement = &quot;J30.2&quot;
    )
    ) 

disease_mapping = 
  disease_mapping |&gt; 
  mutate(icd10_code = str_replace_all(
    icd10_code,
    pattern = &quot;J45.998.|J45.909.|J45.901.|J45.99|J45.90&quot;,
    replacement = &quot;J45.9&quot;
    )
  )

disease_mapping = 
  disease_mapping |&gt; 
    mutate(icd10_code = str_replace_all(
    icd10_code,
    pattern = &quot;J98.457.6&quot;,
    replacement = &quot;J98.4&quot;
    )
    ) 

disease_mapping = 
  disease_mapping |&gt; 
    mutate(icd10_code = str_replace_all(
    icd10_code,
    pattern = &quot;K05.30-31&quot;,
    replacement = &quot;K05.3&quot;
    )
    ) 

disease_mapping = 
  disease_mapping |&gt; 
    mutate(icd10_code = str_replace_all(
    icd10_code,
    pattern = &quot;K29.70&quot;,
    replacement = &quot;K29.7&quot;
    )
    ) 

disease_mapping = 
  disease_mapping |&gt; 
    mutate(icd10_code = str_replace_all(
    icd10_code,
    pattern = &quot;K59.00&quot;,
    replacement = &quot;K59.0&quot;
    )
    ) 

disease_mapping = 
  disease_mapping |&gt; 
    mutate(icd10_code = str_replace_all(
    icd10_code,
    pattern = &quot;L08.89&quot;,
    replacement = &quot;L08.8&quot;
    )
    ) 

disease_mapping = 
  disease_mapping |&gt; 
    mutate(icd10_code = str_replace_all(
    icd10_code,
    pattern = &quot;M06.99|M06.90&quot;,
    replacement = &quot;M06.9&quot;
    )
    ) 

disease_mapping = 
  disease_mapping |&gt; 
    mutate(icd10_code = str_replace_all(
    icd10_code,
    pattern = &quot;M10.99&quot;,
    replacement = &quot;M10.9&quot;
    )
    ) 

disease_mapping = 
  disease_mapping |&gt; 
    mutate(icd10_code = str_replace_all(
    icd10_code,
    pattern = &quot;M10.99&quot;,
    replacement = &quot;M10.9&quot;
    )
    ) 

disease_mapping = 
  disease_mapping |&gt; 
  mutate(icd10_code = str_replace_all(
    icd10_code,
    pattern = &quot;M13.90|M13.94|M13.96|M13.97|M13.99&quot;,
    replacement = &quot;M13.9&quot;
    )
  )

disease_mapping = 
  disease_mapping |&gt; 
  mutate(icd10_code = str_replace_all(
    icd10_code,
    pattern = &quot;M19.07&quot;,
    replacement = &quot;M19.0&quot;
    )
  )

disease_mapping = 
  disease_mapping |&gt; 
  mutate(icd10_code = str_replace_all(
    icd10_code,
    pattern = &quot;M19.90|M19.91|M19.94|M19.97|M19.99&quot;,
    replacement = &quot;M19.9&quot;
    )
  )



disease_mapping = 
  disease_mapping |&gt; 
  mutate(icd10_code = str_replace_all(
    icd10_code,
    pattern = &quot;M25.50|M25.51|M25.55|M25.569.|M25.56|M25.571.|M25.57&quot;,
    replacement = &quot;M25.5&quot;
    )
  )

disease_mapping = 
  disease_mapping |&gt; 
    mutate(icd10_code = str_replace_all(
    icd10_code,
    pattern = &quot;M25.76|M25.77&quot;,
    replacement = &quot;M25.7&quot;
    )
    ) 

disease_mapping = 
  disease_mapping |&gt; 
    mutate(icd10_code = str_replace_all(
    icd10_code,
    pattern = &quot;M43.16&quot;,
    replacement = &quot;M43.1&quot;
    )
    ) 

disease_mapping = 
  disease_mapping |&gt; 
  mutate(icd10_code = str_replace_all(
    icd10_code,
    pattern = &quot;M47.80|M47.82|M47.86&quot;,
    replacement = &quot;M47.8&quot;
    )
  )

disease_mapping = 
  disease_mapping |&gt; 
  mutate(icd10_code = str_replace_all(
    icd10_code,
    pattern = &quot;M47.92|M47.96&quot;,
    replacement = &quot;M47.9&quot;
    )
  )

disease_mapping = 
  disease_mapping |&gt; 
    mutate(icd10_code = str_replace_all(
    icd10_code,
    pattern = &quot;M48.02|M48.06&quot;,
    replacement = &quot;M48.0&quot;
    )
    ) 

disease_mapping = 
  disease_mapping |&gt; 
    mutate(icd10_code = str_replace_all(
    icd10_code,
    pattern = &quot;M54.22&quot;,
    replacement = &quot;M54.2&quot;
    )
    ) 

disease_mapping = 
  disease_mapping |&gt; 
    mutate(icd10_code = str_replace_all(
    icd10_code,
    pattern = &quot;M54.30|M54.39&quot;,
    replacement = &quot;M54.3&quot;
    )
    ) 

disease_mapping = 
  disease_mapping |&gt; 
    mutate(icd10_code = str_replace_all(
    icd10_code,
    pattern = &quot;M54.56|M54.57|M54.59&quot;,
    replacement = &quot;M54.5&quot;
    )
    ) 

disease_mapping = 
  disease_mapping |&gt; 
    mutate(icd10_code = str_replace_all(
    icd10_code,
    pattern = &quot;M54.99&quot;,
    replacement = &quot;M54.9&quot;
    )
    ) 

disease_mapping = 
  disease_mapping |&gt; 
    mutate(icd10_code = str_replace_all(
    icd10_code,
    pattern = &quot;M65.34&quot;,
    replacement = &quot;M65.3&quot;
    )
    ) 

disease_mapping = 
  disease_mapping |&gt; 
    mutate(icd10_code = str_replace_all(
    icd10_code,
    pattern = &quot;M65.96&quot;,
    replacement = &quot;M65.9&quot;
    )
    ) 

disease_mapping = 
  disease_mapping |&gt; 
    mutate(icd10_code = str_replace_all(
    icd10_code,
    pattern = &quot;M72.04&quot;,
    replacement = &quot;M72.0&quot;
    )
    ) 

disease_mapping = 
  disease_mapping |&gt; 
    mutate(icd10_code = str_replace_all(
    icd10_code,
    pattern = &quot;M79.09&quot;,
    replacement = &quot;M79.0&quot;
    )
    ) 

disease_mapping = 
  disease_mapping |&gt; 
    mutate(icd10_code = str_replace_all(
    icd10_code,
    pattern = &quot;M79.65|M79.66|M79.67&quot;,
    replacement = &quot;M79.6&quot;
    )
    ) 

disease_mapping = 
  disease_mapping |&gt; 
    mutate(icd10_code = str_replace_all(
    icd10_code,
    pattern = &quot;M79.79&quot;,
    replacement = &quot;M79.7&quot;
    )
    ) 

disease_mapping = 
  disease_mapping |&gt; 
    mutate(icd10_code = str_replace_all(
    icd10_code,
    pattern = &quot;M79.86&quot;,
    replacement = &quot;M79.8&quot;
    )
    ) 

disease_mapping = 
  disease_mapping |&gt; 
    mutate(icd10_code = str_replace_all(
    icd10_code,
    pattern = &quot;M81.99&quot;,
    replacement = &quot;M81.9&quot;
    )
    ) 

disease_mapping = 
  disease_mapping |&gt; 
    mutate(icd10_code = str_replace_all(
    icd10_code,
    pattern = &quot;N390&quot;,
    replacement = &quot;N39.0&quot;
    )
    ) 

disease_mapping = 
  disease_mapping |&gt; 
    mutate(icd10_code = str_replace_all(
    icd10_code,
    pattern = &quot;N50.89&quot;,
    replacement = &quot;N50.8&quot;
    )
    ) 

disease_mapping = 
  disease_mapping |&gt; 
    mutate(icd10_code = str_replace_all(
    icd10_code,
    pattern = &quot;N52&quot;,
    replacement = &quot;F52&quot;
    )
    ) 

disease_mapping = 
  disease_mapping |&gt; 
    mutate(icd10_code = str_replace_all(
    icd10_code,
    pattern = &quot;N52.9&quot;,
    replacement = &quot;F52.9&quot;
    )
    ) 

disease_mapping = 
  disease_mapping |&gt; 
    mutate(icd10_code = str_replace_all(
    icd10_code,
    pattern = &quot;N814&quot;,
    replacement = &quot;N81.4&quot;
    )
    ) 

disease_mapping = 
  disease_mapping |&gt; 
    mutate(icd10_code = str_replace_all(
    icd10_code,
    pattern = &quot;P29.12&quot;,
    replacement = &quot;P29.1&quot;
    )
    ) 

disease_mapping = 
  disease_mapping |&gt; 
    mutate(icd10_code = str_replace_all(
    icd10_code,
    pattern = &quot;R06.00|R06.09&quot;,
    replacement = &quot;R06.0&quot;
    )
    ) 

disease_mapping = 
  disease_mapping |&gt; 
    mutate(icd10_code = str_replace_all(
    icd10_code,
    pattern = &quot;R06.83&quot;,
    replacement = &quot;R06.8&quot;
    )
    ) 

disease_mapping = 
  disease_mapping |&gt; 
    mutate(icd10_code = str_replace_all(
    icd10_code,
    pattern = &quot;R07.89&quot;,
    replacement = &quot;R07.8&quot;
    )
    ) 

disease_mapping = 
  disease_mapping |&gt; 
    mutate(icd10_code = str_replace_all(
    icd10_code,
    pattern = &quot;R07.8|R07.9&quot;,
    replacement = &quot;R07&quot;
    )
    ) 

disease_mapping = 
  disease_mapping |&gt; 
    mutate(icd10_code = str_replace_all(
    icd10_code,
    pattern = &quot;R09.89&quot;,
    replacement = &quot;R09.8&quot;
    )
    ) 


disease_mapping = 
  disease_mapping |&gt; 
    mutate(icd10_code = str_replace_all(
    icd10_code,
    pattern = &quot;R10.30&quot;,
    replacement = &quot;R10.3&quot;
    )
    ) 

disease_mapping = 
  disease_mapping |&gt; 
    mutate(icd10_code = str_replace_all(
    icd10_code,
    pattern = &quot;R10.8|R10.9&quot;,
    replacement = &quot;R10&quot;
    )
    ) 

disease_mapping = 
  disease_mapping |&gt; 
    mutate(icd10_code = str_replace_all(
    icd10_code,
    pattern = &quot;R11.0&quot;,
    replacement = &quot;R11&quot;
    )
    ) 

disease_mapping = 
  disease_mapping |&gt; 
    mutate(icd10_code = str_replace_all(
    icd10_code,
    pattern = &quot;R13.10&quot;,
    replacement = &quot;R13&quot;
    )
    ) 

disease_mapping = 
  disease_mapping |&gt; 
    mutate(icd10_code = str_replace_all(
    icd10_code,
    pattern = &quot;R13.1&quot;,
    replacement = &quot;R13&quot;
    )
    ) 

disease_mapping = 
  disease_mapping |&gt; 
    mutate(icd10_code = str_replace_all(
    icd10_code,
    pattern = &quot;R14.0&quot;,
    replacement = &quot;R14&quot;
    )
    ) 

disease_mapping = 
  disease_mapping |&gt; 
    mutate(icd10_code = str_replace_all(
    icd10_code,
    pattern = &quot;R19.7&quot;,
    replacement = &quot;R19&quot;
    )
    ) 

disease_mapping = 
  disease_mapping |&gt; 
    mutate(icd10_code = str_replace_all(
    icd10_code,
    pattern = &quot;R29.898.|R29.89&quot;,
    replacement = &quot;R29.8&quot;
    )
    ) 

disease_mapping = 
  disease_mapping |&gt; 
    mutate(icd10_code = str_replace_all(
    icd10_code,
    pattern = &quot;R31.29&quot;,
    replacement = &quot;R31.2&quot;
    )
    ) 

disease_mapping = 
  disease_mapping |&gt; 
    mutate(icd10_code = str_replace_all(
    icd10_code,
    pattern = &quot;R31.2|R31.9&quot;,
    replacement = &quot;R31&quot;
    )
    ) 


disease_mapping = 
  disease_mapping |&gt; 
    mutate(icd10_code = str_replace_all(
    icd10_code,
    pattern = &quot;R53.82|R53.83|R5382&quot;,
    replacement = &quot;R53.8&quot;
    )
    ) 

disease_mapping = 
  disease_mapping |&gt; 
    mutate(icd10_code = str_replace_all(
    icd10_code,
    pattern = &quot;R53.8&quot;,
    replacement = &quot;R53&quot;
    )
    ) 

disease_mapping = 
  disease_mapping |&gt; 
    mutate(icd10_code = str_replace_all(
    icd10_code,
    pattern = &quot;R56.9&quot;,
    replacement = &quot;R56&quot;
    )
    ) 

disease_mapping = 
  disease_mapping |&gt; 
  mutate(icd10_code = str_replace_all(
    icd10_code,
    pattern = &quot;R73.09|R73.02&quot;,
    replacement = &quot;R73.0&quot;
    )
    ) 

disease_mapping = 
  disease_mapping |&gt; 
    mutate(icd10_code = str_replace_all(
    icd10_code,
    pattern = &quot;R80.9&quot;,
    replacement = &quot;R80&quot;
    )
    ) 
 

disease_mapping = 
  disease_mapping |&gt; 
    mutate(icd10_code = str_replace_all(
    icd10_code,
    pattern = &quot;R82.998.|R82.99&quot;,
    replacement = &quot;R82.9&quot;
    )
    ) 

disease_mapping = 
  disease_mapping |&gt; 
    mutate(icd10_code = str_replace_all(
    icd10_code,
    pattern = &quot;R871&quot;,
    replacement = &quot;R87.1&quot;
    )
    ) 

disease_mapping = 
  disease_mapping |&gt; 
    mutate(icd10_code = str_replace_all(
    icd10_code,
    pattern = &quot;R87.6&quot;,
    replacement = &quot;R87&quot;
    )
    ) 


disease_mapping = 
  disease_mapping |&gt; 
    mutate(icd10_code = str_replace_all(
    icd10_code,
    pattern = &quot;R87.61&quot;,
    replacement = &quot;R87.6&quot;
    )
    ) 

disease_mapping = 
  disease_mapping |&gt; 
    mutate(icd10_code = str_replace_all(
    icd10_code,
    pattern = &quot;T50.905.&quot;,
    replacement = &quot;T50.9&quot;
    )
    ) 

disease_mapping = 
  disease_mapping |&gt; 
    mutate(icd10_code = str_replace_all(
    icd10_code,
    pattern = &quot;T78.40&quot;,
    replacement = &quot;T78.4&quot;
    )
    ) 

disease_mapping = 
  disease_mapping |&gt; 
    mutate(icd10_code = str_replace_all(
    icd10_code,
    pattern = &quot;T780&quot;,
    replacement = &quot;T78.0&quot;
    )
    ) 

disease_mapping = 
  disease_mapping |&gt; 
    mutate(icd10_code = str_replace_all(
    icd10_code,
    pattern = &quot;T81.149.88&quot;,
    replacement = &quot;T81.1&quot;
    )
    ) 

disease_mapping = 
  disease_mapping |&gt; 
    mutate(icd10_code = str_replace_all(
    icd10_code,
    pattern = &quot;T81.815.013.&quot;,
    replacement = &quot;T81.8&quot;
    )
    ) 

disease_mapping = 
  disease_mapping |&gt; 
    mutate(icd10_code = str_replace_all(
    icd10_code,
    pattern = &quot;T84.84&quot;,
    replacement = &quot;T84.8&quot;
    )
    ) 

disease_mapping = 
  disease_mapping |&gt; 
    mutate(icd10_code = str_replace_all(
    icd10_code,
    pattern = &quot;T887&quot;,
    replacement = &quot;T88.7&quot;
    )
    ) 

disease_mapping = 
  disease_mapping |&gt; 
    mutate(icd10_code = str_replace_all(
    icd10_code,
    pattern = &quot;Z86.79&quot;,
    replacement = &quot;Z86.7&quot;
    )
    ) 

disease_mapping = 
  disease_mapping |&gt; 
    mutate(icd10_code = str_replace_all(
    icd10_code,
    pattern = &quot;Z87.09&quot;,
    replacement = &quot;Z87.0&quot;
    )
    ) 

disease_mapping = 
  disease_mapping |&gt; 
    mutate(icd10_code = str_replace_all(
    icd10_code,
    pattern = &quot;Z87.39&quot;,
    replacement = &quot;Z87.3&quot;
    )
    ) 


disease_mapping = 
  disease_mapping |&gt; 
    mutate(icd10_code = str_replace_all(
    icd10_code,
    pattern = &quot;Z87.42&quot;,
    replacement = &quot;Z87.4&quot;
    )
    ) 

disease_mapping = 
  disease_mapping |&gt; 
    mutate(icd10_code = str_replace_all(
    icd10_code,
    pattern = &quot;Z87.891.&quot;,
    replacement = &quot;Z87.8&quot;
    )
    ) 

disease_mapping = 
  disease_mapping |&gt; 
    mutate(icd10_code = str_replace_all(
    icd10_code,
    pattern = &quot;W44.9&quot;,
    replacement = &quot;W44&quot;
    )
    ) 

disease_mapping = 
  disease_mapping |&gt; 
    mutate(icd10_code = str_replace_all(
    icd10_code,
    pattern = &quot;U80&quot;,
    replacement = &quot;U82&quot;
    )
    ) 

disease_mapping =
  disease_mapping |&gt;
  distinct()</code></pre>
</div>
</div>
<div id="add-icd10-descriptions" class="section level3">
<h3>Add ICD10 descriptions</h3>
<div id="other-icd10-descriptions-to-add" class="section level4">
<h4>Other ICD10 descriptions to add</h4>
<pre class="r"><code>other_icd10_desc = 
  data.frame(
    icd10_code = c(&quot;A09.9&quot;, 
                  &quot;A41&quot;,
                  &quot;B95&quot;,
                  &quot;B96&quot;,
                  &quot;B97&quot;,
                  &quot;B98&quot;,
                  &quot;C44&quot;,
                  &quot;C79&quot;,
                  &quot;C80.0&quot;,
                  &quot;C80.9&quot;,
                  &quot;C90&quot;,
                  &quot;D07&quot;,
                  &quot;D35&quot;,
                  &quot;D37&quot;,
                  &quot;D47&quot;,
                  &quot;D48&quot;,
                  &quot;E03&quot;,
                  &quot;E04&quot;,
                  &quot;E21&quot;,
                  &quot;E23&quot;,
                  &quot;E27&quot;,
                  &quot;E61&quot;,
                  &quot;E80&quot;,
                  &quot;E87&quot;,
                  &quot;E89&quot;,
                  &quot;F05&quot;,
                  &quot;F17&quot;,
                  &quot;F41&quot;,
                  &quot;F43.0&quot;,
                  &quot;F53&quot;,
                  &quot;G31&quot;,
                  &quot;G45&quot;,
                  &quot;G46&quot;,
                  &quot;G62&quot;,
                  &quot;G93&quot;,
                  &quot;G99&quot;,
                  &quot;H47&quot;,
                  &quot;H50&quot;,
                  &quot;H57&quot;,
                  &quot;H83&quot;,
                  &quot;H91&quot;,
                  &quot;H92&quot;,
                  &quot;H93&quot;,
                  &quot;I08&quot;,
                  &quot;I27&quot;,
                  &quot;I27.2&quot;,
                  &quot;I44&quot;,
                  &quot;I45&quot;,
                  &quot;I48.0&quot;,
                  &quot;I49&quot;,
                  &quot;I51&quot;,
                  &quot;I62&quot;,
                  &quot;I71&quot;,
                  &quot;J15&quot;,
                  &quot;J16&quot;,
                  &quot;J34&quot;,
                  &quot;J38&quot;,
                  &quot;J69&quot;,
                  &quot;J84&quot;,
                  &quot;J95&quot;,
                  &quot;J96&quot;,
                  &quot;K05&quot;,
                  &quot;K07&quot;,
                  &quot;K08&quot;,
                  &quot;K09&quot;,
                  &quot;K10&quot;,
                  &quot;K12&quot;,
                  &quot;K13&quot;,
                  &quot;K22&quot;,
                  &quot;K22.7&quot;,
                  &quot;K52&quot;,
                  &quot;K56&quot;,
                  &quot;K64&quot;,
                  &quot;K64.0&quot;,
                  &quot;K64.9&quot;,
                  &quot;K74&quot;,
                  &quot;K75&quot;,
                  &quot;K85.9&quot;,
                  &quot;K86&quot;,
                  &quot;K91&quot;,
                  &quot;K91.8&quot;,
                  &quot;K92&quot;,
                  &quot;L02&quot;,
                  &quot;L13&quot;,
                  &quot;L30&quot;,
                  &quot;L65&quot;,
                  &quot;L73&quot;,
                  &quot;L85&quot;,
                  &quot;L89.1&quot;,
                  &quot;L98&quot;,
                  &quot;M05&quot;,
                  &quot;M06&quot;,
                  &quot;M07&quot;,
                  &quot;M11&quot;,
                  &quot;M13&quot;,
                  &quot;M18&quot;,
                  &quot;M19&quot;,
                  &quot;M24&quot;,
                  &quot;M25&quot;,
                  &quot;M31&quot;,
                  &quot;M35&quot;,
                  &quot;M43&quot;,
                  &quot;M48&quot;,
                  &quot;M53&quot;,
                  &quot;M62&quot;,
                  &quot;M66&quot;,
                  &quot;M67&quot;,
                  &quot;M71&quot;,
                  &quot;M77&quot;,
                  &quot;M79&quot;,
                  &quot;M79.7&quot;,
                  &quot;M80&quot;,
                  &quot;M81&quot;,
                  &quot;M85&quot;,
                  &quot;M89&quot;,
                  &quot;M96&quot;,
                  &quot;N02&quot;,
                  &quot;N18.3&quot;,
                  &quot;N18.4&quot;,
                  &quot;N28&quot;,
                  &quot;N39&quot;,
                  &quot;N48&quot;,
                  &quot;N73&quot;,
                  &quot;N76&quot;,
                  &quot;N88&quot;,
                  &quot;N89&quot;,
                  &quot;N91&quot;,
                  &quot;N92&quot;,
                  &quot;N93&quot;,
                  &quot;N94&quot;,
                  &quot;N99&quot;,
                  &quot;O14&quot;,
                  &quot;O04&quot;,
                  &quot;O26&quot;,
                  &quot;O32&quot;,
                  &quot;O34&quot;,
                  &quot;O36&quot;,
                  &quot;O68&quot;,
                  &quot;O75&quot;,
                  &quot;O99&quot;,
                  &quot;R03&quot;,
                  &quot;R07&quot;,
                  &quot;R09&quot;,
                  &quot;R10&quot;,
                  &quot;R19&quot;,
                  &quot;R29&quot;,
                  &quot;R29.6&quot;,
                  &quot;R39&quot;,
                  &quot;R40&quot;,
                  &quot;R47&quot;,
                  &quot;R57&quot;,
                  &quot;T95.8&quot;,
                  &quot;W44&quot;,
                  &quot;Y95&quot;,
                  &quot;Z86.3&quot;,
                  &quot;Z87.3&quot;,
                  &quot;Z87.4&quot;,
                  &quot;Z87.7&quot;,
                  &quot;Z87.8&quot;,
                  &quot;T85.8&quot;,
                  &quot;Z91.0&quot;,
                  &quot;Z88.9&quot;,
                  &quot;Z88.8&quot;,
                  &quot;Z88&quot;,
                  &quot;Z92.6&quot;,
                  &quot;N90&quot;,
                  &quot;U82&quot;
                  ),
    icd10_description = c(&quot;Gastroenteritis and colitis of unspecified origin&quot;,
                         &quot;Other sepsis&quot;,
                         &quot;Streptococcus and staphylococcus as the cause of diseases classified to other chapters&quot;,
                         &quot;Other specified bacterial agents as the cause of diseases classified to other chapters&quot;,
                         &quot;Viral agents as the cause of diseases classified to other chapters&quot;,
                         &quot;Other specified infectious agents as the cause of diseases classified to other chapters&quot;,
                         &quot;Other malignant neoplasms of skin&quot;,
                         &quot;Secondary malignant neoplasm of other and unspecified sites&quot;,
                         &quot;Malignant neoplasm, primary site unknown, so stated&quot;,
                         &quot;Malignant neoplasm, primary site unspecified&quot;,
                         &quot;Multiple myeloma and malignant plasma cell neoplasms&quot;,
                         &quot;Carcinoma in situ of other and unspecified genital organs&quot;,
                         &quot;Benign neoplasm of other and unspecified endocrine glands&quot;,
                         &quot;Neoplasm of uncertain or unknown behaviour of oral cavity and digestive organs&quot;,
                         &quot;Other neoplasms of uncertain or unknown behaviour of lymphoid, haematopoietic and related tissue&quot;,
                         &quot;Neoplasm of uncertain or unknown behaviour of other and unspecified sites&quot;,
                         &quot;Other hypothyroidism&quot;,
                         &quot;Other nontoxic goitre&quot;,
                         &quot;Hyperparathyroidism and other disorders of parathyroid gland&quot;,
                         &quot;Hypofunction and other disorders of pituitary gland&quot;,
                         &quot;Other disorders of adrenal gland&quot;,
                         &quot;Deficiency of other nutrient elements&quot;,
                         &quot;Disorders of porphyrin and bilirubin metabolism&quot;,
                         &quot;Other disorders of fluid, electrolyte and acid-base balance&quot;,
                         &quot;Postprocedural endocrine and metabolic disorders, not elsewhere classified&quot;,
                         &quot;Delirium, not induced by alcohol and other psychoactive substances&quot;,
                         &quot;Mental and behavioural disorders due to use of tobacco&quot;,
                         &quot;Other anxiety disorders&quot;,
                         &quot;Acute stress reaction&quot;,
                         &quot;Mental and behavioural disorders associated with the puerperium, not elsewhere classified&quot;,
                         &quot;Other degenerative diseases of nervous system, not elsewhere classified&quot;,
                         &quot;Transient cerebral ischaemic attacks and related syndromes&quot;,
                         &quot;Vascular syndromes of brain in cerebrovascular diseases&quot;,
                         &quot;Other polyneuropathies&quot;,
                         &quot;Other disorders of brain&quot;,
                         &quot;Other disorders of nervous system in diseases classified elsewhere&quot;,
                         &quot;Other disorders of optic [2nd] nerve and visual pathways&quot;,
                         &quot;Other strabismus&quot;,
                         &quot;Other disorders of eye and adnexa&quot;,
                         &quot;Other diseases of inner ear&quot;,
                         &quot;Other hearing loss&quot;,
                         &quot;Otalgia and effusion of ear&quot;,
                         &quot;Other disorders of ear, not elsewhere classified&quot;,
                         &quot;Multiple valve diseases&quot;,
                         &quot;Other pulmonary heart diseases&quot;,
                         &quot;Other secondary pulmonary hypertension&quot;,
                         &quot;Atrioventricular and left bundle-branch block&quot;,
                         &quot;Other conduction disorders&quot;,
                         &quot;Paroxysmal atrial fibrillation&quot;,
                         &quot;Ventricular fibrillation and flutter&quot;,
                         &quot;Complications and ill-defined descriptions of heart disease&quot;,
                         &quot;Other nontraumatic intracranial haemorrhage&quot;,
                         &quot;Aortic aneurysm and dissection&quot;,
                         &quot;Bacterial pneumonia, not elsewhere classified&quot;,
                         &quot;Pneumonia due to other infectious organisms, not elsewhere classified&quot;,
                         &quot;Other disorders of nose and nasal sinuses&quot;,
                         &quot;Diseases of vocal cords and larynx, not elsewhere classified&quot;,
                         &quot;Pneumonitis due to solids and liquids&quot;,
                         &quot;Other interstitial pulmonary diseases&quot;,
                         &quot;Postprocedural respiratory disorders, not elsewhere classified&quot;,
                         &quot;Respiratory failure, not elsewhere classified&quot;,
                         &quot;Gingivitis and periodontal diseases&quot;,
                         &quot;Dentofacial anomalies [including malocclusion]&quot;,
                         &quot;Other disorders of teeth and supporting structures&quot;,
                         &quot;Cysts of oral region, not elsewhere classified&quot;,
                         &quot;Other diseases of jaws&quot;,
                         &quot;Stomatitis and related lesions&quot;,
                         &quot;Other diseases of lip and oral mucosa&quot;,
                         &quot;Other diseases of oesophagus&quot;,
                         &quot;Barrett oesophagus&quot;,
                         &quot;Other noninfective gastroenteritis and colitis&quot;,
                         &quot;Paralytic ileus and intestinal obstruction without hernia&quot;,
                         &quot;Haemorrhoids and perianal venous thrombosis&quot;,
                         &quot;First degree haemorrhoids&quot;,
                         &quot;Haemorrhoids, unspecified&quot;,
                         &quot;Fibrosis and cirrhosis of liver&quot;,
                         &quot;Other inflammatory liver diseases&quot;,
                         &quot;Acute pancreatitis, unspecified&quot;,
                         &quot;Other diseases of pancreas&quot;,
                         &quot;Postprocedural disorders of digestive system, not elsewhere classified&quot;,
                         &quot;Other postprocedural disorders of digestive system, not elsewhere classified&quot;,
                         &quot;Other diseases of digestive system&quot;,
                         &quot;Cutaneous abscess, furuncle and carbuncle&quot;,
                         &quot;Other bullous disorders&quot;,
                         &quot;Other dermatitis&quot;,
                         &quot;Other nonscarring hair loss&quot;,
                         &quot;Other follicular disorders&quot;,
                         &quot;Other epidermal thickening&quot;,
                         &quot;Stage II decubitus ulcer&quot;,
                         &quot;Other disorders of skin and subcutaneous tissue, not elsewhere classified&quot;,
                         &quot;Seropositive rheumatoid arthritis&quot;,
                         &quot;Other rheumatoid arthritis&quot;,
                         &quot;Psoriatic and enteropathic arthropathies&quot;,
                         &quot;Other crystal arthropathies&quot;,
                         &quot;Other arthritis&quot;,
                         &quot;Arthrosis of first carpometacarpal joint&quot;,
                         &quot;Other arthrosis&quot;,
                         &quot;Other specific joint derangements&quot;,
                         &quot;Other joint disorders, not elsewhere classified&quot;,
                         &quot;Other necrotizing vasculopathies&quot;,
                         &quot;Other systemic involvement of connective tissue&quot;,
                         &quot;Other deforming dorsopathies&quot;,
                         &quot;Other spondylopathies&quot;,
                         &quot;Other dorsopathies, not elsewhere classified&quot;,
                         &quot;Other disorders of muscle&quot;,
                         &quot;Spontaneous rupture of synovium and tendon&quot;,
                         &quot;Other disorders of synovium and tendon&quot;,
                         &quot;Other bursopathies&quot;,
                         &quot;Other enthesopathies&quot;,
                         &quot;Other soft tissue disorders, not elsewhere classified&quot;,
                         &quot;Fibromyalgia&quot;,
                         &quot;Osteoporosis with pathological fracture&quot;,
                         &quot;Osteoporosis without pathological fracture&quot;,
                         &quot;Other disorders of bone density and structure&quot;,
                         &quot;Other disorders of bone&quot;,
                         &quot;Postprocedural musculoskeletal disorders, not elsewhere classified&quot;,
                         &quot;Recurrent and persistent haematuria&quot;,
                         &quot;Chronic kidney disease, stage 3&quot;,
                         &quot;Chronic kidney disease, stage 4&quot;,
                         &quot;Other disorders of kidney and ureter, not elsewhere classified&quot;,
                         &quot;Other disorders of urinary system&quot;,
                         &quot;Other disorders of penis&quot;,
                         &quot;Other female pelvic inflammatory diseases&quot;,
                         &quot;Other inflammation of vagina and vulva&quot;,
                         &quot;Other noninflammatory disorders of cervix uteri&quot;,
                         &quot;Other noninflammatory disorders of vagina&quot;,
                         &quot;Other noninflammatory disorders of vulva and perineum&quot;,
                         &quot;Excessive, frequent and irregular menstruation&quot;,
                         &quot;Other abnormal uterine and vaginal bleeding&quot;,
                         &quot;Pain and other conditions associated with female genital organs and menstrual cycle&quot;,
                         &quot;Postprocedural disorders of genitourinary system, not elsewhere classified&quot;,
                         &quot;Pre-eclampsia&quot;,
                         &quot;Medical abortion&quot;,
                         &quot;Maternal care for other conditions predominantly related to pregnancy&quot;,
                         &quot;Maternal care for known or suspected malpresentation of fetus&quot;,
                         &quot;Maternal care for known or suspected abnormality of pelvic organs&quot;,
                         &quot;Maternal care for other known or suspected fetal problems&quot;,
                         &quot;Labour and delivery complicated by fetal stress [distress]&quot;,
                         &quot;Other complications of labour and delivery, not elsewhere classified&quot;,
                         &quot;Other maternal diseases classifiable elsewhere but complicating pregnancy, childbirth and the puerperium&quot;,
                         &quot;Abnormal blood-pressure reading, without diagnosis&quot;,
                         &quot;Pain in throat and chest&quot;,
                         &quot;Other symptoms and signs involving the circulatory and respiratory systems&quot;,
                         &quot;Abdominal and pelvic pain&quot;,
                         &quot;Other symptoms and signs involving the digestive system and abdomen&quot;,
                         &quot;Other symptoms and signs involving the nervous and musculoskeletal systems&quot;,
                         &quot;Tendency to fall, not elsewhere classified&quot;,
                         &quot;Other symptoms and signs involving the urinary system&quot;,
                         &quot;Somnolence, stupor and coma&quot;,
                         &quot;Speech disturbances, not elsewhere classified&quot;,
                         &quot;Shock, not elsewhere classified&quot;,
                         &quot;Other complications of internal prosthetic devices, implants and grafts, not elsewhere classified&quot;,
                         &quot;Foreign body entering into or through eye or natural orifice&quot;,
                         &quot;Nosocomial condition&quot;,
                         &quot;Personal history of endocrine, nutritional and metabolic diseases&quot;,
                         &quot;Personal history of diseases of the musculoskeletal system and connective tissue&quot;,
                         &quot;Personal history of diseases of the genitourinary system&quot;,
                         &quot;Personal history of congenital malformations, deformations and chromosomal abnormalities&quot;,
                         &quot;Personal history of other specified conditions&quot;,
                         &quot;Other complications of internal prosthetic devices, implants and grafts, not elsewhere classified&quot;,
                         &quot;Personal history of allergy, other than to drugs and biological substances&quot;,
                         &quot;Personal history of allergy to unspecified drugs, medicaments and biological substances&quot;,
                         &quot;Personal history of allergy to other drugs, medicaments and biological substances
&quot;,
&quot;Personal history of allergy to drugs, medicaments and biological substances&quot;,
&quot;Personal history of chemotherapy for neoplastic disease&quot;,
&quot;Other noninflammatory disorders of vulva and perineum&quot;,
&quot;Resistance to betalactam antibiotics&quot;)
  )</code></pre>
<pre class="r"><code>manual_icd10_map &lt;-
  readxl::read_xlsx(here::here(&quot;data/icd/manual_disease_icd10_mappings.xlsx&quot;))

icd10_descriptions =
  phecodes |&gt;
  select(icd10_code = ICD10, 
         icd10_description = ICD_DESCRIPTION
         ) |&gt;
  distinct()

# Expand multiple ICD codes into rows
to_add_expanded &lt;- manual_icd10_map |&gt;
  mutate(icd10_code = str_split(icd10_code, &quot;,\\s*&quot;)) |&gt;
  tidyr::unnest(icd10_code)

icd10_descriptions = 
  bind_rows(
    icd10_descriptions,
    to_add_expanded |&gt;
      select(icd10_code, 
             icd10_description = icd10_desc),
    other_icd10_desc
  ) 

icd10_descriptions = icd10_descriptions |&gt; distinct()

icd10_descriptions = 
  icd10_descriptions |&gt;
  group_by(icd10_code) |&gt;
  summarise(icd10_description = 
            str_flatten(unique(icd10_description), collapse = &quot;; &quot;, na.rm = T), 
            .groups = &quot;drop&quot;
            )

disease_mapping =
  left_join(disease_mapping,
            icd10_descriptions,
            by = &quot;icd10_code&quot;,
            relationship = &quot;many-to-one&quot;,
            na_matches = &quot;never&quot;
            ) 


disease_mapping = 
  disease_mapping |&gt; 
    mutate(icd10_code = str_replace_all(
    icd10_code,
    pattern = &quot;R871&quot;,
    replacement = &quot;R87&quot;
    )
    ) 


disease_mapping = 
  disease_mapping |&gt; 
    mutate(icd10_description = 
    ifelse(icd10_code == &quot;R87&quot;,
           &quot;Abnormal findings in specimens from female genital organs&quot;,
           icd10_description)
    ) </code></pre>
</div>
</div>
<div id="missing-descriptions-for-icd10-codes" class="section level3">
<h3>Missing descriptions for ICD10 codes</h3>
<pre class="r"><code># check if any ICD10 codes are missing descriptions
disease_mapping |&gt; 
  filter(is.na(icd10_description)) |&gt;
  head()</code></pre>
<pre><code># A tibble: 6 × 7
  `DISEASE/TRAIT`            collected_all_diseas…¹ PUBMED_ID phecode icd10_code
  &lt;chr&gt;                      &lt;chr&gt;                      &lt;int&gt;   &lt;dbl&gt; &lt;chr&gt;     
1 Ribavirin-induced anemia   anemia                  20637204      NA D63.165.8 
2 Iron deficiency            anemia                  21483845      NA D63.165.8 
3 Source of report of D64 (… anemia                  36779085      NA D63.165.8 
4 Anemia in mycophenolic ac… anemia                  30801552      NA D63.165.8 
5 Genital aphthosis in Behc… genital aphthosis       37271218      NA &lt;NA&gt;      
6 Deferral due to hypohemog… anemia                  38018286      NA D63.165.8 
# ℹ abbreviated name: ¹​collected_all_disease_terms
# ℹ 2 more variables: icd10_code_origin &lt;chr&gt;, icd10_description &lt;chr&gt;</code></pre>
</div>
<div id="noticing-some-mistakes-in-mapped-trait-by-icd-10-codes"
class="section level3">
<h3>Noticing some mistakes in MAPPED trait by icd 10 codes</h3>
<pre class="r"><code>gwas_study_info |&gt; 
  filter(grepl(&quot;ICD10 F05&quot;, 
               `DISEASE/TRAIT`)) |&gt; 
  select(`DISEASE/TRAIT`, MAPPED_TRAIT, collected_all_disease_terms, PUBMED_ID)</code></pre>
<pre><code>                                                                  DISEASE/TRAIT
                                                                         &lt;char&gt;
1: ICD10 F05: Delirium due to known physiological condition (Gene-based burden)
2:                       ICD10 F05.9: Delirium, unspecified (Gene-based burden)
3:                                           ICD10 F05.9: Delirium, unspecified
4:                     ICD10 F05: Delirium due to known physiological condition
                  MAPPED_TRAIT collected_all_disease_terms PUBMED_ID
                        &lt;char&gt;                      &lt;char&gt;     &lt;int&gt;
1: alcohol withdrawal delirium   alcohol-related disorders  34662886
2:                    delirium                    delirium  34662886
3:                    delirium                    delirium  34662886
4: alcohol withdrawal delirium   alcohol-related disorders  34662886</code></pre>
<pre class="r"><code>disease_mapping |&gt; 
  filter(icd10_code == &quot;F05&quot;)</code></pre>
<pre><code># A tibble: 2 × 7
  `DISEASE/TRAIT`            collected_all_diseas…¹ PUBMED_ID phecode icd10_code
  &lt;chr&gt;                      &lt;chr&gt;                      &lt;int&gt;   &lt;dbl&gt; &lt;chr&gt;     
1 ICD10 F05: Delirium due t… alcohol-related disor…  34662886      NA F05       
2 ICD10 F05: Delirium due t… alcohol-related disor…  34662886      NA F05       
# ℹ abbreviated name: ¹​collected_all_disease_terms
# ℹ 2 more variables: icd10_code_origin &lt;chr&gt;, icd10_description &lt;chr&gt;</code></pre>
<pre class="r"><code># F05 refers to delirium not induced by alcohol and other psychoactive substances
# yet, the mapped trait is alcohol withdrawal delirium
# replace with delirium
disease_mapping = 
disease_mapping |&gt;
  mutate(collected_all_disease_terms = 
         ifelse(icd10_code == &quot;F05&quot;,
                &quot;delirium&quot;,
                collected_all_disease_terms)
         )

gwas_study_info =
  gwas_study_info |&gt;
  mutate(MAPPED_TRAIT = 
         ifelse(grepl(&quot;ICD10 F05&quot;, `DISEASE/TRAIT`),
                str_replace_all(collected_all_disease_terms,
                                pattern = &quot;alcohol-related disorders&quot;,
                                replacement = &quot;delirium&quot;),
                collected_all_disease_terms)
         )</code></pre>
</div>
<div id="save-disease-map" class="section level3">
<h3>Save disease map</h3>
<pre class="r"><code>disease_mapping = 
  disease_mapping |&gt; 
  arrange(collected_all_disease_terms, icd10_code)

fwrite(disease_mapping,
       here::here(&quot;output/icd_map/gwas_disease_to_icd10_mapping.csv&quot;)
       )</code></pre>
<br>
<p>
<button type="button" class="btn btn-default btn-workflowr btn-workflowr-sessioninfo" data-toggle="collapse" data-target="#workflowr-sessioninfo" style="display: block;">
<span class="glyphicon glyphicon-wrench" aria-hidden="true"></span>
Session information
</button>
</p>
<div id="workflowr-sessioninfo" class="collapse">
<pre class="r"><code>sessionInfo()</code></pre>
<pre><code>R version 4.3.1 (2023-06-16)
Platform: aarch64-apple-darwin20 (64-bit)
Running under: macOS 15.6.1

Matrix products: default
BLAS:   /Library/Frameworks/R.framework/Versions/4.3-arm64/Resources/lib/libRblas.0.dylib 
LAPACK: /Library/Frameworks/R.framework/Versions/4.3-arm64/Resources/lib/libRlapack.dylib;  LAPACK version 3.11.0

locale:
[1] en_US.UTF-8/en_US.UTF-8/en_US.UTF-8/C/en_US.UTF-8/en_US.UTF-8

time zone: America/Los_Angeles
tzcode source: internal

attached base packages:
[1] stats     graphics  grDevices datasets  utils     methods   base     

other attached packages:
[1] jsonlite_2.0.0    httr_1.4.7        data.table_1.17.8 stringr_1.5.1    
[5] dplyr_1.1.4       workflowr_1.7.1  

loaded via a namespace (and not attached):
 [1] compiler_4.3.1    renv_1.0.3        promises_1.3.3    tidyselect_1.2.1 
 [5] Rcpp_1.1.0        git2r_0.36.2      tidyr_1.3.1       callr_3.7.6      
 [9] later_1.4.2       jquerylib_0.1.4   readxl_1.4.5      yaml_2.3.10      
[13] fastmap_1.2.0     here_1.0.1        R6_2.6.1          generics_0.1.4   
[17] knitr_1.50        tibble_3.3.0      rprojroot_2.1.0   bslib_0.9.0      
[21] pillar_1.11.0     rlang_1.1.6       utf8_1.2.6        cachem_1.1.0     
[25] stringi_1.8.7     httpuv_1.6.16     xfun_0.52         getPass_0.2-4    
[29] fs_1.6.6          sass_0.4.10       cli_3.6.5         withr_3.0.2      
[33] magrittr_2.0.3    ps_1.9.1          digest_0.6.37     processx_3.8.6   
[37] rstudioapi_0.17.1 lifecycle_1.0.4   vctrs_0.6.5       evaluate_1.0.4   
[41] glue_1.8.0        cellranger_1.1.0  whisker_0.4.1     purrr_1.1.0      
[45] rmarkdown_2.29    tools_4.3.1       pkgconfig_2.0.3   htmltools_0.5.8.1</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>


<!-- Adjust MathJax settings so that all math formulae are shown using
TeX fonts only; see
https://docs.mathjax.org/en/latest/web/configuration.html. This will make
the presentation more consistent at the cost of the webpage sometimes
taking slightly longer to load. Note that this only works because the
footer is added to webpages before the MathJax javascript. -->
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    "HTML-CSS": { availableFonts: ["TeX"] }
  });
</script>




</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->

<script>
$(document).ready(function ()  {

    // temporarily add toc-ignore selector to headers for the consistency with Pandoc
    $('.unlisted.unnumbered').addClass('toc-ignore')

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
