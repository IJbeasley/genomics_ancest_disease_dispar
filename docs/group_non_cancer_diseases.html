<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />


<meta name="author" content="Isobel Beasley" />

<meta name="date" content="2025-09-28" />

<title>group_non_cancer_diseases</title>

<script src="site_libs/header-attrs-2.30/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/cosmo.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/jqueryui-1.13.2/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<link href="site_libs/highlightjs-9.12.0/textmate.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>

<link rel="icon" href="https://github.com/workflowr/workflowr-assets/raw/main/img/reproducible.png">
<!-- Add a small amount of space between sections. -->
<style type="text/css">
div.section {
  padding-top: 12px;
}
</style>



<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>









<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark the anchor link active (and if it's in a dropdown, also mark that active)
  var dropdown = menuAnchor.closest('li.dropdown');
  if (window.bootstrap) { // Bootstrap 4+
    menuAnchor.addClass('active');
    dropdown.find('> .dropdown-toggle').addClass('active');
  } else { // Bootstrap 3
    menuAnchor.parent().addClass('active');
    dropdown.addClass('active');
  }

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before, .tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "\e259";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "\e258";
  font-family: 'Glyphicons Halflings';
  border: none;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-bs-toggle="collapse" data-target="#navbar" data-bs-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">genomics_ancest_disease_dispar</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">Home</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">



<h1 class="title toc-ignore">group_non_cancer_diseases</h1>
<h4 class="author">Isobel Beasley</h4>
<h4 class="date">2025-09-28</h4>

</div>


<p>
<button type="button" class="btn btn-default btn-workflowr btn-workflowr-report" data-toggle="collapse" data-target="#workflowr-report">
<span class="glyphicon glyphicon-list" aria-hidden="true"></span>
workflowr <span class="glyphicon glyphicon-ok text-success"
aria-hidden="true"></span>
</button>
</p>
<div id="workflowr-report" class="collapse">
<ul class="nav nav-tabs">
<li class="active">
<a data-toggle="tab" href="#summary">Summary</a>
</li>
<li>
<a data-toggle="tab" href="#checks"> Checks <span
class="glyphicon glyphicon-ok text-success" aria-hidden="true"></span>
</a>
</li>
<li>
<a data-toggle="tab" href="#versions">Past versions</a>
</li>
</ul>
<div class="tab-content">
<div id="summary" class="tab-pane fade in active">
<p>
<strong>Last updated:</strong> 2026-01-12
</p>
<p>
<strong>Checks:</strong> <span
class="glyphicon glyphicon-ok text-success" aria-hidden="true"></span> 7
<span class="glyphicon glyphicon-exclamation-sign text-danger"
aria-hidden="true"></span> 0
</p>
<p>
<strong>Knit directory:</strong>
<code>genomics_ancest_disease_dispar/</code> <span
class="glyphicon glyphicon-question-sign" aria-hidden="true"
title="This is the local directory in which the code in this file was executed.">
</span>
</p>
<p>
This reproducible <a href="https://rmarkdown.rstudio.com">R Markdown</a>
analysis was created with <a
  href="https://github.com/workflowr/workflowr">workflowr</a> (version
1.7.1). The <em>Checks</em> tab describes the reproducibility checks
that were applied when the results were created. The <em>Past
versions</em> tab lists the development history.
</p>
<hr>
</div>
<div id="checks" class="tab-pane fade">
<div id="workflowr-checks" class="panel-group">
<div class="panel panel-default">
<div class="panel-heading">
<p class="panel-title">
<a data-toggle="collapse" data-parent="#workflowr-checks" href="#strongRMarkdownfilestronguptodate">
<span class="glyphicon glyphicon-ok text-success"
aria-hidden="true"></span> <strong>R Markdown file:</strong> up-to-date
</a>
</p>
</div>
<div id="strongRMarkdownfilestronguptodate"
class="panel-collapse collapse">
<div class="panel-body">
<p>Great! Since the R Markdown file has been committed to the Git
repository, you know the exact version of the code that produced these
results.</p>
</div>
</div>
</div>
<div class="panel panel-default">
<div class="panel-heading">
<p class="panel-title">
<a data-toggle="collapse" data-parent="#workflowr-checks" href="#strongEnvironmentstrongempty">
<span class="glyphicon glyphicon-ok text-success"
aria-hidden="true"></span> <strong>Environment:</strong> empty </a>
</p>
</div>
<div id="strongEnvironmentstrongempty" class="panel-collapse collapse">
<div class="panel-body">
<p>Great job! The global environment was empty. Objects defined in the
global environment can affect the analysis in your R Markdown file in
unknown ways. For reproduciblity it’s best to always run the code in an
empty environment.</p>
</div>
</div>
</div>
<div class="panel panel-default">
<div class="panel-heading">
<p class="panel-title">
<a data-toggle="collapse" data-parent="#workflowr-checks" href="#strongSeedstrongcodesetseed20220216code">
<span class="glyphicon glyphicon-ok text-success"
aria-hidden="true"></span> <strong>Seed:</strong>
<code>set.seed(20220216)</code> </a>
</p>
</div>
<div id="strongSeedstrongcodesetseed20220216code"
class="panel-collapse collapse">
<div class="panel-body">
<p>The command <code>set.seed(20220216)</code> was run prior to running
the code in the R Markdown file. Setting a seed ensures that any results
that rely on randomness, e.g. subsampling or permutations, are
reproducible.</p>
</div>
</div>
</div>
<div class="panel panel-default">
<div class="panel-heading">
<p class="panel-title">
<a data-toggle="collapse" data-parent="#workflowr-checks" href="#strongSessioninformationstrongrecorded">
<span class="glyphicon glyphicon-ok text-success"
aria-hidden="true"></span> <strong>Session information:</strong>
recorded </a>
</p>
</div>
<div id="strongSessioninformationstrongrecorded"
class="panel-collapse collapse">
<div class="panel-body">
<p>Great job! Recording the operating system, R version, and package
versions is critical for reproducibility.</p>
</div>
</div>
</div>
<div class="panel panel-default">
<div class="panel-heading">
<p class="panel-title">
<a data-toggle="collapse" data-parent="#workflowr-checks" href="#strongCachestrongnone">
<span class="glyphicon glyphicon-ok text-success"
aria-hidden="true"></span> <strong>Cache:</strong> none </a>
</p>
</div>
<div id="strongCachestrongnone" class="panel-collapse collapse">
<div class="panel-body">
<p>Nice! There were no cached chunks for this analysis, so you can be
confident that you successfully produced the results during this
run.</p>
</div>
</div>
</div>
<div class="panel panel-default">
<div class="panel-heading">
<p class="panel-title">
<a data-toggle="collapse" data-parent="#workflowr-checks" href="#strongFilepathsstrongrelative">
<span class="glyphicon glyphicon-ok text-success"
aria-hidden="true"></span> <strong>File paths:</strong> relative </a>
</p>
</div>
<div id="strongFilepathsstrongrelative" class="panel-collapse collapse">
<div class="panel-body">
<p>Great job! Using relative paths to the files within your workflowr
project makes it easier to run your code on other machines.</p>
</div>
</div>
</div>
<div class="panel panel-default">
<div class="panel-heading">
<p class="panel-title">
<a data-toggle="collapse" data-parent="#workflowr-checks" href="#strongRepositoryversionstrongahrefhttpsgithubcomIJbeasleygenomicsancestdiseasedispartree7eb9190268cd2da21d27052d668ed82835edd8f1targetblank7eb9190a">
<span class="glyphicon glyphicon-ok text-success"
aria-hidden="true"></span> <strong>Repository version:</strong>
<a href="https://github.com/IJbeasley/genomics_ancest_disease_dispar/tree/7eb9190268cd2da21d27052d668ed82835edd8f1" target="_blank">7eb9190</a>
</a>
</p>
</div>
<div
id="strongRepositoryversionstrongahrefhttpsgithubcomIJbeasleygenomicsancestdiseasedispartree7eb9190268cd2da21d27052d668ed82835edd8f1targetblank7eb9190a"
class="panel-collapse collapse">
<div class="panel-body">
<p>
Great! You are using Git for version control. Tracking code development
and connecting the code version to the results is critical for
reproducibility.
</p>
<p>
The results in this page were generated with repository version
<a href="https://github.com/IJbeasley/genomics_ancest_disease_dispar/tree/7eb9190268cd2da21d27052d668ed82835edd8f1" target="_blank">7eb9190</a>.
See the <em>Past versions</em> tab to see a history of the changes made
to the R Markdown and HTML files.
</p>
<p>
Note that you need to be careful to ensure that all relevant files for
the analysis have been committed to Git prior to generating the results
(you can use <code>wflow_publish</code> or
<code>wflow_git_commit</code>). workflowr only checks the R Markdown
file, but you know if there are other scripts or data files that it
depends on. Below is the status of the Git repository when the results
were generated:
</p>
<pre><code>
Ignored files:
    Ignored:    .DS_Store
    Ignored:    .Rproj.user/
    Ignored:    .venv/
    Ignored:    analysis/.DS_Store
    Ignored:    ancestry_dispar_env/
    Ignored:    data/.DS_Store
    Ignored:    data/RCDCFundingSummary_01042026.xlsx
    Ignored:    data/cdc/
    Ignored:    data/cohort/
    Ignored:    data/epmc/
    Ignored:    data/europe_pmc/
    Ignored:    data/gbd/.DS_Store
    Ignored:    data/gbd/IHME-GBD_2021_DATA-d8cf695e-1.csv
    Ignored:    data/gbd/IHME-GBD_2023_DATA-73cc01fd-1.csv
    Ignored:    data/gbd/ihme_gbd_2019_global_disease_burden_rate_all_ages.csv
    Ignored:    data/gbd/ihme_gbd_2019_global_paf_rate_percent_all_ages.csv
    Ignored:    data/gbd/ihme_gbd_2021_global_disease_burden_rate_all_ages.csv
    Ignored:    data/gbd/ihme_gbd_2021_global_paf_rate_percent_all_ages.csv
    Ignored:    data/gwas_catalog/
    Ignored:    data/icd/.DS_Store
    Ignored:    data/icd/2025AA/
    Ignored:    data/icd/IHME_GBD_2019_COD_CAUSE_ICD_CODE_MAP_Y2020M10D15.XLSX
    Ignored:    data/icd/IHME_GBD_2019_NONFATAL_CAUSE_ICD_CODE_MAP_Y2020M10D15.XLSX
    Ignored:    data/icd/IHME_GBD_2021_COD_CAUSE_ICD_CODE_MAP_Y2024M05D16.XLSX
    Ignored:    data/icd/IHME_GBD_2021_NONFATAL_CAUSE_ICD_CODE_MAP_Y2024M05D16.XLSX
    Ignored:    data/icd/UK_Biobank_master_file.tsv
    Ignored:    data/icd/cdc_valid_icd10_Sep_23_2025.xlsx
    Ignored:    data/icd/cdc_valid_icd9_Sep_23_2025.xlsx
    Ignored:    data/icd/hp_umls_mapping.csv
    Ignored:    data/icd/lancet_conditions_icd10.xlsx
    Ignored:    data/icd/manual_disease_icd10_mappings.xlsx
    Ignored:    data/icd/mondo_umls_mapping.csv
    Ignored:    data/icd/phecode_international_version_unrolled.csv
    Ignored:    data/icd/phecode_to_icd10_manual_mapping.xlsx
    Ignored:    data/icd/semiautomatic_ICD-pheno.txt
    Ignored:    data/icd/semiautomatic_ICD-pheno_UKB_subset.txt
    Ignored:    data/icd/umls-2025AA-mrconso.zip
    Ignored:    figures/
    Ignored:    output/.DS_Store
    Ignored:    output/abstracts/
    Ignored:    output/doccano/
    Ignored:    output/fulltexts/
    Ignored:    output/gwas_cat/
    Ignored:    output/gwas_cohorts/
    Ignored:    output/icd_map/
    Ignored:    output/trait_ontology/
    Ignored:    pubmedbert-cohort-ner-model/
    Ignored:    pubmedbert-cohort-ner/
    Ignored:    r-spacyr/
    Ignored:    renv/
    Ignored:    venv/

Unstaged changes:
    Modified:   analysis/disease_inves_by_ancest.Rmd
    Modified:   analysis/gwas_to_gbd.Rmd
    Modified:   analysis/index.Rmd
    Modified:   analysis/map_trait_to_icd10.Rmd
    Modified:   analysis/missing_cohort_info.Rmd
    Modified:   analysis/replication_ancestry_bias.Rmd
    Modified:   analysis/text_for_cohort_labels.Rmd

</code></pre>
<p>
Note that any generated files, e.g. HTML, png, CSS, etc., are not
included in this status report because it is ok for generated content to
have uncommitted changes.
</p>
</div>
</div>
</div>
</div>
<hr>
</div>
<div id="versions" class="tab-pane fade">
<p>
These are the previous versions of the repository in which changes were
made to the R Markdown
(<code>analysis/group_non_cancer_diseases.Rmd</code>) and HTML
(<code>docs/group_non_cancer_diseases.html</code>) files. If you’ve
configured a remote Git repository (see <code>?wflow_git_remote</code>),
click on the hyperlinks in the table below to view the files as they
were in that past version.
</p>
<div class="table-responsive">
<table class="table table-condensed table-hover">
<thead>
<tr>
<th>
File
</th>
<th>
Version
</th>
<th>
Author
</th>
<th>
Date
</th>
<th>
Message
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
html
</td>
<td>
<a href="https://rawcdn.githack.com/IJbeasley/genomics_ancest_disease_dispar/1cdccac9a621d8b5c35290c9a55424b28750a494/docs/group_non_cancer_diseases.html" target="_blank">1cdccac</a>
</td>
<td>
IJbeasley
</td>
<td>
2026-01-05
</td>
<td>
Build site.
</td>
</tr>
<tr>
<td>
html
</td>
<td>
<a href="https://rawcdn.githack.com/IJbeasley/genomics_ancest_disease_dispar/f2e43de162baaa99026aa8c96b19656a09a8553e/docs/group_non_cancer_diseases.html" target="_blank">f2e43de</a>
</td>
<td>
IJbeasley
</td>
<td>
2026-01-04
</td>
<td>
Build site.
</td>
</tr>
<tr>
<td>
html
</td>
<td>
<a href="https://rawcdn.githack.com/IJbeasley/genomics_ancest_disease_dispar/554f8b0bf90a80dc5d14912ee0a6b0c0a91f3218/docs/group_non_cancer_diseases.html" target="_blank">554f8b0</a>
</td>
<td>
IJbeasley
</td>
<td>
2026-01-03
</td>
<td>
Build site.
</td>
</tr>
<tr>
<td>
html
</td>
<td>
<a href="https://rawcdn.githack.com/IJbeasley/genomics_ancest_disease_dispar/7817b8dddf62e26d874ec3cf6e903eb440fe8e71/docs/group_non_cancer_diseases.html" target="_blank">7817b8d</a>
</td>
<td>
IJbeasley
</td>
<td>
2025-12-29
</td>
<td>
Build site.
</td>
</tr>
<tr>
<td>
html
</td>
<td>
<a href="https://rawcdn.githack.com/IJbeasley/genomics_ancest_disease_dispar/b147392d521586119069e023baea82774fd23f1d/docs/group_non_cancer_diseases.html" target="_blank">b147392</a>
</td>
<td>
IJbeasley
</td>
<td>
2025-12-29
</td>
<td>
Build site.
</td>
</tr>
<tr>
<td>
html
</td>
<td>
<a href="https://rawcdn.githack.com/IJbeasley/genomics_ancest_disease_dispar/da3fa147c5b77586a8276e7319ed7c5684f95cd1/docs/group_non_cancer_diseases.html" target="_blank">da3fa14</a>
</td>
<td>
IJbeasley
</td>
<td>
2025-12-29
</td>
<td>
Build site.
</td>
</tr>
<tr>
<td>
html
</td>
<td>
<a href="https://rawcdn.githack.com/IJbeasley/genomics_ancest_disease_dispar/45dbf813482451c733627fb48c2fc5afa565e1fc/docs/group_non_cancer_diseases.html" target="_blank">45dbf81</a>
</td>
<td>
IJbeasley
</td>
<td>
2025-12-29
</td>
<td>
Build site.
</td>
</tr>
<tr>
<td>
Rmd
</td>
<td>
<a href="https://github.com/IJbeasley/genomics_ancest_disease_dispar/blob/30b73219d7e40f8f74226dbedc0bd79fb95ca99e/analysis/group_non_cancer_diseases.Rmd" target="_blank">30b7321</a>
</td>
<td>
IJbeasley
</td>
<td>
2025-12-29
</td>
<td>
Update grouping of non-cancer diseases
</td>
</tr>
<tr>
<td>
html
</td>
<td>
<a href="https://rawcdn.githack.com/IJbeasley/genomics_ancest_disease_dispar/13f8a41dad6556e2ddc90c30aae3a660b9bea538/docs/group_non_cancer_diseases.html" target="_blank">13f8a41</a>
</td>
<td>
IJbeasley
</td>
<td>
2025-10-08
</td>
<td>
Build site.
</td>
</tr>
<tr>
<td>
html
</td>
<td>
<a href="https://rawcdn.githack.com/IJbeasley/genomics_ancest_disease_dispar/f5f3acee3f1736b03f7c7a50f506ea9702517962/docs/group_non_cancer_diseases.html" target="_blank">f5f3ace</a>
</td>
<td>
IJbeasley
</td>
<td>
2025-10-08
</td>
<td>
Build site.
</td>
</tr>
<tr>
<td>
html
</td>
<td>
<a href="https://rawcdn.githack.com/IJbeasley/genomics_ancest_disease_dispar/d17abe195a9d85f71d98a57983fc5ac8572fe1cf/docs/group_non_cancer_diseases.html" target="_blank">d17abe1</a>
</td>
<td>
IJbeasley
</td>
<td>
2025-10-03
</td>
<td>
Build site.
</td>
</tr>
<tr>
<td>
Rmd
</td>
<td>
<a href="https://github.com/IJbeasley/genomics_ancest_disease_dispar/blob/05f8bff5901bd1f6447c511e2cb6cfee129360ea/analysis/group_non_cancer_diseases.Rmd" target="_blank">05f8bff</a>
</td>
<td>
IJbeasley
</td>
<td>
2025-10-03
</td>
<td>
Update / improve non-cancer disease grouping
</td>
</tr>
<tr>
<td>
html
</td>
<td>
<a href="https://rawcdn.githack.com/IJbeasley/genomics_ancest_disease_dispar/f2704e8ae86340bbbf0d2d06a293121223653ab8/docs/group_non_cancer_diseases.html" target="_blank">f2704e8</a>
</td>
<td>
IJbeasley
</td>
<td>
2025-09-30
</td>
<td>
Build site.
</td>
</tr>
<tr>
<td>
Rmd
</td>
<td>
<a href="https://github.com/IJbeasley/genomics_ancest_disease_dispar/blob/fb5244ba078be7ef0fef0b6e76646451d0dd24b2/analysis/group_non_cancer_diseases.Rmd" target="_blank">fb5244b</a>
</td>
<td>
IJbeasley
</td>
<td>
2025-09-30
</td>
<td>
workflowr::wflow_publish("analysis/group_non_cancer_diseases.Rmd")
</td>
</tr>
<tr>
<td>
html
</td>
<td>
<a href="https://rawcdn.githack.com/IJbeasley/genomics_ancest_disease_dispar/2e0797efc058863b47093d867d84b3c585a20db4/docs/group_non_cancer_diseases.html" target="_blank">2e0797e</a>
</td>
<td>
IJbeasley
</td>
<td>
2025-09-29
</td>
<td>
Build site.
</td>
</tr>
<tr>
<td>
Rmd
</td>
<td>
<a href="https://github.com/IJbeasley/genomics_ancest_disease_dispar/blob/9174f8345c04a866ac081f693f3bef0c4b82108e/analysis/group_non_cancer_diseases.Rmd" target="_blank">9174f83</a>
</td>
<td>
IJbeasley
</td>
<td>
2025-09-29
</td>
<td>
workflowr::wflow_publish("analysis/group_non_cancer_diseases.Rmd")
</td>
</tr>
<tr>
<td>
html
</td>
<td>
<a href="https://rawcdn.githack.com/IJbeasley/genomics_ancest_disease_dispar/77a0ef3fe9180651ac3cf969ed9973b0596b48aa/docs/group_non_cancer_diseases.html" target="_blank">77a0ef3</a>
</td>
<td>
IJbeasley
</td>
<td>
2025-09-29
</td>
<td>
Build site.
</td>
</tr>
<tr>
<td>
Rmd
</td>
<td>
<a href="https://github.com/IJbeasley/genomics_ancest_disease_dispar/blob/c76c87d1b5360771679c9dee93e80c101fe45c68/analysis/group_non_cancer_diseases.Rmd" target="_blank">c76c87d</a>
</td>
<td>
IJbeasley
</td>
<td>
2025-09-29
</td>
<td>
workflowr::wflow_publish("analysis/group_non_cancer_diseases.Rmd")
</td>
</tr>
<tr>
<td>
html
</td>
<td>
<a href="https://rawcdn.githack.com/IJbeasley/genomics_ancest_disease_dispar/1649f352e60865cfaeb0123578f8a015aeb35c5b/docs/group_non_cancer_diseases.html" target="_blank">1649f35</a>
</td>
<td>
IJbeasley
</td>
<td>
2025-09-29
</td>
<td>
Build site.
</td>
</tr>
<tr>
<td>
Rmd
</td>
<td>
<a href="https://github.com/IJbeasley/genomics_ancest_disease_dispar/blob/92641698d52d60a7f5d18104fcd3aa04cd2a3c7a/analysis/group_non_cancer_diseases.Rmd" target="_blank">9264169</a>
</td>
<td>
IJbeasley
</td>
<td>
2025-09-29
</td>
<td>
workflowr::wflow_publish("analysis/group_non_cancer_diseases.Rmd")
</td>
</tr>
<tr>
<td>
html
</td>
<td>
<a href="https://rawcdn.githack.com/IJbeasley/genomics_ancest_disease_dispar/088e39a33f9f0f85a8fb74b9de2d59157b6c3258/docs/group_non_cancer_diseases.html" target="_blank">088e39a</a>
</td>
<td>
IJbeasley
</td>
<td>
2025-09-29
</td>
<td>
Build site.
</td>
</tr>
<tr>
<td>
Rmd
</td>
<td>
<a href="https://github.com/IJbeasley/genomics_ancest_disease_dispar/blob/abcec61a9f46fcb7e120693c346b8249884fa89d/analysis/group_non_cancer_diseases.Rmd" target="_blank">abcec61</a>
</td>
<td>
IJbeasley
</td>
<td>
2025-09-29
</td>
<td>
workflowr::wflow_publish("analysis/group_non_cancer_diseases.Rmd")
</td>
</tr>
<tr>
<td>
html
</td>
<td>
<a href="https://rawcdn.githack.com/IJbeasley/genomics_ancest_disease_dispar/f145113b0aee472e82317d38059e218d127f9d38/docs/group_non_cancer_diseases.html" target="_blank">f145113</a>
</td>
<td>
IJbeasley
</td>
<td>
2025-09-29
</td>
<td>
Build site.
</td>
</tr>
<tr>
<td>
Rmd
</td>
<td>
<a href="https://github.com/IJbeasley/genomics_ancest_disease_dispar/blob/08a1dec3af752649b3a81677464d2d23d64780fb/analysis/group_non_cancer_diseases.Rmd" target="_blank">08a1dec</a>
</td>
<td>
IJbeasley
</td>
<td>
2025-09-29
</td>
<td>
workflowr::wflow_publish("analysis/group_non_cancer_diseases.Rmd")
</td>
</tr>
<tr>
<td>
html
</td>
<td>
<a href="https://rawcdn.githack.com/IJbeasley/genomics_ancest_disease_dispar/03e566e5ca61eb9ec057e4431bd4e215924997ed/docs/group_non_cancer_diseases.html" target="_blank">03e566e</a>
</td>
<td>
IJbeasley
</td>
<td>
2025-09-29
</td>
<td>
Build site.
</td>
</tr>
<tr>
<td>
Rmd
</td>
<td>
<a href="https://github.com/IJbeasley/genomics_ancest_disease_dispar/blob/7a9fbf7fdbfc54f6840ffe6535c42ee3b1faef43/analysis/group_non_cancer_diseases.Rmd" target="_blank">7a9fbf7</a>
</td>
<td>
IJbeasley
</td>
<td>
2025-09-29
</td>
<td>
workflowr::wflow_publish("analysis/group_non_cancer_diseases.Rmd")
</td>
</tr>
<tr>
<td>
html
</td>
<td>
<a href="https://rawcdn.githack.com/IJbeasley/genomics_ancest_disease_dispar/d4610b1cf989ef0b1c3abf536fd0782444c34742/docs/group_non_cancer_diseases.html" target="_blank">d4610b1</a>
</td>
<td>
IJbeasley
</td>
<td>
2025-09-28
</td>
<td>
Build site.
</td>
</tr>
<tr>
<td>
Rmd
</td>
<td>
<a href="https://github.com/IJbeasley/genomics_ancest_disease_dispar/blob/44dec62e9b8ed9988bfcd0dd28034bc0815c15a6/analysis/group_non_cancer_diseases.Rmd" target="_blank">44dec62</a>
</td>
<td>
IJbeasley
</td>
<td>
2025-09-28
</td>
<td>
workflowr::wflow_publish("analysis/group_non_cancer_diseases.Rmd")
</td>
</tr>
<tr>
<td>
html
</td>
<td>
<a href="https://rawcdn.githack.com/IJbeasley/genomics_ancest_disease_dispar/67e5464179bbfcca31f2d6dbbe27ae3756863eb3/docs/group_non_cancer_diseases.html" target="_blank">67e5464</a>
</td>
<td>
IJbeasley
</td>
<td>
2025-09-28
</td>
<td>
Build site.
</td>
</tr>
<tr>
<td>
Rmd
</td>
<td>
<a href="https://github.com/IJbeasley/genomics_ancest_disease_dispar/blob/99426f4665da6de5a6b0f8b64b4226ababc507d5/analysis/group_non_cancer_diseases.Rmd" target="_blank">99426f4</a>
</td>
<td>
IJbeasley
</td>
<td>
2025-09-28
</td>
<td>
workflowr::wflow_publish("analysis/group_non_cancer_diseases.Rmd")
</td>
</tr>
<tr>
<td>
html
</td>
<td>
<a href="https://rawcdn.githack.com/IJbeasley/genomics_ancest_disease_dispar/b4be7a2863069664a45dc8b59b65a0b63aa9eb06/docs/group_non_cancer_diseases.html" target="_blank">b4be7a2</a>
</td>
<td>
IJbeasley
</td>
<td>
2025-09-28
</td>
<td>
Build site.
</td>
</tr>
<tr>
<td>
Rmd
</td>
<td>
<a href="https://github.com/IJbeasley/genomics_ancest_disease_dispar/blob/25fdd1f5f241066fc4cd1e5d0ef8c05af51482d7/analysis/group_non_cancer_diseases.Rmd" target="_blank">25fdd1f</a>
</td>
<td>
IJbeasley
</td>
<td>
2025-09-28
</td>
<td>
workflowr::wflow_publish("analysis/group_non_cancer_diseases.Rmd")
</td>
</tr>
<tr>
<td>
html
</td>
<td>
<a href="https://rawcdn.githack.com/IJbeasley/genomics_ancest_disease_dispar/d775543b8b1f8a80a3950ce9fae44f085d5eb03a/docs/group_non_cancer_diseases.html" target="_blank">d775543</a>
</td>
<td>
IJbeasley
</td>
<td>
2025-09-28
</td>
<td>
Build site.
</td>
</tr>
<tr>
<td>
Rmd
</td>
<td>
<a href="https://github.com/IJbeasley/genomics_ancest_disease_dispar/blob/e777ee8c1769729ff560de3c075f55e91a9f9954/analysis/group_non_cancer_diseases.Rmd" target="_blank">e777ee8</a>
</td>
<td>
IJbeasley
</td>
<td>
2025-09-28
</td>
<td>
workflowr::wflow_publish("analysis/group_non_cancer_diseases.Rmd")
</td>
</tr>
<tr>
<td>
html
</td>
<td>
<a href="https://rawcdn.githack.com/IJbeasley/genomics_ancest_disease_dispar/3640ce03e409f3d214bdfb2ba54589647d66a63c/docs/group_non_cancer_diseases.html" target="_blank">3640ce0</a>
</td>
<td>
IJbeasley
</td>
<td>
2025-09-28
</td>
<td>
Build site.
</td>
</tr>
<tr>
<td>
Rmd
</td>
<td>
<a href="https://github.com/IJbeasley/genomics_ancest_disease_dispar/blob/d8f04de6b968807b53a3cf04682c98f09b2c68a7/analysis/group_non_cancer_diseases.Rmd" target="_blank">d8f04de</a>
</td>
<td>
IJbeasley
</td>
<td>
2025-09-28
</td>
<td>
Using ICD / PheCode mapping
</td>
</tr>
</tbody>
</table>
</div>
<hr>
</div>
</div>
</div>
<div id="set-up" class="section level1">
<h1>Set up</h1>
<pre class="r"><code>library(dplyr)
library(stringr)
library(data.table)</code></pre>
<div id="ontology-help---for-getting-disease-subtypes"
class="section level2">
<h2>Ontology help - for getting disease subtypes</h2>
<pre class="r"><code>source(here::here(&quot;code/get_term_descendants.R&quot;))</code></pre>
<div id="load-data" class="section level3">
<h3>Load Data</h3>
<pre class="r"><code># gwas_study_info &lt;- fread(here::here(&quot;output/gwas_cat/gwas_study_info_group.csv&quot;))
gwas_study_info &lt;- data.table::fread(here::here(&quot;output/gwas_cat/gwas_study_cancer_group.csv&quot;))</code></pre>
</div>
</div>
<div id="basic-corrections" class="section level2">
<h2>Basic corrections</h2>
<div id="post-operative" class="section level3">
<h3>Post-operative</h3>
<pre class="r"><code>gwas_study_info = gwas_study_info |&gt; 
    mutate(collected_all_disease_terms  = 
         stringr::str_remove_all(collected_all_disease_terms,
                         pattern = &quot;^post-operative |^postoperative&quot;
         ))</code></pre>
</div>
<div id="typo-spine-psteoarthritis" class="section level3">
<h3>Typo: spine psteoarthritis</h3>
<pre class="r"><code>gwas_study_info =
  gwas_study_info |&gt;
  mutate(collected_all_disease_terms  = 
         stringr::str_replace_all(collected_all_disease_terms,
                          vec_to_grep_pattern(c(
                            &quot;spine psteoarthritis&quot;
                            )
                            ),
                          &quot;spine osteoarthritis&quot;
         )
  )</code></pre>
</div>
</div>
</div>
<div id="specific-study-corrections" class="section level1">
<h1>Specific study corrections</h1>
<div id="pubmed-id-37271218-study-of-complications-in-behcets-disease"
class="section level3">
<h3>Pubmed id: 37271218 (Study of complications in Behcet’s
disease)</h3>
<p>Taking definitions etc. from: <a
href="https://pmc-ncbi-nlm-nih-gov.ucsf.idm.oclc.org/articles/PMC8584626/"
class="uri">https://pmc-ncbi-nlm-nih-gov.ucsf.idm.oclc.org/articles/PMC8584626/</a></p>
<pre class="r"><code>gwas_study_info = gwas_study_info |&gt;
  mutate(collected_all_disease_terms  = 
         ifelse(PUBMED_ID == &quot;37271218&quot;,
                stringr::str_replace_all(collected_all_disease_terms,
                          pattern = &quot;abnormality of the eye&quot;,
                          replacement = &quot;uveitis, retinal vasculitis, chorioretinitis, papillitis&quot;
         ),
         collected_all_disease_terms
         )
  )

gwas_study_info = gwas_study_info |&gt;
  mutate(collected_all_disease_terms  = 
         ifelse(PUBMED_ID == &quot;37271218&quot;,
                stringr::str_replace_all(collected_all_disease_terms,
                          pattern = &quot;abnormality of the genital system&quot;,
                          replacement = &quot;genital aphthosis&quot;
         ),
         collected_all_disease_terms
         )
  )

gwas_study_info = gwas_study_info |&gt;
  mutate(collected_all_disease_terms  = 
         ifelse(PUBMED_ID == &quot;37271218&quot;,
                stringr::str_replace_all(collected_all_disease_terms,
                          pattern = &quot;abnormal aortic morphology&quot;,
                          replacement = &quot;arterial thrombosis, aortic aneurysm, aneurysm of pulmonary artery&quot;
         ),
         collected_all_disease_terms
         )
  )

gwas_study_info = gwas_study_info |&gt;
  mutate(collected_all_disease_terms  = 
         ifelse(PUBMED_ID == &quot;37271218&quot;,
                stringr::str_replace_all(collected_all_disease_terms,
                          pattern = &quot;abnormal venous morphology&quot;,
                          replacement = &quot;venous thromboembolism, superficial thrombophlebitis&quot;
         ),
         collected_all_disease_terms
         )
  )


gwas_study_info = gwas_study_info |&gt;
  mutate(collected_all_disease_terms  = 
         ifelse(PUBMED_ID == &quot;37271218&quot;,
                stringr::str_replace_all(collected_all_disease_terms,
                          pattern = &quot;abnormality of the vasculature&quot;,
                          replacement = &quot;arterial thrombosis, aortic aneurysm, aneurysm of pulmonary artery, venous thromboembolism, superficial thrombophlebitis&quot;
         ),
         collected_all_disease_terms
         )
  )</code></pre>
</div>
<div
id="pubmed-id-21878436-coronary-restenosis---add-inclusion-criteria"
class="section level3">
<h3>Pubmed id: 21878436 (Coronary restenosis &lt;- add inclusion
criteria)</h3>
<pre class="r"><code># for pubmed id 21878436 
# measuring Coronary restenosis, which is an outcome of Percutaneous coronary intervention (PCI)
# included / background traits for the relevant study GENetic DEterminants of Restenosis project (GENDER) 
# are found:
# https://academic.oup.com/eurheartj/article/25/13/1163/465324?login=true#89258510

# stable angina
# silent ischaemia -&gt; silent myocardial ischaemia
# non-ST-elevation acute coronary syndromes excl. acute ST-elevation myocardial infarction
# this includes: 
# unstable angina, 
# non-ST-elevation myocardial infarction (NSTEMI) within acute subendocardial myocardial infarction
# Acute ischemic heart disease, unspecified: 

gwas_study_info = gwas_study_info |&gt;
  mutate(collected_all_disease_terms  = 
         ifelse(PUBMED_ID == &quot;21878436&quot;,
                stringr::str_replace_all(collected_all_disease_terms,
                          pattern = &quot;coronary restenosis&quot;,
                          replacement = &quot;coronary restenosis, stable angina, silent myocardial ischaemia, unstable angina, acute subendocardial myocardial infarction, acute ischemic heart disease&quot;
         ),
         collected_all_disease_terms
         )
  )</code></pre>
</div>
<div id="how-many-unique-traits-are-there-now" class="section level3">
<h3>How many unique traits are there now?</h3>
<pre class="r"><code>diseases &lt;- stringr::str_split(pattern = &quot;, &quot;,
                               gwas_study_info$collected_all_disease_terms[gwas_study_info$collected_all_disease_terms != &quot;&quot;])  |&gt;
  unlist() |&gt;
  stringr::str_trim()

diseases &lt;- unique(diseases)

print(length(diseases))</code></pre>
<pre><code>[1] 2162</code></pre>
</div>
</div>
<div id="filtering-some-traits" class="section level1">
<h1>Filtering some traits</h1>
<div id="abnormal-blistering-of-the-skin---blister"
class="section level2">
<h2>Abnormal blistering of the skin -&gt; blister</h2>
<pre class="r"><code>gwas_study_info =
  gwas_study_info |&gt;
  mutate(collected_all_disease_terms  = 
         ifelse(`DISEASE/TRAIT` == &quot;Blister (PheCode 911)&quot;,
         stringr::str_replace_all(collected_all_disease_terms,
                          vec_to_grep_pattern(&quot;abnormal blistering of the skin&quot;),
                          &quot;blister&quot;
         ),
         collected_all_disease_terms
         )
  )</code></pre>
</div>
<div id="abnormality-of-the-digestive-system" class="section level2">
<h2>Abnormality of the digestive system</h2>
<pre class="r"><code>gwas_study_info |&gt; 
  filter(grepl(vec_to_grep_pattern(&quot;abnormality of the digestive system&quot;), 
               collected_all_disease_terms, 
               perl = T)) |&gt;
  pull(`DISEASE/TRAIT`) |&gt;
  unique()</code></pre>
<pre><code>[1] &quot;Other abdominal problem&quot;</code></pre>
<pre class="r"><code>gwas_study_info =
  gwas_study_info |&gt;
  mutate(collected_all_disease_terms =
           str_remove_all(collected_all_disease_terms,
                          pattern = vec_to_grep_pattern(&quot;abnormality of the digestive system&quot;)))</code></pre>
</div>
<div id="abnormality-of-skin-pigmentation" class="section level2">
<h2>Abnormality of skin pigmentation</h2>
<pre class="r"><code>gwas_study_info |&gt; 
  filter(grepl(&quot;abnormality of skin pigmentation&quot;, collected_all_disease_terms)) |&gt;
  pull(`DISEASE/TRAIT`) |&gt;
  unique()</code></pre>
<pre><code> [1] &quot;Skin colour saturation&quot;                                                          
 [2] &quot;Perceived skin darkness&quot;                                                         
 [3] &quot;Skin pigmentation&quot;                                                               
 [4] &quot;Non-melanoma skin cancer&quot;                                                        
 [5] &quot;Skin luminance&quot;                                                                  
 [6] &quot;Skin red/green component&quot;                                                        
 [7] &quot;Skin yellow/blue component&quot;                                                      
 [8] &quot;25-hydroxyvitamin D levels x skin colour (very fair vs. fair) interaction&quot;       
 [9] &quot;25-hydroxyvitamin D levels x skin colour (very fair vs. light olive) interaction&quot;
[10] &quot;Skin colour - Brown (UKB data field 1717)&quot;                                       
[11] &quot;Skin colour - Dark olive (UKB data field 1717)&quot;                                  
[12] &quot;Skin colour - Fair (UKB data field 1717)&quot;                                        
[13] &quot;Skin colour - Light olive (UKB data field 1717)&quot;                                 
[14] &quot;Skin colour - Very fair (UKB data field 1717)&quot;                                   
[15] &quot;Skin colour - Dark olive (UKB data field 1717) (Gene-based burden)&quot;              
[16] &quot;Skin colour - Brown (UKB data field 1717) (Gene-based burden)&quot;                   
[17] &quot;Skin colour - Fair (UKB data field 1717) (Gene-based burden)&quot;                    
[18] &quot;Skin colour - Light olive (UKB data field 1717) (Gene-based burden)&quot;             
[19] &quot;Skin colour - Very fair (UKB data field 1717) (Gene-based burden)&quot;               
[20] &quot;Skin pigmentation traits&quot;                                                        
[21] &quot;Tatto pigmentation&quot;                                                              </code></pre>
<pre class="r"><code># as can see, most of these traits are not about true skin pigmentation abnormalities
# just about skin pigmentation in general

# if `DISEASE/TRAIT` contains &quot;UKB data field 1717&quot; (which is just a skin colour measurment field)
# then remove &quot;abnormality of skin pigmentation&quot; from collected_all_disease_terms
gwas_study_info = gwas_study_info |&gt;
  mutate(collected_all_disease_terms  = 
         ifelse(grepl(&quot;UKB data field 1717&quot;, 
                     `DISEASE/TRAIT`,
                     ignore.case = TRUE),
                stringr::str_remove_all(collected_all_disease_terms,
                          pattern = &quot;abnormality of skin pigmentation&quot;
         ),
         collected_all_disease_terms
         )
  )

# also remove if `DISEASE/TRAIT` contains &quot;Tattoo pigmentation&quot;
gwas_study_info = gwas_study_info |&gt;
  mutate(collected_all_disease_terms  = 
         ifelse(grepl(&quot;tattoo pigmentation|tatto pigmentation&quot;, 
                     `DISEASE/TRAIT`,
                     ignore.case = TRUE),
                stringr::str_remove_all(collected_all_disease_terms,
                          pattern = &quot;abnormality of skin pigmentation&quot;
         ),
         collected_all_disease_terms
         )
  )

# also remove if `DISEASE/TRAIT` is any of the following:
# - Perceived skin darkness 
# - Skin red/green component
# - Skin yellow/blue component
# - Skin pigmentation traits
# - Skin pigmentation 
# - Skin luminance

remove_terms &lt;- c(&quot;Perceived skin darkness&quot;,
                  &quot;Skin red/green component&quot;,
                  &quot;Skin yellow/blue component&quot;,
                  &quot;Skin pigmentation traits&quot;,
                  &quot;Skin pigmentation&quot;,
                  &quot;Skin luminance&quot;,
                  &quot;Skin colour saturation&quot;
                  )

gwas_study_info = gwas_study_info |&gt;
  mutate(collected_all_disease_terms  = 
         ifelse(`DISEASE/TRAIT` %in% remove_terms,
                stringr::str_remove_all(collected_all_disease_terms,
                          pattern = &quot;abnormality of skin pigmentation&quot;
         ),
         collected_all_disease_terms
         )
  )

# this leaves PUBMED_ID 23548203, which according to suplementary table 1
# is `Number of non-melanoma skin cancer (5+)` 
# so change to &quot;non-melanoma skin cancer&quot;

gwas_study_info = gwas_study_info |&gt;
  mutate(collected_all_disease_terms  = 
         ifelse(PUBMED_ID == &quot;23548203&quot;,
                stringr::str_replace_all(collected_all_disease_terms,
                          pattern = &quot;abnormality of skin pigmentation&quot;,
                          replacement = &quot;non-melanoma skin cancer&quot;
         ),
         collected_all_disease_terms
         )
  )</code></pre>
</div>
<div id="abnormal-thrombosis" class="section level2">
<h2>Abnormal thrombosis</h2>
<pre class="r"><code># interesting things going on with abnormal thrombosis
gwas_study_info |&gt; 
  filter(grepl(vec_to_grep_pattern(&quot;abnormal thrombosis&quot;), 
               collected_all_disease_terms, perl = T)) |&gt; 
  select(`DISEASE/TRAIT`, collected_all_disease_terms, PUBMED_ID)</code></pre>
<pre><code>                                                                                                                                   DISEASE/TRAIT
                                                                                                                                          &lt;char&gt;
1:                                                                                                                                    Thrombosis
2:     Blood clot, DVT, bronchitis, emphysema, asthma, rhinitis, eczema, allergy diagnosed by doctor: PHESANT recoding (UKB data field 6152_100)
3: Blood clot, DVT, bronchitis, emphysema, asthma, rhinitis, eczema, allergy diagnosed by doctor: Blood clot in the lung (UKB data field 6152_7)
4:                                                                              Blood clot in the lung (UKB data field 6152) (Gene-based burden)
5:                                                                                                  Blood clot in the lung (UKB data field 6152)
   collected_all_disease_terms PUBMED_ID
                        &lt;char&gt;     &lt;int&gt;
1:         abnormal thrombosis  26908601
2:         abnormal thrombosis  34737426
3:         abnormal thrombosis  34737426
4:         abnormal thrombosis  34662886
5:         abnormal thrombosis  34662886</code></pre>
<pre class="r"><code># if DISEASE/TRAIT contains Blood clot in the lung \\(UKB data field 6152\\) 
# replace abnormal thrombosis in collected_all_disease_terms with pulmonary embolism
gwas_study_info =
  gwas_study_info |&gt;
  mutate(collected_all_disease_terms  = 
         ifelse(grepl(&quot;Blood clot in the lung \\(UKB data field 6152\\)&quot;, 
                     `DISEASE/TRAIT`,
                     ignore.case = TRUE),
                stringr::str_replace_all(collected_all_disease_terms,
                          vec_to_grep_pattern(&quot;abnormal thrombosis&quot;),
                          &quot;pulmonary embolism&quot;
         ),
         collected_all_disease_terms
         )
  )


gwas_study_info =
  gwas_study_info |&gt;
  mutate(collected_all_disease_terms  = 
         ifelse(grepl(&quot;Blood clot in the lung \\(UKB data field 6152_7\\)&quot;, 
                     `DISEASE/TRAIT`,
                     ignore.case = TRUE),
                stringr::str_replace_all(collected_all_disease_terms,
                          vec_to_grep_pattern(&quot;abnormal thrombosis&quot;),
                          &quot;pulmonary embolism&quot;
         ),
         collected_all_disease_terms
         )
  )

## PHESANT recoding (UKB data field 6152_100)
gwas_study_info =
  gwas_study_info |&gt;
  mutate(collected_all_disease_terms  = 
         ifelse(grepl(&quot;PHESANT recoding \\(UKB data field 6152_100\\)&quot;, 
                     `DISEASE/TRAIT`,
                     ignore.case = TRUE),
                stringr::str_replace_all(collected_all_disease_terms,
                          vec_to_grep_pattern(&quot;abnormal thrombosis, allergic disease, respiratory system disease&quot;),
                          &quot;pulmonary embolism, deep vein thrombosis, chronic bronchitis, emphysema, asthma, rhinitis, eczema&quot;
         ),
         collected_all_disease_terms
         )
  )


# for pubmed id: 26908601
# remove abnormal thrombosis
# because this is included in the other provided terms 

gwas_study_info =
  gwas_study_info |&gt;
  mutate(collected_all_disease_terms  = 
         ifelse(PUBMED_ID == &quot;26908601&quot;,
                stringr::str_remove_all(collected_all_disease_terms,
                          vec_to_grep_pattern(&quot;abnormal thrombosis&quot;)
         ),
         collected_all_disease_terms
         )
  )</code></pre>
</div>
<div id="acute-coronary-syndrome" class="section level2">
<h2>Acute coronary syndrome</h2>
<pre class="r"><code># for pubmed id 28753643
# acute coronary syndrome (ACS) 
# comes from the SOLID-TIMI 52 cohort: experienced acute coronary syndrome (ACS; unstable angina, non–ST-elevation or ST-elevation MI)

gwas_study_info = gwas_study_info |&gt;
  mutate(collected_all_disease_terms  = 
         ifelse(PUBMED_ID == &quot;28753643&quot;,
                stringr::str_replace_all(collected_all_disease_terms,
                          pattern = &quot;acute coronary syndrome&quot;,
                          replacement = &quot;unstable angina, acute subendocardial myocardial infarction, acute transmural myocardial infarction of unspecified site&quot;
         ),
         collected_all_disease_terms
         )
  )

# define similarly in pubmed id: 24952865, 25583994, 25935875
gwas_study_info = gwas_study_info |&gt;
  mutate(collected_all_disease_terms  = 
         ifelse(PUBMED_ID %in% c(&quot;28753643&quot;,&quot;24952865&quot;, &quot;28753645&quot;, &quot;25583994&quot;, &quot;25935875&quot;, &quot;34158603&quot;),
                stringr::str_replace_all(collected_all_disease_terms,
                          pattern = &quot;acute coronary syndrome&quot;,
                          replacement = &quot;unstable angina, acute subendocardial myocardial infarction, acute transmural myocardial infarction of unspecified site&quot;
         ),
         collected_all_disease_terms
         )
  )

# for pubmed id 35356681, acute coronary syndrome (ACS) - is actually non-ST elevation acute coronary syndrome
gwas_study_info |&gt; 
  filter(grepl(vec_to_grep_pattern(&quot;acute coronary syndrome&quot;), 
               collected_all_disease_terms, 
               perl = T)) |&gt; 
  filter(PUBMED_ID == &quot;35356681&quot;) |&gt; 
  pull(`DISEASE/TRAIT`) |&gt;
  unique()</code></pre>
<pre><code>[1] &quot;Bisoprolol clearance in non-ST elevation acute coronary syndrome&quot;</code></pre>
<pre class="r"><code>gwas_study_info = gwas_study_info |&gt;
  mutate(collected_all_disease_terms  = 
         ifelse(PUBMED_ID == &quot;35356681&quot;,
                stringr::str_replace_all(collected_all_disease_terms,
                          pattern = &quot;acute coronary syndrome&quot;,
                          replacement = &quot;acute subendocardial myocardial infarction&quot;
         ),
         collected_all_disease_terms
         )
  )</code></pre>
</div>
<div id="attached-earlobe" class="section level2">
<h2>Attached earlobe</h2>
<pre class="r"><code>gwas_study_info |&gt; 
  filter(grepl(&quot;attached earlobe&quot;, collected_all_disease_terms)) |&gt;
  pull(`DISEASE/TRAIT`) |&gt;
  unique()</code></pre>
<pre><code>[1] &quot;Common traits (Other)&quot; &quot;Earlobe attachment&quot;   </code></pre>
<pre class="r"><code># remove attached earlobe
gwas_study_info = gwas_study_info |&gt;
  mutate(collected_all_disease_terms  = 
         stringr::str_remove_all(collected_all_disease_terms,
                          pattern = &quot;attached earlobe&quot;
         ))</code></pre>
</div>
<div id="chronic-disease" class="section level2">
<h2>Chronic disease</h2>
<pre class="r"><code>gwas_study_info |&gt; 
  filter(grepl(vec_to_grep_pattern(&quot;chronic disease&quot;), 
               collected_all_disease_terms, 
               perl = T)) |&gt;
  pull(`DISEASE/TRAIT`) |&gt;
  unique()</code></pre>
<pre><code>[1] &quot;Long standing illness disability or infirmity (UKB data field 2188)&quot;                    
[2] &quot;Long standing illness disability or infirmity (UKB data field 2188) (Gene-based burden)&quot;</code></pre>
<pre class="r"><code>gwas_study_info =
  gwas_study_info |&gt;
  mutate(collected_all_disease_terms =
           str_remove_all(collected_all_disease_terms,
                          pattern = vec_to_grep_pattern(&quot;chronic disease&quot;)))</code></pre>
</div>
<div id="facial-wrinkling" class="section level2">
<h2>Facial wrinkling</h2>
<pre class="r"><code>gwas_study_info |&gt; 
  filter(grepl(&quot;facial wrinkling&quot;, collected_all_disease_terms)) |&gt;
  pull(`DISEASE/TRAIT`) |&gt;
  unique()</code></pre>
<pre><code>[1] &quot;Facial wrinkles&quot;                                
[2] &quot;Facial wrinkles (forehead)&quot;                     
[3] &quot;Facial wrinkles (frown lines)&quot;                  
[4] &quot;Facial wrinkles (crow&#39;s feet)&quot;                  
[5] &quot;Facial wrinkles (principal components analysis)&quot;
[6] &quot;Facial wrinkles (under eye)&quot;                    </code></pre>
<pre class="r"><code># remove facial wrinkling
gwas_study_info = gwas_study_info |&gt;
  mutate(collected_all_disease_terms  = 
         stringr::str_remove_all(collected_all_disease_terms,
                          pattern = &quot;facial wrinkling&quot;
         ))</code></pre>
</div>
<div id="fibrosis" class="section level2">
<h2>Fibrosis</h2>
<pre class="r"><code>gwas_study_info |&gt; 
  filter(grepl(vec_to_grep_pattern(&quot;fibrosis&quot;), 
               collected_all_disease_terms, 
               perl = T)) |&gt;
  pull(`DISEASE/TRAIT`) |&gt;
  unique()</code></pre>
<pre><code>[1] &quot;Fibrosis&quot;                                                                                                                                                           
[2] &quot;Fibrosis (moderate to severe) in head and neck cancer treated with radiotherapy&quot;                                                                                    
[3] &quot;Fibrosis (severe) in head and neck cancer treated with radiotherapy&quot;                                                                                                
[4] &quot;Fibrosis or atrophy (moderate to severe) in head and neck cancer treated with radiotherapy&quot;                                                                         
[5] &quot;Fibrosis or atrophy (severe) in head and neck cancer treated with radiotherapy&quot;                                                                                     
[6] &quot;Standardised Total Average Toxicity (late dysphagia, xerostomia, fibrosis or atrophy) in head and neck cancer treated with radiotherapy&quot;                            
[7] &quot;Standardised Total Average Toxicity (acute dysphagia, mucositis, late dysphagia, xerostomia, fibrosis or atrophy) in head and neck cancer treated with radiotherapy&quot;</code></pre>
<pre class="r"><code>gwas_study_info =
  gwas_study_info |&gt;
  mutate(collected_all_disease_terms =
           str_replace_all(collected_all_disease_terms,
                           pattern = vec_to_grep_pattern(&quot;fibrosis, head and neck cancer&quot;),
                          replacement = &quot;head and neck cancer&quot;
           )
  )

gwas_study_info =
  gwas_study_info |&gt;
  mutate(collected_all_disease_terms =
           ifelse(PUBMED_ID == &quot;38601445&quot;,
           str_replace_all(collected_all_disease_terms,
                           pattern = vec_to_grep_pattern(&quot;fibrosis&quot;),
                          replacement = &quot;lung cancer&quot;
           ),
           collected_all_disease_terms
           )
  )</code></pre>
</div>
<div id="formal-thought-disorder" class="section level2">
<h2>Formal thought disorder</h2>
<pre class="r"><code>gwas_study_info |&gt; 
  filter(grepl(vec_to_grep_pattern(&quot;formal thought disorder&quot;), 
               collected_all_disease_terms, 
               perl = T)) |&gt;
  pull(`DISEASE/TRAIT`) |&gt;
  unique()</code></pre>
<pre><code>[1] &quot;Formal thought disorder in schizophrenia&quot;                                                                           
[2] &quot;Positive formal thought disorder in major depressive disorder, bipolar disorder or schizophrenia spectrum disorders&quot;</code></pre>
<pre class="r"><code># as formal thought disorder is within other psychiatric traits
# remove
gwas_study_info =
  gwas_study_info |&gt;
  mutate(collected_all_disease_terms =
           str_remove_all(collected_all_disease_terms,
                          pattern = vec_to_grep_pattern(&quot;formal thought disorder&quot;)))</code></pre>
</div>
<div id="gender-identity-disorder" class="section level2">
<h2>Gender identity disorder</h2>
<pre class="r"><code>gwas_study_info = 
  gwas_study_info |&gt;
  mutate(collected_all_disease_terms  = 
         stringr::str_replace_all(collected_all_disease_terms,
                          vec_to_grep_pattern(&quot;childhood gender nonconformity&quot;),
                          &quot;gender identity disorder&quot;
         ))

gwas_study_info =
    gwas_study_info |&gt;
    mutate(collected_all_disease_terms  = 
         stringr::str_remove_all(collected_all_disease_terms,
                          pattern = &quot;gender identity disorder&quot;
         ))

gwas_study_info =
  gwas_study_info |&gt;
    mutate(collected_all_disease_terms  = 
         stringr::str_remove_all(collected_all_disease_terms,
                          pattern = &quot;sexual and gender identity disorders&quot;
         ))</code></pre>
</div>
<div id="handedness" class="section level2">
<h2>Handedness</h2>
<pre class="r"><code>gwas_study_info |&gt; 
  filter(grepl(&quot;handedness&quot;, collected_all_disease_terms)) |&gt;
  pull(`DISEASE/TRAIT`) |&gt;
  unique()</code></pre>
<pre><code> [1] &quot;Handedness (non-right-handed vs right-handed)&quot;                          
 [2] &quot;Handedness (Left-handed vs. non-left-handed)&quot;                           
 [3] &quot;Handedness (left-handed vs. right-handed)&quot;                              
 [4] &quot;Relative hand skill in reading disability&quot;                              
 [5] &quot;Relative hand skill&quot;                                                    
 [6] &quot;Handedness in dyslexia&quot;                                                 
 [7] &quot;Handedness&quot;                                                             
 [8] &quot;Handedness (chirality/laterality): Right-handed (UKB data field 1707_1)&quot;
 [9] &quot;Handedness (Right-handed vs. non-right-handed)&quot;                         
[10] &quot;Ambidextrousness&quot;                                                       
[11] &quot;Ambidextrousness (ambidextrous vs right-handed)&quot;                        
[12] &quot;Left-handedness&quot;                                                        
[13] &quot;Handedness (confirmatory factor analysis Factor 36)&quot;                    </code></pre>
<pre class="r"><code># remove handedness
gwas_study_info = gwas_study_info |&gt;
  mutate(collected_all_disease_terms  = 
         stringr::str_remove_all(collected_all_disease_terms,
                          pattern = &quot;handedness&quot;
         ))

# also remove functional laterality if Handedness chirality laterality is in DISEASE/TRAIT
gwas_study_info = gwas_study_info |&gt;
  mutate(collected_all_disease_terms  = 
         ifelse(grepl(&quot;Handedness&quot;, 
                     `DISEASE/TRAIT`,
                     ignore.case = TRUE),
                stringr::str_remove_all(collected_all_disease_terms,
                          pattern = &quot;functional laterality&quot;
         ),
         collected_all_disease_terms
         )
  )

# also remove functional laterality if Usual side of head for mobile phone use is in DISEASE/TRAIT
gwas_study_info = gwas_study_info |&gt;
  mutate(collected_all_disease_terms  = 
         ifelse(grepl(&quot;Usual side of head for mobile phone use&quot;, 
                     `DISEASE/TRAIT`,
                     ignore.case = TRUE),
                stringr::str_remove_all(collected_all_disease_terms,
                          pattern = &quot;functional laterality&quot;
         ),
         collected_all_disease_terms
         )
  )

# also remove functional laterality if PUBMED_ID=20585627
gwas_study_info = gwas_study_info |&gt;
  mutate(collected_all_disease_terms  = 
         ifelse(PUBMED_ID == &quot;20585627&quot;,
                stringr::str_remove_all(collected_all_disease_terms,
                          pattern = &quot;functional laterality&quot;
         ),
         collected_all_disease_terms
         )
  ) </code></pre>
</div>
<div id="hyperplasia" class="section level2">
<h2>Hyperplasia</h2>
<pre class="r"><code>gwas_study_info |&gt; 
  filter(grepl(vec_to_grep_pattern(&quot;hyperplasia&quot;), 
               collected_all_disease_terms, 
               perl = T)) |&gt;
  pull(`DISEASE/TRAIT`) |&gt;
  unique()</code></pre>
<pre><code>[1] &quot;Bilateral adrenal hyperplasia&quot;</code></pre>
<pre class="r"><code>gwas_study_info =
  gwas_study_info |&gt;
  mutate(collected_all_disease_terms =
           ifelse(grepl(&quot;Bilateral adrenal hyperplasia&quot;,
                        `DISEASE/TRAIT`,
                       ignore.case = TRUE),
                  str_replace_all(collected_all_disease_terms,
                                  pattern = vec_to_grep_pattern(&quot;hyperplasia&quot;),
                                  replacement = &quot;bilateral adrenal hyperplasia&quot;
                  ),
                  collected_all_disease_terms
           )
)</code></pre>
</div>
<div id="hypersensitivity-reaction-disease" class="section level2">
<h2>Hypersensitivity reaction disease</h2>
<pre class="r"><code>gwas_study_info |&gt; 
  filter(grepl(vec_to_grep_pattern(&quot;hypersensitivity reaction disease&quot;), 
               collected_all_disease_terms, 
               perl = T)) |&gt;
  pull(`DISEASE/TRAIT`) |&gt;
  unique()</code></pre>
<pre><code>[1] &quot;Nevirapine-induced hypersensitivity in HIV&quot;</code></pre>
<pre class="r"><code>gwas_study_info =
  gwas_study_info |&gt;
  mutate(collected_all_disease_terms =
           str_remove_all(collected_all_disease_terms,
                          pattern = vec_to_grep_pattern(&quot;hypersensitivity reaction disease&quot;)))</code></pre>
</div>
<div id="inflammatory-skin-disease" class="section level2">
<h2>Inflammatory skin disease</h2>
<pre class="r"><code>gwas_study_info |&gt; 
  filter(grepl(vec_to_grep_pattern(&quot;inflammatory skin disease&quot;), 
               collected_all_disease_terms, 
               perl = T)) |&gt;
  pull(`DISEASE/TRAIT`) |&gt;
  unique()</code></pre>
<pre><code>[1] &quot;Inflammatory skin disease&quot;</code></pre>
<pre class="r"><code>gwas_study_info =
  gwas_study_info |&gt;
  mutate(collected_all_disease_terms =
           str_replace_all(collected_all_disease_terms,
                           pattern = vec_to_grep_pattern(&quot;inflammatory skin disease&quot;),
                          replacement = &quot;atopic dermatitis, psoriasis&quot;
           )
  )</code></pre>
</div>
<div
id="sneezing-in-response-to-bright-light-autosomal-dominant-compelling-helio-ophthalmic-outburst-syndrome"
class="section level2">
<h2>Sneezing in response to bright light (autosomal dominant compelling
helio-ophthalmic outburst syndrome)</h2>
<pre class="r"><code>gwas_study_info |&gt; 
  filter(grepl(&quot;autosomal dominant compelling helio-ophthalmic outburst syndrome&quot;, collected_all_disease_terms)) |&gt;
  pull(`DISEASE/TRAIT`) |&gt;
  unique()</code></pre>
<pre><code>[1] &quot;Photic sneeze reflex&quot;</code></pre>
<pre class="r"><code># remove autosomal dominant compelling helio-ophthalmic outburst syndrome
gwas_study_info = gwas_study_info |&gt;
  mutate(collected_all_disease_terms  = 
         stringr::str_remove_all(collected_all_disease_terms,
                          pattern = &quot;autosomal dominant compelling helio-ophthalmic outburst syndrome&quot;
         ))</code></pre>
</div>
<div id="skin-sensitivity-to-sun" class="section level2">
<h2>Skin sensitivity to sun</h2>
<pre class="r"><code>gwas_study_info |&gt; 
  filter(grepl(&quot;skin sensitivity to sun&quot;, collected_all_disease_terms)) |&gt;
  pull(`DISEASE/TRAIT`) |&gt;
  unique()</code></pre>
<pre><code> [1] &quot;Skin sensitivity to sun&quot;                                                                           
 [2] &quot;Ease of sunburn&quot;                                                                                   
 [3] &quot;Ease of skin tanning&quot;                                                                              
 [4] &quot;Ease of skin tanning - Get mildly or occasionally tanned (UKB data field 1727)&quot;                    
 [5] &quot;Ease of skin tanning - Get moderately tanned (UKB data field 1727)&quot;                                
 [6] &quot;Ease of skin tanning - Get very tanned (UKB data field 1727)&quot;                                      
 [7] &quot;Ease of skin tanning - Never tan only burn (UKB data field 1727)&quot;                                  
 [8] &quot;Ease of skin tanning - Get mildly or occasionally tanned (UKB data field 1727) (Gene-based burden)&quot;
 [9] &quot;Ease of skin tanning - Get moderately tanned (UKB data field 1727) (Gene-based burden)&quot;            
[10] &quot;Ease of skin tanning - Never tan only burn (UKB data field 1727) (Gene-based burden)&quot;              
[11] &quot;Ease of skin tanning - Get very tanned (UKB data field 1727) (Gene-based burden)&quot;                  </code></pre>
<pre class="r"><code># remove skin sensitivity to sun
gwas_study_info = gwas_study_info |&gt;
  mutate(collected_all_disease_terms  = 
         stringr::str_remove_all(collected_all_disease_terms,
                          pattern = vec_to_grep_pattern(&quot;skin sensitivity to sun&quot;)
         ))

# also remove suntan
gwas_study_info |&gt; 
  filter(grepl(&quot;suntan&quot;, collected_all_disease_terms)) |&gt;
  pull(`DISEASE/TRAIT`) |&gt;
  unique()</code></pre>
<pre><code>[1] &quot;Tanning&quot;          &quot;Low tan response&quot;</code></pre>
<pre class="r"><code>gwas_study_info = gwas_study_info |&gt;
  mutate(collected_all_disease_terms  = 
         stringr::str_remove_all(collected_all_disease_terms,
                          pattern = vec_to_grep_pattern(&quot;suntan&quot;
                          )
         ))</code></pre>
</div>
</div>
<div id="group-some-non-cancer-diseases-together"
class="section level1">
<h1>Group some non-cancer diseases together</h1>
<div id="abnormal-brain-morphology" class="section level2">
<h2>Abnormal brain morphology</h2>
<pre class="r"><code># if DISEASE/TRAIT contains Unidentified bright object on brain MRI, 
# then replace abnormal brain morphology with Other abnormal findings on diagnostic imaging of central nervous system 
gwas_study_info = gwas_study_info |&gt;
  mutate(collected_all_disease_terms  = 
         ifelse(grepl(&quot;Unidentified bright object on brain MRI&quot;, 
                     `DISEASE/TRAIT`,
                     ignore.case = TRUE),
                stringr::str_replace_all(collected_all_disease_terms,
                          vec_to_grep_pattern(&quot;abnormal brain morphology&quot;),
                          &quot;other abnormal findings on diagnostic imaging of central nervous system&quot;
         ),
         collected_all_disease_terms
         )
  )</code></pre>
</div>
<div
id="abnormal-circulating-lipid-concentration---disorders-of-lipid-metabolism"
class="section level2">
<h2>Abnormal circulating lipid concentration -&gt; disorders of lipid
metabolism</h2>
<pre class="r"><code>gwas_study_info =
  gwas_study_info |&gt;
  mutate(collected_all_disease_terms  = 
         ifelse(grepl(&quot;Disorders of lipid metabolism&quot;, 
                     `DISEASE/TRAIT`,
                     ignore.case = TRUE),
                stringr::str_replace_all(collected_all_disease_terms,
                          vec_to_grep_pattern(&quot;abnormal circulating lipid concentration&quot;),
                          &quot;disorders of lipid metabolism&quot;
         ),
         collected_all_disease_terms
         )
  )</code></pre>
</div>
<div id="abnormal-ecg" class="section level2">
<h2>Abnormal ecg</h2>
<pre class="r"><code># if abnormal ecg in disease/trait, then change abnormal ekg to abnormal ecg
gwas_study_info = gwas_study_info |&gt;
  mutate(collected_all_disease_terms  = 
         ifelse(grepl(&quot;abnormal ecg&quot;, 
                     `DISEASE/TRAIT`,
                     ignore.case = TRUE),
                stringr::str_replace_all(collected_all_disease_terms,
                          vec_to_grep_pattern(&quot;abnormal ekg&quot;),
                          &quot;abnormal ecg&quot;
         ),
         collected_all_disease_terms
         )
  )</code></pre>
</div>
<div id="abnormality-of-gait" class="section level2">
<h2>Abnormality of gait</h2>
<pre class="r"><code>gwas_study_info = 
  gwas_study_info |&gt;
  mutate(collected_all_disease_terms  = 
         stringr::str_replace_all(collected_all_disease_terms,
                          vec_to_grep_pattern(c(
                            &quot;gait imbalance&quot;,
                            &quot;decreased walking ability&quot;,
                            &quot;postural instability&quot;)
                            ),
                          &quot;abnormality of gait&quot;
         ))</code></pre>
</div>
<div
id="abnormality-of-the-nervous-system-abnormality-of-the-musculature-abnormality-of-the-skeletal-system"
class="section level2">
<h2>Abnormality of the nervous system, abnormality of the musculature,
abnormality of the skeletal system</h2>
<pre class="r"><code>gwas_study_info = 
  gwas_study_info |&gt;
  mutate(collected_all_disease_terms  = 
         stringr::str_replace_all(collected_all_disease_terms,
                          vec_to_grep_pattern(c(
                            &quot;abnormality of the musculature, abnormality of the nervous system, abnormality of the skeletal system&quot;)
                            ),
                          &quot;other symptoms and signs involving the nervous and musculoskeletal systems&quot;
         ))</code></pre>
</div>
<div id="other-demyelinating-diseases-of-central-nervous-system"
class="section level2">
<h2>Other demyelinating diseases of central nervous system</h2>
<pre class="r"><code># if DISEASE/TRAIT contains PheCode 341
# replace abnormality of the nervous system, with other demyelinating diseases of central nervous system

gwas_study_info = 
  gwas_study_info |&gt;
  mutate(collected_all_disease_terms  = 
         ifelse(grepl(&quot;PheCode 341&quot;, 
                     `DISEASE/TRAIT`,
                     ignore.case = TRUE),
                stringr::str_replace_all(collected_all_disease_terms,
                          vec_to_grep_pattern(&quot;abnormality of the nervous system&quot;),
                          &quot;other demyelinating diseases of central nervous system&quot;
         ),
         collected_all_disease_terms
         )
  )


gwas_study_info = 
  gwas_study_info |&gt;
  mutate(collected_all_disease_terms  = 
         ifelse(grepl(&quot;PheCode 345&quot;, 
                     `DISEASE/TRAIT`,
                     ignore.case = TRUE),
                stringr::str_replace_all(collected_all_disease_terms,
                          vec_to_grep_pattern(&quot;abnormality of the nervous system&quot;),
                          &quot;epilepsy&quot;
         ),
         collected_all_disease_terms
         )
  )


gwas_study_info = 
  gwas_study_info |&gt;
  mutate(collected_all_disease_terms  = 
         ifelse(grepl(&quot;Neurological involvement in Behcet&#39;s disease&quot;, 
                     `DISEASE/TRAIT`,
                     ignore.case = TRUE),
                stringr::str_remove_all(collected_all_disease_terms,
                          vec_to_grep_pattern(&quot;abnormality of the nervous system&quot;)
         ),
         collected_all_disease_terms
         )
  )</code></pre>
</div>
<div id="abdominal-abscess" class="section level2">
<h2>Abdominal abscess</h2>
<pre class="r"><code>gwas_study_info |&gt;
  filter(grepl(vec_to_grep_pattern(&quot;abdominal abscess&quot;), 
               collected_all_disease_terms, perl = T)) </code></pre>
<pre><code>         DISEASE/TRAIT PUBMED_ID  YEAR
                &lt;char&gt;     &lt;int&gt; &lt;int&gt;
1: Abdominal infection  35173190  2022
                                                                                                                                                          STUDY
                                                                                                                                                         &lt;char&gt;
1: A genome-wide association study in a large community-based cohort identifies multiple loci associated with susceptibility to bacterial and viral infections.
   STUDY_ACCESSION      MAPPED_TRAIT                     MAPPED_TRAIT_URI
            &lt;char&gt;            &lt;char&gt;                               &lt;char&gt;
1:    GCST90103953 abdominal abscess http://www.ebi.ac.uk/efo/EFO_1001753
   MAPPED_BACKGROUND_TRAIT MAPPED_BACKGROUND_TRAIT_URI     disease_terms
                    &lt;char&gt;                      &lt;char&gt;            &lt;char&gt;
1:                                                     abdominal abscess
   MAPPED_TRAIT_CATEGORY background_disease_terms BACKGROUND_TRAIT_CATEGORY
                  &lt;char&gt;                   &lt;char&gt;                    &lt;char&gt;
1:      Disease/Disorder                                              Other
   DISEASE_STUDY all_disease_terms collected_all_disease_terms
          &lt;lgcl&gt;            &lt;char&gt;                      &lt;char&gt;
1:          TRUE abdominal abscess           abdominal abscess</code></pre>
<pre class="r"><code># just one study - 35173190, has abdominal abscess
# they define unusually as: D73.3, K35-37, K57, K61, K63.0, K65, K75.0, K81, K83.0
# &#39;Abdominal infections&#39;

gwas_study_info = 
  gwas_study_info |&gt;
  mutate(collected_all_disease_terms  = 
         ifelse(PUBMED_ID == &quot;35173190&quot;,
                stringr::str_replace_all(collected_all_disease_terms,
                          vec_to_grep_pattern(&quot;abdominal abscess&quot;),
                          &quot;abdominal infections code&quot;
         ),
         collected_all_disease_terms
         )
  )</code></pre>
</div>
<div id="abnormal-mammogram" class="section level2">
<h2>Abnormal mammogram</h2>
<pre class="r"><code># if DISEASE/TRAIT contains Abnormal mammogram, then change Abnormality of the breast to abnormal mammogram

gwas_study_info = 
  gwas_study_info |&gt;
  mutate(collected_all_disease_terms  = 
         ifelse(grepl(&quot;Abnormal findings on mammogram or breast exam&quot;, 
                     `DISEASE/TRAIT`,
                     ignore.case = TRUE),
                stringr::str_replace_all(collected_all_disease_terms,
                          vec_to_grep_pattern(&quot;abnormality of the breast&quot;),
                          &quot;abnormal mammogram&quot;
         ),
         collected_all_disease_terms
         )
  )</code></pre>
</div>
<div id="achalasia-of-cardia" class="section level2">
<h2>Achalasia of cardia</h2>
<pre class="r"><code>gwas_study_info = 
  gwas_study_info |&gt;
  mutate(collected_all_disease_terms  = 
         stringr::str_replace_all(collected_all_disease_terms,
                          vec_to_grep_pattern(&quot;achalasia&quot;),
                          &quot;achalasia of cardia&quot;
         ))</code></pre>
</div>
<div id="acute-pancreatitis" class="section level2">
<h2>Acute pancreatitis</h2>
<pre class="r"><code>gwas_study_info = gwas_study_info |&gt;
  mutate(collected_all_disease_terms  = 
         stringr::str_replace_all(collected_all_disease_terms,
                          vec_to_grep_pattern(&quot;asparaginase-induced acute pancreatitis&quot;),
                          &quot;acute pancreatitis&quot;
         ))</code></pre>
</div>
<div id="amebiasis" class="section level2">
<h2>Amebiasis</h2>
<pre class="r"><code># If `DISEASE/TRAIT` contains Diarrhoea-associated Entamoeba histolytica infection
# then replace amebiasis with amoeboma of intestine 

gwas_study_info =
  gwas_study_info |&gt;
  mutate(collected_all_disease_terms  = 
         ifelse(grepl(&quot;Diarrhoea-associated Entamoeba histolytica infection&quot;, 
                     `DISEASE/TRAIT`,
                     ignore.case = TRUE),
                stringr::str_replace_all(collected_all_disease_terms,
                          vec_to_grep_pattern(&quot;amebiasis&quot;),
                          &quot;amoeboma of intestine&quot;
         ),
         collected_all_disease_terms
         )
  )</code></pre>
</div>
<div id="altitude-sickness" class="section level2">
<h2>Altitude sickness</h2>
<pre class="r"><code>gwas_study_info = gwas_study_info |&gt;
  mutate(collected_all_disease_terms  = 
         stringr::str_replace_all(collected_all_disease_terms,
                          vec_to_grep_pattern(&quot;chronic mountain sickness&quot;),
                          &quot;altitude sickness&quot;
         ))</code></pre>
</div>
<div id="alopecia" class="section level2">
<h2>Alopecia</h2>
<pre class="r"><code>alopecia_terms &lt;- c(&quot;frontal fibrosing alopecia&quot; 
                   )


gwas_study_info = gwas_study_info |&gt;
  mutate(collected_all_disease_terms  = 
         stringr::str_replace_all(collected_all_disease_terms,
                          pattern = vec_to_grep_pattern(alopecia_terms),
                          &quot;alopecia&quot;
         )
  )
         
         
drug_induced_alopecia_terms &lt;- c(
                               &quot;chemotherapy-induced alopecia&quot;
                               )


gwas_study_info = gwas_study_info |&gt;
  mutate(collected_all_disease_terms  = 
         stringr::str_replace_all(collected_all_disease_terms,
                          pattern = vec_to_grep_pattern(drug_induced_alopecia_terms),
                          &quot;drug-induced androgenic alopecia&quot;
         )
  )</code></pre>
</div>
<div id="alcohol-and-nicotine-codependence" class="section level2">
<h2>Alcohol and nicotine codependence</h2>
<pre class="r"><code># alcohol and nicotine codependence -&gt; alcohol dependence, nicotine dependence

gwas_study_info = gwas_study_info |&gt;
  mutate(collected_all_disease_terms  = 
         stringr::str_replace_all(collected_all_disease_terms,
                          vec_to_grep_pattern(&quot;alcohol and nicotine codependence&quot;),
                          &quot;alcohol dependence, nicotine dependence&quot;
         )) 

gwas_study_info = gwas_study_info |&gt;
  mutate(collected_all_disease_terms  = 
         stringr::str_replace_all(collected_all_disease_terms,
                          vec_to_grep_pattern(&quot;alcohol dependence&quot;),
                          &quot;alcohol-related disorders&quot;
         ))

gwas_study_info = gwas_study_info |&gt;
  mutate(collected_all_disease_terms  = 
         stringr::str_replace_all(collected_all_disease_terms,
                          vec_to_grep_pattern(&quot;nicotine dependence&quot;),
                          &quot;tobacco use disorder&quot;
         ))</code></pre>
</div>
<div id="amyloidosis" class="section level2">
<h2>Amyloidosis</h2>
<pre class="r"><code>gwas_study_info = gwas_study_info |&gt;
  mutate(collected_all_disease_terms  = 
         stringr::str_replace_all(collected_all_disease_terms,
                          vec_to_grep_pattern(&quot;al amyloidosis&quot;),
                          &quot;amyloidosis&quot;
         ))</code></pre>
</div>
<div id="anxiety-disorder" class="section level2">
<h2>Anxiety disorder</h2>
<pre class="r"><code>gwas_study_info = gwas_study_info |&gt;
  mutate(collected_all_disease_terms  = 
         stringr::str_replace_all(collected_all_disease_terms,
                          vec_to_grep_pattern(&quot;anxiety&quot;),
                          &quot;anxiety disorder&quot;
         )) </code></pre>
</div>
<div id="aplastic-anemia" class="section level2">
<h2>Aplastic anemia</h2>
<pre class="r"><code>gwas_study_info = gwas_study_info |&gt;
  mutate(collected_all_disease_terms  = 
         stringr::str_replace_all(collected_all_disease_terms,
                          pattern = vec_to_grep_pattern(&quot;severe aplastic anemia&quot;),
                          &quot;aplastic anemia&quot;
         ))</code></pre>
</div>
<div id="androgenic-alopecia" class="section level2">
<h2>Androgenic alopecia</h2>
<pre class="r"><code>gwas_study_info = 
  gwas_study_info |&gt;
  mutate(collected_all_disease_terms  = 
         stringr::str_replace_all(collected_all_disease_terms,
                          pattern = vec_to_grep_pattern(&quot;androgenetic alopecia&quot;),
                          &quot;androgenic alopecia&quot;
         ))  </code></pre>
</div>
<div id="angioedema---angioneurotic-oedema" class="section level2">
<h2>Angioedema -&gt; Angioneurotic oedema</h2>
<pre class="r"><code>gwas_study_info = gwas_study_info |&gt;
  mutate(collected_all_disease_terms  = 
         stringr::str_replace_all(collected_all_disease_terms,
                          vec_to_grep_pattern(&quot;angioedema&quot;),
                          &quot;angioneurotic oedema&quot;
         ))</code></pre>
</div>
<div id="astigmatism" class="section level2">
<h2>Astigmatism</h2>
<pre class="r"><code>gwas_study_info = gwas_study_info |&gt;
  mutate(collected_all_disease_terms  = 
         stringr::str_replace_all(collected_all_disease_terms,
                          vec_to_grep_pattern(&quot;corneal astigmatism&quot;),
                          &quot;astigmatism&quot;
         ))</code></pre>
</div>
<div id="asthma" class="section level2">
<h2>Asthma</h2>
<pre class="r"><code>gwas_study_info = gwas_study_info |&gt;
      mutate(collected_all_disease_terms  = 
           stringr::str_replace_all(collected_all_disease_terms,
                            vec_to_grep_pattern(c(&quot;atopic asthma&quot;, &quot;chronic obstructive asthma&quot;)),
                            &quot;asthma&quot;
           )) |&gt;
    mutate(collected_all_disease_terms  = 
           stringr::str_replace_all(collected_all_disease_terms,
                            vec_to_grep_pattern(c(&quot;childhood onset asthma&quot;,
                                                    &quot;adult onset asthma&quot;,
                                                    &quot;aspirin-induced asthma&quot;
                                                  )
                            ),
                            &quot;asthma&quot;
           ))</code></pre>
</div>
<div id="atrial-fibrillation-and-flutter" class="section level2">
<h2>Atrial fibrillation and flutter</h2>
<pre class="r"><code>gwas_study_info = gwas_study_info |&gt;
  mutate(collected_all_disease_terms  = 
         stringr::str_replace_all(collected_all_disease_terms,
                          vec_to_grep_pattern(&quot;atrial flutter&quot;),
                          &quot;atrial fibrillation and flutter&quot;
         ))</code></pre>
</div>
<div id="atopic-dermatitis" class="section level2">
<h2>Atopic dermatitis</h2>
<pre class="r"><code>gwas_study_info = gwas_study_info |&gt;
  mutate(collected_all_disease_terms  = 
         stringr::str_replace_all(collected_all_disease_terms,
                          vec_to_grep_pattern(&quot;recalcitrant atopic dermatitis&quot;),
                          &quot;atopic dermatitis&quot;
         ))</code></pre>
</div>
<div id="background-retinopathy-and-retinal-vascular-changes"
class="section level2">
<h2>Background retinopathy and retinal vascular changes</h2>
<pre class="r"><code>gwas_study_info = gwas_study_info |&gt;
  mutate(collected_all_disease_terms  = 
         stringr::str_replace_all(collected_all_disease_terms,
                          vec_to_grep_pattern(c(&quot;macular telangiectasia type 2&quot;
                                                )
                                              ),
                          &quot;background retinopathy and retinal vascular changes&quot;
         ))</code></pre>
</div>
<div id="bacterial-infection" class="section level2">
<h2>Bacterial infection</h2>
<pre class="r"><code>gwas_study_info = gwas_study_info |&gt;
  mutate(collected_all_disease_terms  = 
         stringr::str_replace_all(collected_all_disease_terms,
                          vec_to_grep_pattern(c(
                             &quot;bacterial infection&quot;
                             )
                             ),
                          &quot;bacterial infection nos&quot;
         ))</code></pre>
</div>
<div id="benign-mammary-dysplasia" class="section level2">
<h2>Benign mammary dysplasia</h2>
<pre class="r"><code># if `DISEASE/TRAIT contains Benign mammary dysplasia`, then change abnormality of the breast to benign mammary dysplasia
gwas_study_info = 
  gwas_study_info |&gt;
  mutate(collected_all_disease_terms  = 
         ifelse(grepl(&quot;Benign mammary dysplasia&quot;, 
                     `DISEASE/TRAIT`,
                     ignore.case = TRUE),
                stringr::str_replace_all(collected_all_disease_terms,
                          vec_to_grep_pattern(&quot;abnormality of the breast&quot;),
                          &quot;benign mammary dysplasia&quot;
         ),
         collected_all_disease_terms
         )
  )</code></pre>
</div>
<div id="bipolar-disorder" class="section level2">
<h2>Bipolar disorder</h2>
<pre class="r"><code>gwas_study_info = gwas_study_info |&gt; 
    mutate(collected_all_disease_terms  = 
         stringr::str_replace_all(collected_all_disease_terms,
                          vec_to_grep_pattern(
                            c(&quot;bipolar ii disorder&quot;,
                              &quot;bipolar i disorder&quot;
                              )
                            ),
                          &quot;bipolar disorder&quot;
         ))</code></pre>
</div>
<div id="bronchopneumonia-and-lung-abscess" class="section level2">
<h2>Bronchopneumonia and lung abscess</h2>
<pre class="r"><code>gwas_study_info = gwas_study_info |&gt;
  mutate(collected_all_disease_terms  = 
         stringr::str_replace_all(collected_all_disease_terms,
                          vec_to_grep_pattern(c(
                             &quot;bronchopneumonia, lung abscess&quot;
                             )
                             ),
                          &quot;bronchopneumonia and lung abscess&quot;
         ))</code></pre>
</div>
<div id="blindness-and-low-vision" class="section level2">
<h2>Blindness and low vision</h2>
<pre class="r"><code>gwas_study_info = gwas_study_info |&gt;
  mutate(collected_all_disease_terms  = 
         stringr::str_replace_all(collected_all_disease_terms,
                          vec_to_grep_pattern(c(
                             &quot;blindness&quot;,
                             &quot;progressive visual loss&quot;,
                             &quot;visual loss&quot;
                             )
                             ),
                          &quot;blindness and low vision&quot;
         ))

# Disorders of optic nerve and visual pathways
gwas_study_info = gwas_study_info |&gt;
  mutate(collected_all_disease_terms  = 
         stringr::str_replace_all(collected_all_disease_terms,
                          vec_to_grep_pattern(c(
                             &quot;visual pathway disorder&quot;,
                             &quot;optic nerve disorder&quot;
                             )
                             ),
                          &quot;disorders of optic nerve and visual pathways&quot;
         ))

# visuospatial impairment
gwas_study_info = gwas_study_info |&gt;
  mutate(collected_all_disease_terms  = 
         stringr::str_replace_all(collected_all_disease_terms,
                          vec_to_grep_pattern(c(
                             &quot;visuospatial impairment&quot;
                             )
                             ),
                          &quot;other and unspecified symptoms and signs involving cognitive functions and awareness&quot;
         ))</code></pre>
</div>
<div id="cafe-au-lait-spot" class="section level2">
<h2>Cafe-au-lait spot</h2>
<pre class="r"><code>gwas_study_info = gwas_study_info |&gt;
  mutate(collected_all_disease_terms  = 
         stringr::str_replace_all(collected_all_disease_terms,
                          vec_to_grep_pattern(&quot;cafe-au-lait spot&quot;),
                          &quot;café au lait spots&quot;
         ))</code></pre>
</div>
<div id="cancer-of-eye" class="section level2">
<h2>Cancer of eye</h2>
<pre class="r"><code>gwas_study_info = gwas_study_info |&gt;
  mutate(collected_all_disease_terms  = 
         stringr::str_replace_all(collected_all_disease_terms,
                          vec_to_grep_pattern(c(
                             &quot;ocular melanoma&quot;)
                             ),
                          &quot;cancer of eye&quot;
         ))</code></pre>
</div>
<div id="candidiasis-of-vulva-and-vagina" class="section level2">
<h2>Candidiasis of vulva and vagina</h2>
<pre class="r"><code>gwas_study_info = gwas_study_info |&gt;
  mutate(collected_all_disease_terms  = 
         stringr::str_replace_all(collected_all_disease_terms,
                          vec_to_grep_pattern(c(
                             &quot;vaginal yeast infection&quot;)
                             ),
                          &quot;candidiasis of vulva and vagina&quot;
         ))</code></pre>
</div>
<div id="carbuncle-and-furuncle" class="section level2">
<h2>Carbuncle and furuncle</h2>
<pre class="r"><code>gwas_study_info = gwas_study_info |&gt;
  mutate(collected_all_disease_terms  = 
         stringr::str_replace_all(collected_all_disease_terms,
                          vec_to_grep_pattern(c(
                             &quot;carbuncle&quot;, &quot;furuncle&quot;)
                             ),
                          &quot;carbuncle and furuncle&quot;
         ))</code></pre>
</div>
<div id="cardiac-arrhythmia" class="section level2">
<h2>Cardiac arrhythmia</h2>
<pre class="r"><code>arrhythmia_terms &lt;-
c(&quot;ventricular arrhythmia&quot;,
  &quot;torsades de pointes&quot;
  )

gwas_study_info = gwas_study_info |&gt;
  mutate(collected_all_disease_terms  = 
         stringr::str_replace_all(collected_all_disease_terms,
                          pattern = vec_to_grep_pattern(arrhythmia_terms),
                          &quot;cardiac arrhythmia&quot;
         ))</code></pre>
</div>
<div id="cardiomyopathy" class="section level2">
<h2>Cardiomyopathy</h2>
<pre class="r"><code>cardiomyopathy_terms &lt;- c(&quot;nonischemic cardiomyopathy&quot;)

gwas_study_info =
gwas_study_info |&gt; 
 mutate(collected_all_disease_terms  = 
          stringr::str_replace_all(collected_all_disease_terms,
                                  pattern = vec_to_grep_pattern(cardiomyopathy_terms),
                                   &quot;cardiomyopathy&quot;
                          )  
        )</code></pre>
</div>
<div id="celiac-disease" class="section level2">
<h2>Celiac disease</h2>
<pre class="r"><code>gwas_study_info = 
gwas_study_info |&gt; 
 mutate(collected_all_disease_terms  = 
          stringr::str_replace_all(collected_all_disease_terms,
                                  pattern = vec_to_grep_pattern(&quot;refractory celiac disease&quot;),
                                   &quot;celiac disease&quot;
                          )  
        )</code></pre>
</div>
<div id="central-and-perpheral-ertigo" class="section level2">
<h2>Central and perpheral ertigo</h2>
<pre class="r"><code>gwas_study_info = gwas_study_info |&gt;
  mutate(collected_all_disease_terms  = 
         stringr::str_replace_all(collected_all_disease_terms,
                          vec_to_grep_pattern(&quot;central nervous system origin vertigo&quot;),
                          &quot;central origin vertigo&quot;
         ))


gwas_study_info = gwas_study_info |&gt;
  mutate(collected_all_disease_terms  = 
         stringr::str_replace_all(collected_all_disease_terms,
                          vec_to_grep_pattern(&quot;peripheral vertigo&quot;),
                          &quot;peripheral or central vertigo&quot;
         ))</code></pre>
</div>
<div id="cerebral-atherosclerosis" class="section level2">
<h2>Cerebral atherosclerosis</h2>
<pre class="r"><code># if Brain vascular atherosclerosis in DISEASE/TRAIT, then change vascular brain injury to  cerebral atherosclerosis 

gwas_study_info = gwas_study_info |&gt;
  mutate(collected_all_disease_terms  = 
         ifelse(grepl(&quot;Brain vascular atherosclerosis&quot;, 
                     `DISEASE/TRAIT`,
                     ignore.case = TRUE),
                stringr::str_replace_all(collected_all_disease_terms,
                          vec_to_grep_pattern(&quot;vascular brain injury&quot;),
                          &quot;cerebral atherosclerosis&quot;
         ),
         collected_all_disease_terms
         )
  )</code></pre>
</div>
<div id="cerebrovascular-disease" class="section level2">
<h2>Cerebrovascular disease</h2>
<pre class="r"><code>gwas_study_info = gwas_study_info |&gt;
  mutate(collected_all_disease_terms  = 
        ifelse(grepl(&quot;Vascular brain injury&quot;, 
                     `DISEASE/TRAIT`,
                     ignore.case = TRUE),
         stringr::str_replace_all(collected_all_disease_terms,
                          vec_to_grep_pattern(c(
                             &quot;vascular brain injury&quot;
                             )
                             ),
                          &quot;cerebrovascular disease&quot;
         ),
         collected_all_disease_terms)
  )</code></pre>
</div>
<div id="cognitive-decline-age-related" class="section level2">
<h2>Cognitive decline (age-related)</h2>
<pre class="r"><code>gwas_study_info =
  gwas_study_info |&gt;
  mutate(collected_all_disease_terms =
           ifelse(grepl(&quot;Cognitive decline \\(age-related\\)&quot;,
                        `DISEASE/TRAIT`,
                       ignore.case = TRUE) |
                  grepl(&quot;cognitive ageing&quot;,
                        STUDY,
                        ignore.case = TRUE),
                  str_replace_all(collected_all_disease_terms,
                                  pattern = vec_to_grep_pattern(&quot;mental deterioration&quot;),
                                  replacement = &quot;cognitive decline (age-related)&quot;
                  ),
                  collected_all_disease_terms
           )
)


gwas_study_info =
  gwas_study_info |&gt;
  mutate(collected_all_disease_terms =
           ifelse(grepl(&quot;cognitive decline in schizophrenia&quot;,
                        STUDY,
                       ignore.case = TRUE),  
                  str_replace_all(collected_all_disease_terms,
                                  pattern = vec_to_grep_pattern(&quot;mental deterioration&quot;),
                                  replacement = &quot;schizophrenia&quot;
                  ),
                  collected_all_disease_terms
           )
)</code></pre>
</div>
<div id="congenital-anomalies-of-intestine" class="section level2">
<h2>Congenital anomalies of intestine</h2>
<pre class="r"><code># anorectal malformation to congenital anomalies of intestine
gwas_study_info =
  gwas_study_info |&gt;
  mutate(collected_all_disease_terms  = 
                stringr::str_replace_all(collected_all_disease_terms,
                          vec_to_grep_pattern(&quot;anorectal malformation&quot;),
                          &quot;congenital anomalies of intestine&quot;
         )
  )</code></pre>
</div>
<div id="cerebral-infarction" class="section level2">
<h2>Cerebral infarction</h2>
<pre class="r"><code>gwas_study_info = gwas_study_info |&gt;
  mutate(collected_all_disease_terms  = 
          ifelse(grepl(&quot;Ischemic stroke \\(cardioembolic\\)&quot;, 
                     `DISEASE/TRAIT`,
                     ignore.case = TRUE),
         stringr::str_replace_all(collected_all_disease_terms,
                          vec_to_grep_pattern(c(
                             &quot;cardiac embolism&quot;
                             )),
                          &quot;cardioembolic stroke&quot;
         ),
         collected_all_disease_terms
         )
  )

gwas_study_info = gwas_study_info |&gt;
  mutate(collected_all_disease_terms  = 
         stringr::str_replace_all(collected_all_disease_terms,
                          vec_to_grep_pattern(c(
                             &quot;mri defined brain infarct&quot;,
                             &quot;cardioembolic stroke&quot;)
                             ),
                          &quot;cerebral infarction&quot;
         ))</code></pre>
</div>
<div id="cervical-cancer-dysplasia---cervical-cancer-cervical-dysplasia"
class="section level2">
<h2>Cervical cancer, dysplasia -&gt; cervical cancer, cervical
dysplasia</h2>
<pre class="r"><code>gwas_study_info = gwas_study_info |&gt;
  mutate(collected_all_disease_terms  = 
         stringr::str_replace_all(collected_all_disease_terms,
                          vec_to_grep_pattern(&quot;cervical cancer, dysplasia&quot;),
                          &quot;cervical cancer, cervical dysplasia&quot;
         ))</code></pre>
</div>
<div id="chromosomal-anomalies" class="section level2">
<h2>Chromosomal anomalies</h2>
<pre class="r"><code>gwas_study_info = gwas_study_info |&gt;
  mutate(collected_all_disease_terms  = 
         stringr::str_replace_all(collected_all_disease_terms,
                          vec_to_grep_pattern(c(
                            &quot;22q11.2 deletion syndrome&quot;,
                            &quot;abnormality of chromosome segregation&quot;,
                            &quot;fragile x syndrome&quot;)
                            ),
                          &quot;chromosomal anomalies&quot;
         ))</code></pre>
</div>
<div id="cholangitis" class="section level2">
<h2>Cholangitis</h2>
<pre class="r"><code>gwas_study_info = gwas_study_info |&gt;
  mutate(collected_all_disease_terms  = 
         stringr::str_replace_all(collected_all_disease_terms,
                          vec_to_grep_pattern(&quot;sclerosing cholangitis&quot;),
                          &quot;cholangitis&quot;
         ))</code></pre>
</div>
<div id="chronic-kidney-disease" class="section level2">
<h2>Chronic kidney disease</h2>
<pre class="r"><code>gwas_study_info = gwas_study_info |&gt;
  mutate(collected_all_disease_terms = 
         stringr::str_replace_all(collected_all_disease_terms,
                          vec_to_grep_pattern(&quot;stage 5 chronic kidney disease&quot;),
                          &quot;chronic kidney disease&quot;
         ))</code></pre>
</div>
<div id="chronic-non-alcoholic-pancreatitis" class="section level2">
<h2>Chronic non-alcoholic pancreatitis</h2>
<pre class="r"><code># if Non-alcoholic chronic pancreatitis  in `DISEASE/TRAIT`,
# then non-alcoholic pancreatitis to chronic pancreatitis

gwas_study_info = gwas_study_info |&gt;
  mutate(collected_all_disease_terms  = 
         ifelse(grepl(&quot;Non-alcoholic chronic pancreatitis&quot;, 
                     `DISEASE/TRAIT`,
                     ignore.case = TRUE),
                stringr::str_replace_all(collected_all_disease_terms,
                          vec_to_grep_pattern(&quot;non-alcoholic pancreatitis&quot;),
                          &quot;chronic pancreatitis&quot;
         ),
         collected_all_disease_terms
         )
  )</code></pre>
</div>
<div id="chronic-pain" class="section level2">
<h2>Chronic pain</h2>
<pre class="r"><code>gwas_study_info = gwas_study_info |&gt;
  mutate(collected_all_disease_terms  = 
         stringr::str_replace_all(collected_all_disease_terms,
                          vec_to_grep_pattern(c(
                            &quot;chronic widespread pain&quot;,
                            &quot;multisite chronic pain&quot;,
                            &quot;chronic musculoskeletal pain&quot;,
                            &quot;chronic pain syndrome&quot;)
                            ),
                          &quot;chronic pain&quot;
         ))</code></pre>
</div>
<div id="chronic-pharyngitis-nasopharyngitis" class="section level2">
<h2>Chronic pharyngitis, nasopharyngitis</h2>
<pre class="r"><code>gwas_study_info = gwas_study_info |&gt;
  mutate(collected_all_disease_terms  = 
         stringr::str_replace_all(collected_all_disease_terms,
                          vec_to_grep_pattern(c(&quot;chronic pharyngitis, nasopharyngitis&quot;)
                                              ),
                          &quot;chronic pharyngitis, chronic nasopharyngitis&quot;
         ))</code></pre>
</div>
<div id="chronic-rhinosinusitis" class="section level2">
<h2>Chronic rhinosinusitis</h2>
<pre class="r"><code>gwas_study_info = gwas_study_info |&gt;
  mutate(collected_all_disease_terms  = 
         stringr::str_replace_all(collected_all_disease_terms,
                          vec_to_grep_pattern(&quot;chronic rhinosinusitis with nasal polyps&quot;),
                          &quot;chronic rhinosinusitis&quot;
         ))</code></pre>
</div>
<div id="chronic-sinusitis" class="section level2">
<h2>Chronic sinusitis</h2>
<pre class="r"><code>gwas_study_info = gwas_study_info |&gt;
  mutate(collected_all_disease_terms  = 
         stringr::str_replace_all(collected_all_disease_terms,
                          vec_to_grep_pattern(&quot;chronic sinus infection&quot;),
                          &quot;chronic sinusitis&quot;
         ))</code></pre>
</div>
<div id="crohns-disease" class="section level2">
<h2>Crohn’s Disease</h2>
<pre class="r"><code>gwas_study_info = gwas_study_info |&gt;
  mutate(collected_all_disease_terms  = 
         stringr::str_replace_all(collected_all_disease_terms,
                          vec_to_grep_pattern(&quot;perianal crohns disease&quot;),
                          &quot;crohns disease&quot;
         ))</code></pre>
</div>
<div id="cluster-headache-syndrome" class="section level2">
<h2>Cluster headache syndrome</h2>
<pre class="r"><code>gwas_study_info = gwas_study_info |&gt;
  mutate(collected_all_disease_terms  = 
         stringr::str_replace_all(collected_all_disease_terms,
                          vec_to_grep_pattern(&quot;cluster headache&quot;),
                          &quot;cluster headache syndrome&quot;
         ))</code></pre>
</div>
<div id="circumscribed-brain-atrophy" class="section level2">
<h2>Circumscribed brain atrophy</h2>
<pre class="r"><code>brain_atropy &lt;- c(&quot;frontotemporal dementia&quot;,
                  &quot;grn-related frontotemporal lobar degeneration with tdp43 inclusions&quot;,
                  &quot;pick disease&quot;)

gwas_study_info = gwas_study_info |&gt;
  mutate(collected_all_disease_terms  = 
         stringr::str_replace_all(collected_all_disease_terms,
                          vec_to_grep_pattern(brain_atropy),
                          &quot;circumscribed brain atrophy&quot;
         ))</code></pre>
</div>
<div id="contact-dermatitis" class="section level2">
<h2>Contact dermatitis</h2>
<pre class="r"><code>pattern &lt;- vec_to_grep_pattern(&quot;contact dermatitis due to nickel&quot;)


gwas_study_info = gwas_study_info |&gt;
  mutate(collected_all_disease_terms = 
         stringr::str_replace_all(collected_all_disease_terms,
                          pattern = pattern,
                          &quot;contact dermatitis&quot;
         ))</code></pre>
</div>
<div id="congenital-heart-diseases" class="section level2">
<h2>Congenital heart disease/s</h2>
<pre class="r"><code>congenital_heart_disease_terms &lt;- c(
  &quot;heart septal defect&quot;,  
  &quot;atrial heart septal defect&quot;,
  
  &quot;congenital left-sided heart lesions&quot;,
  &quot;congenital right-sided heart lesions&quot;,
  
  &quot;congenital anomaly of the great arteries&quot;, # equiv = &quot;Congenital malformation of great arteries, unspecified&quot;
  
  # malformation of cardiac septum, 
    &quot;abnormal cardiac septum morphology&quot;,
    &quot;atrioventricular canal defect&quot;,
  &quot;ventricular outflow obstruction&quot;
)
  

url &lt;- &quot;http://www.ebi.ac.uk/ols4/api/ontologies/efo/terms/http%253A%252F%252Fwww.ebi.ac.uk%252Fefo%252FEFO_0005207/descendants&quot;

congenital_heart_disease_terms &lt;- c(congenital_heart_disease_terms,
                                  get_descendants(url)
                                  ) |&gt;
  unique()</code></pre>
<pre><code>[1] &quot;Number of terms collected:&quot;
[1] 106
[1] &quot;\n Some example terms&quot;
[1] &quot;double outlet right ventricle with subaortic or doubly committed ventricular septal defect with pulmonary stenosis&quot;
[2] &quot;gata6-related congenital heart disease with or without pancreatic agenesis or neonatal diabetes&quot;                   
[3] &quot;double outlet right ventricle with non-committed subpulmonary ventricular septal defect&quot;                           
[4] &quot;congenitally uncorrected transposition of the great arteries with cardiac malformation&quot;                            
[5] &quot;congenitally uncorrected transposition of the great arteries with coarctation&quot;                                     </code></pre>
<pre class="r"><code>gwas_study_info = gwas_study_info |&gt;
  mutate(collected_all_disease_terms  = 
         stringr::str_replace_all(collected_all_disease_terms,
                          pattern = vec_to_grep_pattern(congenital_heart_disease_terms),
                          &quot;congenital heart disease&quot;
         )
  )

# if DISEASE/TRAIT contains Congenital heart disease 
# then replace abnormal cardiovascular system morphology with congenital heart disease
gwas_study_info = 
  gwas_study_info |&gt;
  mutate(collected_all_disease_terms  = 
         ifelse(grepl(&quot;Congenital heart disease&quot;, 
                     `DISEASE/TRAIT`,
                     ignore.case = TRUE),
                stringr::str_replace_all(collected_all_disease_terms,
                          vec_to_grep_pattern(&quot;abnormal cardiovascular system morphology&quot;),
                          &quot;congenital heart disease&quot;
         ),
         collected_all_disease_terms
         )
  )


url &lt;- &quot;http://www.ebi.ac.uk/ols4/api/ontologies/mondo/terms/http%253A%252F%252Fpurl.obolibrary.org%252Fobo%252FMONDO_0024239/descendants&quot;

more_congenital_heart_disease_terms &lt;- get_descendants(url)</code></pre>
<pre><code>[1] &quot;Number of terms collected:&quot;
[1] 230
[1] &quot;\n Some example terms&quot;
[1] &quot;double outlet right ventricle with subaortic or doubly committed ventricular septal defect with pulmonary stenosis&quot;
[2] &quot;double outlet right ventricle with atrioventricular septal defect, pulmonary stenosis, heterotaxy&quot;                 
[3] &quot;gata6-related congenital heart disease with or without pancreatic agenesis or neonatal diabetes&quot;                   
[4] &quot;double outlet right ventricle with subaortic or doubly committed ventricular septal defect&quot;                        
[5] &quot;pulmonary valve agenesis-ventricular septal defect-persistent ductus arteriosus syndrome&quot;                          </code></pre>
<pre class="r"><code>congenital_heart_disease_terms &lt;- c(congenital_heart_disease_terms,
                                  more_congenital_heart_disease_terms
                                  ) |&gt;
  unique() |&gt;
  str_length_sort()


gwas_study_info = gwas_study_info |&gt;
  mutate(collected_all_disease_terms  = 
         stringr::str_replace_all(collected_all_disease_terms,
                          pattern = vec_to_grep_pattern(congenital_heart_disease_terms),
                          &quot;congenital anomaly of cardiovascular system&quot;
         )
  )</code></pre>
</div>
<div id="cardiac-congenital-anomalies" class="section level2">
<h2>Cardiac congenital anomalies</h2>
<pre class="r"><code>cardiac_congenital_anomalies_terms &lt;- c(
  &quot;bicuspid aortic valve&quot;
)

gwas_study_info = gwas_study_info |&gt;
  mutate(collected_all_disease_terms  = 
         stringr::str_replace_all(collected_all_disease_terms,
                          pattern = vec_to_grep_pattern(cardiac_congenital_anomalies_terms),
                          &quot;cardiac congenital anomalies&quot;
         )
  )</code></pre>
</div>
<div id="congenital-hypertrophic-pyloric-stenosis"
class="section level2">
<h2>Congenital hypertrophic pyloric stenosis</h2>
<pre class="r"><code>gwas_study_info = gwas_study_info |&gt;
  mutate(collected_all_disease_terms  = 
         stringr::str_replace_all(collected_all_disease_terms,
                          vec_to_grep_pattern(&quot;infantile hypertrophic pyloric stenosis&quot;),
                          &quot;congenital hypertrophic pyloric stenosis&quot;
         ))</code></pre>
</div>
<div id="congenital-hypothyroidism" class="section level2">
<h2>Congenital hypothyroidism</h2>
<pre class="r"><code>gwas_study_info = gwas_study_info |&gt;
  mutate(collected_all_disease_terms  = 
         stringr::str_replace_all(collected_all_disease_terms,
                          vec_to_grep_pattern(&quot;congenital hypothyroidism due to developmental anomaly&quot;),
                          &quot;congenital hypothyroidism&quot;
         ))</code></pre>
</div>
<div id="congestive-heart-failure-chf-nos" class="section level2">
<h2>Congestive heart failure (CHF) NOS</h2>
<pre class="r"><code>gwas_study_info = gwas_study_info |&gt;
  mutate(collected_all_disease_terms  = 
         stringr::str_replace_all(collected_all_disease_terms,
                          vec_to_grep_pattern(c(
                            &quot;diastolic heart failure&quot;,
                            &quot;systolic heart failure&quot;)
                            ),
                          &quot;congestive heart failure \\(chf\\) nos&quot;
         ))</code></pre>
</div>
<div id="coronary-artery-aneurysm-and-dissection"
class="section level2">
<h2>Coronary artery aneurysm and dissection</h2>
<pre class="r"><code>gwas_study_info = gwas_study_info |&gt;
  mutate(collected_all_disease_terms  = 
         stringr::str_replace_all(collected_all_disease_terms,
                          vec_to_grep_pattern(c(
                            &quot;coronary aneurysm&quot;,
                            &quot;coronary artery dissection&quot;)
                            ),
                          &quot;coronary artery aneurysm and dissection&quot;
         ))

# Aortic aneurysm

gwas_study_info = gwas_study_info |&gt;
  mutate(collected_all_disease_terms  = 
         stringr::str_replace_all(collected_all_disease_terms,
                          vec_to_grep_pattern(c(
                            &quot;thoracic aortic aneurysm&quot;)
                            ),
                          &quot;aortic aneurysm&quot;
         ))</code></pre>
</div>
<div id="creutzfeldt-jacob-disease" class="section level2">
<h2>Creutzfeldt jacob disease</h2>
<pre class="r"><code>gwas_study_info = gwas_study_info |&gt;
  mutate(collected_all_disease_terms  = 
         stringr::str_replace_all(collected_all_disease_terms,
                          vec_to_grep_pattern(
                          c(&quot;sporadic creutzfeld jacob disease&quot;,
                            &quot;creutzfeldt jacob disease&quot;,
                            &quot;creutzfeldt-jacob disease&quot;)
                          ),
                          &quot;creutzfeldt-jakob disease&quot;
         ))</code></pre>
</div>
<div id="cryoglobulinemia" class="section level2">
<h2>Cryoglobulinemia</h2>
<pre class="r"><code>gwas_study_info = gwas_study_info |&gt;
  mutate(collected_all_disease_terms  = 
         stringr::str_replace_all(collected_all_disease_terms,
                          vec_to_grep_pattern(&quot;cryoglobulinemia&quot;),
                          &quot;cryoglobulinaemia&quot;
         ))</code></pre>
</div>
<div id="cystic-fibrosis-with-intestinal-manifestations"
class="section level2">
<h2>Cystic fibrosis with intestinal manifestations</h2>
<pre class="r"><code>gwas_study_info = gwas_study_info |&gt;
  mutate(collected_all_disease_terms  = 
         stringr::str_replace_all(collected_all_disease_terms,
                          vec_to_grep_pattern(&quot;cystic fibrosis associated meconium ileus&quot;),
                          &quot;cystic fibrosis with intestinal manifestations&quot;
         ))</code></pre>
</div>
<div id="degeneration-of-macula-and-posterior-pole"
class="section level2">
<h2>Degeneration of macula and posterior pole</h2>
<pre class="r"><code>macular &lt;- c(&quot;macular degeneration&quot;,
             &quot;atrophic macular degeneration&quot;,
             &quot;retinal drusen&quot;
             )

gwas_study_info = gwas_study_info |&gt;
  mutate(collected_all_disease_terms  = 
         stringr::str_replace_all(collected_all_disease_terms,
                          vec_to_grep_pattern(macular),
                          &quot;degeneration of macula and posterior pole&quot;
         ))</code></pre>
</div>
<div id="dermatomyositis" class="section level2">
<h2>Dermatomyositis</h2>
<pre class="r"><code>gwas_study_info = gwas_study_info |&gt;
  mutate(collected_all_disease_terms  = 
         stringr::str_replace_all(collected_all_disease_terms,
                          vec_to_grep_pattern(&quot;clinically amyopathic dermatomyositis&quot;),
                          &quot;dermatomyositis&quot;
         ))</code></pre>
</div>
<div id="dental-caries" class="section level2">
<h2>Dental caries</h2>
<pre class="r"><code>dental_caries_terms &lt;- c(&quot;pit and fissure surface dental caries&quot;,
                         &quot;smooth surface dental caries&quot;,
                         &quot;primary dental caries&quot;,
                         &quot;enamel caries&quot;,
                         &quot;permanent dental caries&quot;
                         )

gwas_study_info = gwas_study_info |&gt;
  mutate(collected_all_disease_terms  = 
         stringr::str_replace_all(collected_all_disease_terms,
                          pattern = vec_to_grep_pattern(dental_caries_terms),
                          &quot;dental caries&quot;
         )
)</code></pre>
</div>
<div id="depressive-episode" class="section level2">
<h2>Depressive episode</h2>
<pre class="r"><code>depress_epi &lt;- c(&quot;depressive&quot;,
                 &quot;depression&quot;,
                 &quot;depressive disorder&quot;
                 )

gwas_study_info = gwas_study_info |&gt;
  mutate(collected_all_disease_terms  = 
         stringr::str_replace_all(collected_all_disease_terms,
                          vec_to_grep_pattern(depress_epi),
                          &quot;depressive episode&quot;
         ))

gwas_study_info = gwas_study_info |&gt;
  mutate(collected_all_disease_terms  = 
         stringr::str_replace_all(collected_all_disease_terms,
                          vec_to_grep_pattern(depress_epi),
                          &quot;depressive episode&quot;
         ))</code></pre>
</div>
<div id="dilated-cardiomyopathy" class="section level2">
<h2>Dilated cardiomyopathy</h2>
<pre class="r"><code>gwas_study_info = gwas_study_info |&gt;
  mutate(collected_all_disease_terms  = 
         stringr::str_replace_all(collected_all_disease_terms,
                          vec_to_grep_pattern(&quot;idiopathic dilated cardiomyopathy&quot;),
                          &quot;dilated cardiomyopathy&quot;
         ))</code></pre>
</div>
<div id="disturbances-of-sensation-of-smell-and-taste"
class="section level2">
<h2>Disturbances of sensation of smell and taste</h2>
<pre class="r"><code>terms &lt;- c(&quot;ageusia&quot;,
           &quot;abnormality of the sense of smell&quot;)

gwas_study_info = gwas_study_info |&gt;
  mutate(collected_all_disease_terms  = 
         stringr::str_replace_all(collected_all_disease_terms,
                          pattern = vec_to_grep_pattern(terms),
                          &quot;disturbances of sensation of smell and taste&quot;
         )
  )</code></pre>
</div>
<div id="disorders-of-tooth-development" class="section level2">
<h2>Disorders of tooth development</h2>
<pre class="r"><code>tooth_dev_terms &lt;- c(&quot;dental enamel hypoplasia&quot;,
                     &quot;tooth agenesis&quot;,
                     &quot;molar-incisor hypomineralization&quot;
                     )

gwas_study_info = gwas_study_info |&gt;
  mutate(collected_all_disease_terms  = 
         stringr::str_replace_all(collected_all_disease_terms,
                          pattern = vec_to_grep_pattern(tooth_dev_terms),
                          &quot;disorders of tooth development&quot;
         )
  )</code></pre>
</div>
<div id="disorders-of-purine-and-pyrimidine-metabolism"
class="section level2">
<h2>Disorders of purine and pyrimidine metabolism</h2>
<pre class="r"><code>gwas_study_info = gwas_study_info |&gt;
  mutate(collected_all_disease_terms  = 
         stringr::str_replace_all(collected_all_disease_terms,
                          vec_to_grep_pattern(&quot;hyperuricemia&quot;),
                          &quot;disorders of purine and pyrimidine metabolism&quot;
         ))</code></pre>
</div>
<div id="disorders-of-refraction-and-accommodation"
class="section level2">
<h2>Disorders of refraction and accommodation</h2>
<pre class="r"><code>refractive_terms &lt;- c(&quot;hyperopia&quot;,
                      &quot;refractive error&quot;
                      )

gwas_study_info = gwas_study_info |&gt;
  mutate(collected_all_disease_terms  = 
         stringr::str_replace_all(collected_all_disease_terms,
                          pattern = vec_to_grep_pattern(refractive_terms),
                          &quot;disorders of refraction and accommodation&quot;
         )
  )</code></pre>
</div>
<div id="diseases-of-white-blood-cells" class="section level2">
<h2>Diseases of white blood cells</h2>
<pre class="r"><code>wbc_terms &lt;- c(&quot;leukopenia&quot;)

gwas_study_info = gwas_study_info |&gt;
  mutate(collected_all_disease_terms  = 
         stringr::str_replace_all(collected_all_disease_terms,
                          pattern = vec_to_grep_pattern(wbc_terms),
                          &quot;diseases of white blood cells&quot;
         )
  )</code></pre>
</div>
<div id="disorders-of-amino-acid-metabolism" class="section level2">
<h2>Disorders of amino-acid metabolism</h2>
<pre class="r"><code>gwas_study_info = gwas_study_info |&gt;
  mutate(collected_all_disease_terms  = 
         stringr::str_replace_all(collected_all_disease_terms,
                          vec_to_grep_pattern(&quot;amino acid metabolism disease&quot;),
                          &quot;disorders of amino-acid metabolism&quot;
         ))</code></pre>
</div>
<div id="drug-allergy" class="section level2">
<h2>Drug allergy</h2>
<pre class="r"><code>gwas_study_info = gwas_study_info |&gt;
  mutate(collected_all_disease_terms  = 
         stringr::str_replace_all(collected_all_disease_terms,
                          vec_to_grep_pattern(&quot;beta-lactam allergy&quot;),
                          &quot;drug allergy&quot;
         ))</code></pre>
</div>
<div id="eczema" class="section level2">
<h2>Eczema</h2>
<pre class="r"><code># if DISEASE/STUDY contains eczema, change eczematoid dermatitis to eczema
gwas_study_info = gwas_study_info |&gt;
  mutate(collected_all_disease_terms  = 
         ifelse(grepl(&quot;eczema&quot;, 
                     `DISEASE/TRAIT`,
                     ignore.case = TRUE),
                stringr::str_replace_all(collected_all_disease_terms,
                          vec_to_grep_pattern(&quot;eczematoid dermatitis&quot;),
                          &quot;eczema&quot;
         ),
         collected_all_disease_terms
         )
  )


gwas_study_info = gwas_study_info |&gt;
  mutate(collected_all_disease_terms  = 
                stringr::str_replace_all(collected_all_disease_terms,
                          vec_to_grep_pattern(&quot;hand eczema&quot;),
                          &quot;eczema&quot;
         )
  )</code></pre>
</div>
<div id="essential-hypertension" class="section level2">
<h2>Essential hypertension</h2>
<pre class="r"><code>gwas_study_info = gwas_study_info |&gt;
  mutate(collected_all_disease_terms  = 
         stringr::str_replace_all(collected_all_disease_terms,
                          vec_to_grep_pattern(
                            c(
                              &quot;early onset hypertension&quot;,
                              &quot;treatment-resistant hypertension&quot;)),
                          &quot;essential hypertension&quot;
         ))</code></pre>
</div>
<div id="exstrophy-of-urinary-bladder" class="section level2">
<h2>Exstrophy of urinary bladder</h2>
<pre class="r"><code>gwas_study_info = gwas_study_info |&gt;
  mutate(collected_all_disease_terms  = 
         stringr::str_replace_all(collected_all_disease_terms,
                          vec_to_grep_pattern(&quot;bladder exstrophy&quot;),
                          &quot;exstrophy of urinary bladder&quot;
         ))</code></pre>
</div>
<div id="febrile-seizures" class="section level2">
<h2>Febrile seizures</h2>
<pre class="r"><code>gwas_study_info = gwas_study_info |&gt;
  mutate(collected_all_disease_terms  = 
         stringr::str_replace_all(collected_all_disease_terms,
                          vec_to_grep_pattern(c(
                                                &quot;mmr-related febrile seizures&quot;,
                                                &quot;febrile seizure&quot;)
                                              ),
                          &quot;febrile convulsions&quot;
         ))</code></pre>
</div>
<div id="food-allergy" class="section level2">
<h2>Food allergy</h2>
<pre class="r"><code>gwas_study_info = gwas_study_info |&gt;
  mutate(collected_all_disease_terms  = 
         stringr::str_replace_all(collected_all_disease_terms,
                                  vec_to_grep_pattern(
                                    c(&quot;peanut allergy&quot;,
                                      &quot;milk allergy&quot;,
                                      &quot;egg allergy&quot;,
                                      &quot;wheat allergic reaction&quot;
                                     )),
                          &quot;food allergy&quot;
         ))</code></pre>
</div>
<div id="fuchs-endothelial-corneal-dystrophy" class="section level2">
<h2>Fuchs endothelial corneal dystrophy</h2>
<pre class="r"><code>gwas_study_info = gwas_study_info |&gt;
  mutate(collected_all_disease_terms  = 
         stringr::str_replace_all(collected_all_disease_terms,
                          vec_to_grep_pattern(&quot;fuchs endothelial dystrophy&quot;),
                          &quot;fuchs endothelial corneal dystrophy&quot;
         ))</code></pre>
</div>
<div id="gingival-and-periodontal-diseases" class="section level2">
<h2>Gingival and periodontal diseases</h2>
<pre class="r"><code>ginival_and_periodontal_terms &lt;- c(&quot;periodontal pocket&quot;,
                                   &quot;periodontal disorder&quot;,
                                   &quot;gingival disease&quot;,
                                   &quot;gingival bleeding&quot;
                               )

gwas_study_info = gwas_study_info |&gt;
  mutate(collected_all_disease_terms  = 
         stringr::str_replace_all(collected_all_disease_terms,
                          pattern = vec_to_grep_pattern(ginival_and_periodontal_terms),
                          &quot;gingival and periodontal diseases&quot;
         )
  )</code></pre>
</div>
<div id="glaucoma" class="section level2">
<h2>Glaucoma</h2>
<pre class="r"><code>url &lt;- &quot;http://www.ebi.ac.uk/ols4/api/ontologies/efo/terms/http%253A%252F%252Fpurl.obolibrary.org%252Fobo%252FMONDO_0005041/descendants&quot;

glaucoma_terms &lt;- get_descendants(url)</code></pre>
<pre><code>[1] &quot;Number of terms collected:&quot;
[1] 19
[1] &quot;\n Some example terms&quot;
[1] &quot;cyp1b1-related glaucoma with or without anterior segment dysgenesis&quot;
[2] &quot;glaucoma secondary to spherophakia/ectopia lentis and megalocornea&quot; 
[3] &quot;hereditary glaucoma, primary closed-angle&quot;                          
[4] &quot;primary angle closure glaucoma&quot;                                     
[5] &quot;secondary dysgenetic glaucoma&quot;                                      </code></pre>
<pre class="r"><code>gwas_study_info = gwas_study_info |&gt;
  mutate(collected_all_disease_terms  = 
         stringr::str_replace_all(collected_all_disease_terms,
                          pattern = vec_to_grep_pattern(glaucoma_terms),
                          &quot;glaucoma&quot;
         ))</code></pre>
</div>
<div id="graft-vs-host-disease" class="section level2">
<h2>Graft vs host disease</h2>
<pre class="r"><code>graft_vs_host_terms &lt;- c(&quot;chronic graft versus host disease&quot;,
                         &quot;chronic graft vs. host disease&quot;,
                         &quot;acute graft versus host disease&quot;,
                         &quot;acute graft vs. host disease&quot;
                         )

gwas_study_info = gwas_study_info |&gt;
  mutate(collected_all_disease_terms  = 
         stringr::str_replace_all(collected_all_disease_terms,
                          vec_to_grep_pattern(graft_vs_host_terms),
                          &quot;graft versus host disease&quot;
         ))</code></pre>
</div>
<div id="hearing-loss" class="section level2">
<h2>Hearing loss</h2>
<pre class="r"><code>gwas_study_info  = gwas_study_info |&gt;
  mutate(collected_all_disease_terms  = 
         stringr::str_replace_all(collected_all_disease_terms,
                          vec_to_grep_pattern(&quot;age-related hearing impairment&quot;),
                          &quot;presbycusis&quot;
         ))

gwas_study_info  = gwas_study_info |&gt;
  mutate(collected_all_disease_terms  = 
         stringr::str_replace_all(collected_all_disease_terms,
                          vec_to_grep_pattern(c(
                            &quot;deafness&quot;,
                            &quot;noise-induced hearing loss&quot;)
                            ),
                          &quot;hearing loss&quot;
         ))</code></pre>
</div>
<div id="hemiplegia" class="section level2">
<h2>Hemiplegia</h2>
<pre class="r"><code>gwas_study_info = gwas_study_info |&gt;
  mutate(collected_all_disease_terms  = 
         stringr::str_replace_all(collected_all_disease_terms,
                          vec_to_grep_pattern(c(&quot;hemiparesis&quot;)),
                          &quot;hemiplegia&quot;
         ))</code></pre>
</div>
<div id="hepatic-steatosis" class="section level2">
<h2>Hepatic steatosis</h2>
<pre class="r"><code># if DISEASE/TRAIT contains hepatic steatosis in non-alcoholic fatty liver disease
# replace hepatic steatosis with nonalcoholic steatohepatitis 

gwas_study_info =
  gwas_study_info |&gt;
  mutate(collected_all_disease_terms  = 
         ifelse(grepl(&quot;hepatic steatosis in non-alcoholic fatty liver disease&quot;, 
                     `DISEASE/TRAIT`,
                     ignore.case = TRUE),
                stringr::str_replace_all(collected_all_disease_terms,
                          vec_to_grep_pattern(&quot;hepatic steatosis&quot;),
                          &quot;nonalcoholic steatohepatitis&quot;
         ),
         collected_all_disease_terms
         )
  )


gwas_study_info =
  gwas_study_info |&gt;
  mutate(collected_all_disease_terms  = 
                stringr::str_replace_all(collected_all_disease_terms,
                          vec_to_grep_pattern(&quot;non-alcoholic steatohepatitis&quot;),
                          &quot;nonalcoholic steatohepatitis&quot;
  )
  )</code></pre>
</div>
<div id="hereditary-hemochromatosis" class="section level2">
<h2>Hereditary hemochromatosis</h2>
<pre class="r"><code>gwas_study_info = gwas_study_info |&gt;
  mutate(collected_all_disease_terms  = 
         stringr::str_replace_all(collected_all_disease_terms,
                          vec_to_grep_pattern(&quot;hereditary hemochromatosis type 1&quot;),
                          &quot;hereditary hemochromatosis&quot;
         ))</code></pre>
</div>
<div id="hordeolum-and-other-deep-inflammation-of-eyelid"
class="section level2">
<h2>Hordeolum and other deep inflammation of eyelid</h2>
<pre class="r"><code>gwas_study_info = gwas_study_info |&gt;
  mutate(collected_all_disease_terms  = 
         stringr::str_replace_all(collected_all_disease_terms,
                          vec_to_grep_pattern(&quot;hordeolum&quot;),
                          &quot;hordeolum and other deep inflammation of eyelid&quot;
         ))</code></pre>
</div>
<div id="hypercholesterolemia" class="section level2">
<h2>Hypercholesterolemia</h2>
<pre class="r"><code>gwas_study_info = gwas_study_info |&gt;
  mutate(collected_all_disease_terms  = 
         stringr::str_replace_all(collected_all_disease_terms,
                          vec_to_grep_pattern(c(
                            &quot;familial hypercholesterolemia&quot;
                            )),
                          &quot;hypercholesterolemia&quot;
         ))</code></pre>
</div>
<div id="hyperlipidemia" class="section level2">
<h2>Hyperlipidemia</h2>
<pre class="r"><code>gwas_study_info = gwas_study_info |&gt;
  mutate(collected_all_disease_terms  = 
         stringr::str_replace_all(collected_all_disease_terms,
                          vec_to_grep_pattern(c(
                            &quot;familial hyperlipidemia&quot;
                            )),
                          &quot;hyperlipidemia&quot;
         ))</code></pre>
</div>
<div id="hiv-disease-resulting-in-encephalopathy"
class="section level2">
<h2>HIV disease resulting in encephalopathy</h2>
<pre class="r"><code>gwas_study_info = 
  gwas_study_info |&gt;
  mutate(collected_all_disease_terms  = 
         stringr::str_replace_all(collected_all_disease_terms,
                          vec_to_grep_pattern(c(
                                               &quot;aids dementia&quot;,
                                               &quot;hiv-associated neurocognitive disorder&quot;)
                                              ),
                          &quot;hiv disease resulting in encephalopathy&quot;
         ))</code></pre>
</div>
<div id="intracranial-artery-stenosis" class="section level2">
<h2>Intracranial artery stenosis</h2>
<pre class="r"><code># &quot;arterial stenosis&quot;  -&gt; &quot;Intracranial artery stenosis&quot;
# where DISEASE/TRAIT contains &quot;Intracranial artery stenosis&quot;
# replace &quot;arterial stenosis&quot; with &quot;intracranial artery stenosis&quot;

gwas_study_info = gwas_study_info |&gt;
  mutate(collected_all_disease_terms  = 
         ifelse(grepl(&quot;Intracranial artery stenosis&quot;, 
                     `DISEASE/TRAIT`,
                     ignore.case = TRUE),
                stringr::str_replace_all(collected_all_disease_terms,
                          pattern = &quot;arterial stenosis&quot;,
                          replacement = &quot;intracranial artery stenosis&quot;
         ),
         collected_all_disease_terms
         )
  )</code></pre>
</div>
<div id="inherited-retinal-dystrophy" class="section level2">
<h2>Inherited retinal dystrophy</h2>
<pre class="r"><code>url &lt;-  &quot;http://www.ebi.ac.uk/ols4/api/ontologies/mondo/terms/http%253A%252F%252Fpurl.obolibrary.org%252Fobo%252FMONDO_0019118/descendants&quot;

inherited_retinal_dystrophy_terms &lt;- get_descendants(url)</code></pre>
<pre><code>[1] &quot;Number of terms collected:&quot;
[1] 349
[1] &quot;\n Some example terms&quot;
[1] &quot;spondyloepiphyseal dysplasia, sensorineural hearing loss, impaired intellectual development, and leber congenital amaurosis&quot;
[2] &quot;x-linked intellectual disability-limb spasticity-retinal dystrophy-diabetes insipidus syndrome&quot;                             
[3] &quot;microcephaly with or without chorioretinopathy, lymphedema, or intellectual disability&quot;                                     
[4] &quot;retinal vasculopathy with cerebral leukoencephalopathy and systemic manifestations&quot;                                         
[5] &quot;retinal dystrophy with inner retinal dysfunction and ganglion cell anomalies&quot;                                               </code></pre>
<pre class="r"><code>gwas_study_info = gwas_study_info |&gt;
  mutate(collected_all_disease_terms  = 
         stringr::str_replace_all(collected_all_disease_terms,
                          pattern = vec_to_grep_pattern(inherited_retinal_dystrophy_terms),
                          &quot;hereditary retinal dystrophy&quot;
         ))</code></pre>
</div>
<div id="intentional-self-harm-by-unspecified-means"
class="section level2">
<h2>Intentional self-harm by unspecified means</h2>
<pre class="r"><code>gwas_study_info = gwas_study_info |&gt;
  mutate(collected_all_disease_terms  = 
         stringr::str_replace_all(collected_all_disease_terms,
                          vec_to_grep_pattern(c(&quot;self-injurious behavior&quot;,
                                                &quot;self-injurious ideation&quot;)),
                          &quot;intentional self-harm by unspecified means&quot;
         ))</code></pre>
</div>
<div id="infertility-male" class="section level2">
<h2>Infertility (male)</h2>
<pre class="r"><code>gwas_study_info = gwas_study_info |&gt;
  mutate(collected_all_disease_terms  = 
                  stringr::str_replace_all(collected_all_disease_terms,
                          vec_to_grep_pattern(
                            c(&quot;azoospermia&quot;,
                              &quot;sertoli cell-only syndrome&quot;)
                            ),
                          &quot;male infertility&quot;
                          )  )</code></pre>
</div>
<div id="induratio-penis-plastica" class="section level2">
<h2>Induratio penis plastica</h2>
<pre class="r"><code>gwas_study_info = gwas_study_info |&gt;
  mutate(collected_all_disease_terms  = 
                  stringr::str_replace_all(collected_all_disease_terms,
                          vec_to_grep_pattern(
                            c(&quot;peyronie disease&quot;)
                            ),
                          &quot;induratio penis plastica&quot;
                          )  )</code></pre>
</div>
<div id="intracerebral-hemorrhage" class="section level2">
<h2>Intracerebral hemorrhage</h2>
<pre class="r"><code>gwas_study_info = gwas_study_info |&gt;
  mutate(collected_all_disease_terms  = 
                  stringr::str_replace_all(collected_all_disease_terms,
                          vec_to_grep_pattern(
                            c(&quot;non-lobar intracerebral hemorrhage&quot;,
                              &quot;lobar intracerebral hemorrhage&quot;)
                            ),
                          &quot;intracerebral hemorrhage&quot;
                          )  )</code></pre>
</div>
<div id="idiopathic-generalized-epilepsy" class="section level2">
<h2>Idiopathic generalized epilepsy</h2>
<pre class="r"><code>url &lt;- &quot;http://www.ebi.ac.uk/ols4/api/ontologies/snomed/terms/http%253A%252F%252Fsnomed.info%252Fid%252F36803009/descendants&quot;

idiopathic_generalized_epilepsy_terms &lt;- get_descendants(url)</code></pre>
<pre><code>[1] &quot;Number of terms collected:&quot;
[1] 4
[1] &quot;\n Some example terms&quot;
[1] &quot;epilepsy with generalized tonic-clonic seizures alone (disorder)&quot;
[2] &quot;juvenile myoclonic epilepsy&quot;                                     
[3] &quot;childhood absence epilepsy&quot;                                      
[4] &quot;juvenile absence epilepsy&quot;                                       
[5] NA                                                                </code></pre>
<pre class="r"><code>idiopathic_generalized_epilepsy_terms = stringr::str_remove_all(
                                        idiopathic_generalized_epilepsy_terms, 
                                        &quot; \\(disorder\\)$&quot;
                                        )

idiopathic_generalized_epilepsy_terms = c(&quot;epilepsy with generalized tonic-clonic seizures&quot;,
                                          idiopathic_generalized_epilepsy_terms
                                         )


gwas_study_info = gwas_study_info |&gt;
  mutate(collected_all_disease_terms  = 
         stringr::str_replace_all(collected_all_disease_terms,
                          pattern = vec_to_grep_pattern(idiopathic_generalized_epilepsy_terms),
                          &quot;generalized idiopathic epilepsy and epileptic syndromes&quot;
         ))</code></pre>
</div>
<div id="idiopathic-thrombocytopenic-purpura" class="section level2">
<h2>Idiopathic thrombocytopenic purpura</h2>
<pre class="r"><code>gwas_study_info = gwas_study_info |&gt;
  mutate(collected_all_disease_terms  = 
         stringr::str_replace_all(collected_all_disease_terms,
                          vec_to_grep_pattern(&quot;autoimmune thrombocytopenic purpura&quot;),
                          &quot;idiopathic thrombocytopenic purpura&quot;
         ))</code></pre>
</div>
<div id="juvenile-idiopathic-arthritis" class="section level2">
<h2>Juvenile idiopathic arthritis</h2>
<pre class="r"><code>gwas_study_info = gwas_study_info |&gt;
  mutate(collected_all_disease_terms  = 
         stringr::str_replace_all(collected_all_disease_terms,
                          vec_to_grep_pattern(&quot;rheumatoid factor-negative juvenile idiopathic arthritis&quot;),
                          &quot;juvenile idiopathic arthritis&quot;
         ))</code></pre>
</div>
<div id="keratoconjunctivitis" class="section level2">
<h2>Keratoconjunctivitis</h2>
<pre class="r"><code>gwas_study_info = gwas_study_info |&gt;
  mutate(collected_all_disease_terms  = 
         stringr::str_replace_all(collected_all_disease_terms,
                          vec_to_grep_pattern(&quot;keratoconjunctivitis sicca&quot;),
                          &quot;keratoconjunctivitis&quot;
         ))</code></pre>
</div>
<div id="learning-disorder" class="section level2">
<h2>Learning disorder</h2>
<pre class="r"><code>gwas_study_info = gwas_study_info |&gt;
  mutate(collected_all_disease_terms  = 
         stringr::str_replace_all(collected_all_disease_terms,
                          vec_to_grep_pattern(c(&quot;dyslexia&quot;,
                                                &quot;mathematics disorder&quot;,
                                                &quot;disorder of written expression&quot;
                                                )
                                              ),
                          &quot;learning disorder&quot;
         ))</code></pre>
</div>
<div id="lewy-body-dementia" class="section level2">
<h2>Lewy body dementia</h2>
<pre class="r"><code>gwas_study_info = gwas_study_info |&gt;
  mutate(collected_all_disease_terms  = 
         stringr::str_replace_all(collected_all_disease_terms,
                          vec_to_grep_pattern(&quot;lewy body attribute&quot;),
                          &quot;lewy body dementia&quot;
         ))</code></pre>
</div>
<div id="migraine" class="section level2">
<h2>Migraine</h2>
<pre class="r"><code>gwas_study_info = gwas_study_info |&gt;
  mutate(collected_all_disease_terms  = 
         stringr::str_replace_all(collected_all_disease_terms,
                          vec_to_grep_pattern(
                            c(&quot;migraine with aura&quot;,
                              &quot;migraine without aura&quot;,
                              &quot;migraine disorder&quot;
                              )
                            ),
                          &quot;migraine&quot;
         ))</code></pre>
</div>
<div id="multiple-sclerosis" class="section level2">
<h2>Multiple sclerosis</h2>
<pre class="r"><code>gwas_study_info = gwas_study_info |&gt;
  mutate(collected_all_disease_terms  = 
         stringr::str_replace_all(collected_all_disease_terms,
                          vec_to_grep_pattern(&quot;relapsing-remitting multiple sclerosis&quot;),
                          &quot;multiple sclerosis&quot;
         ))</code></pre>
</div>
<div id="myasthenia-gravis" class="section level2">
<h2>Myasthenia gravis</h2>
<pre class="r"><code>gwas_study_info = gwas_study_info |&gt;
  mutate(collected_all_disease_terms  = 
         stringr::str_replace_all(collected_all_disease_terms,
                          vec_to_grep_pattern(&quot;late-onset myasthenia gravis&quot;),
                          &quot;myasthenia gravis&quot;
         ))</code></pre>
</div>
<div id="narcolepsy-cataplexy-syndrome---narcolepsy-and-cataplexy"
class="section level2">
<h2>Narcolepsy-cataplexy syndrome -&gt; Narcolepsy and cataplexy</h2>
<pre class="r"><code>gwas_study_info = gwas_study_info |&gt;
  mutate(collected_all_disease_terms  = 
         stringr::str_replace_all(collected_all_disease_terms,
                          vec_to_grep_pattern(&quot;narcolepsy-cataplexy syndrome&quot;),
                          &quot;narcolepsy and cataplexy&quot;
         ))</code></pre>
</div>
<div id="nephrolithiasis" class="section level2">
<h2>Nephrolithiasis</h2>
<pre class="r"><code>nephro_terms &lt;- c(&quot;uric acid nephrolithiasis&quot;,
                   &quot;calcium phosphate nephrolithiasis&quot;,
                    &quot;calcium oxalate nephrolithiasis&quot;,
                   &quot;struvite nephrolithiasis&quot;)


gwas_study_info =
gwas_study_info |&gt; 
 mutate(collected_all_disease_terms  = 
          stringr::str_replace_all(collected_all_disease_terms,
                                  pattern = vec_to_grep_pattern(nephro_terms),
                                   &quot;nephrolithiasis&quot;
                          )  
        )</code></pre>
</div>
<div id="nephritis-and-nephropathy-with-pathological-lesion"
class="section level2">
<h2>Nephritis and nephropathy with pathological lesion</h2>
<pre class="r"><code>gwas_study_info = gwas_study_info |&gt;
  mutate(collected_all_disease_terms  = 
         stringr::str_replace_all(collected_all_disease_terms,
                          vec_to_grep_pattern(c(&quot;acute tubulointerstitial nephritis&quot;,
                                              &quot;iga glomerulonephritis&quot;,
                                              &quot;membranous glomerulonephritis&quot;,
                                              &quot;lupus nephritis&quot;)
                                              ),
                          &quot;nephritis and nephropathy with pathological lesion&quot;
         ))</code></pre>
</div>
<div id="neurofibromatosis" class="section level2">
<h2>Neurofibromatosis</h2>
<pre class="r"><code>gwas_study_info = gwas_study_info |&gt;
  mutate(collected_all_disease_terms  = 
         stringr::str_replace_all(collected_all_disease_terms,
                          vec_to_grep_pattern(
                            c(&quot;neurofibromatosis type 1&quot;,
                              &quot;neurofibromatosis type 2&quot;)
                          ),
                          &quot;neurofibromatosis&quot;
         ))</code></pre>
</div>
<div id="neuromyelitis-optica" class="section level2">
<h2>Neuromyelitis optica</h2>
<pre class="r"><code>gwas_study_info = gwas_study_info |&gt;
  mutate(collected_all_disease_terms  = 
         stringr::str_replace_all(collected_all_disease_terms,
                          vec_to_grep_pattern(
                            c(&quot;aquaporin-4 antibody positive neuromyelitis optica&quot;,
                              &quot;aquaporin-4 antibody negative neuromyelitis optica&quot;,
                              &quot;aqp4-igg-positive neuromyelitis optica&quot;,
                              &quot;aqp4-igg-negative neuromyelitis optica&quot;
                            )
                          ),
                          &quot;neuromyelitis optica&quot;
         ))</code></pre>
</div>
<div id="noninflammatory-disorders-of-vagina" class="section level2">
<h2>Noninflammatory disorders of vagina</h2>
<pre class="r"><code>non_inflam_terms &lt;- c(&quot;abnormal vaginal discharge itching&quot;,
                      &quot;abnormal vaginal discharge smell&quot;,
                      &quot;vaginal discharge&quot;)

gwas_study_info = 
  gwas_study_info |&gt;
   mutate(collected_all_disease_terms  = 
          stringr::str_replace_all(collected_all_disease_terms,
                                  pattern = 
                                    vec_to_grep_pattern(
                                      non_inflam_terms
                                      ),
                                   &quot;noninflammatory disorders of vagina&quot;
                          )  
        )</code></pre>
</div>
<div id="obesity" class="section level2">
<h2>Obesity</h2>
<pre class="r"><code>gwas_study_info = 
gwas_study_info |&gt; 
 mutate(collected_all_disease_terms  = 
          stringr::str_replace_all(collected_all_disease_terms,
                                  pattern = 
                                    vec_to_grep_pattern(
                                      c(&quot;morbid obesity&quot;,
                                         &quot;metabolically healthy obesity&quot;
                                        )
                                      ),
                                   &quot;obesity&quot;
                          )  
        )</code></pre>
</div>
<div id="obsessive-compulsive-disorder" class="section level2">
<h2>Obsessive-compulsive disorder</h2>
<pre class="r"><code>gwas_study_info = gwas_study_info |&gt;
  mutate(collected_all_disease_terms  = 
         stringr::str_replace_all(collected_all_disease_terms,
                          vec_to_grep_pattern(c
                                              (&quot;obsessive-compulsive trait&quot;,
                                                &quot;obsessive-compulsive&quot;)
                                              ),
                          &quot;obsessive-compulsive disorder&quot;
         ))</code></pre>
</div>
<div id="occlusion-of-cerebral-arteries" class="section level2">
<h2>Occlusion of cerebral arteries</h2>
<pre class="r"><code># if Brain vascular stenosis in DISEASE/TRAIT, then change vascular brain injury to  occlusion of cerebral arteries

gwas_study_info = gwas_study_info |&gt;
  mutate(collected_all_disease_terms  = 
         ifelse(grepl(&quot;Brain vascular stenosis&quot;, 
                     `DISEASE/TRAIT`,
                     ignore.case = TRUE),
                stringr::str_replace_all(collected_all_disease_terms,
                          vec_to_grep_pattern(&quot;vascular brain injury&quot;),
                          &quot;occlusion of cerebral arteries&quot;
         ),
         collected_all_disease_terms
         )
  )</code></pre>
</div>
<div id="opiod-dependence" class="section level2">
<h2>Opiod dependence</h2>
<pre class="r"><code>gwas_study_info = gwas_study_info |&gt;
  mutate(collected_all_disease_terms  = 
         stringr::str_replace_all(collected_all_disease_terms,
                          vec_to_grep_pattern(c(&quot;heroin dependence&quot;,
                                              &quot;opioid use disorder&quot;)),
                          &quot;opioid dependence&quot;
         ))</code></pre>
</div>
<div id="osteonecrosis" class="section level2">
<h2>Osteonecrosis</h2>
<pre class="r"><code>gwas_study_info = gwas_study_info |&gt;
  mutate(collected_all_disease_terms  = 
         stringr::str_replace_all(collected_all_disease_terms,
                          vec_to_grep_pattern(&quot;idiopathic osteonecrosis of the femoral head&quot;),
                          &quot;osteonecrosis&quot;
         ))

gwas_study_info = gwas_study_info |&gt;
  mutate(collected_all_disease_terms  = 
         stringr::str_replace_all(collected_all_disease_terms,
                          vec_to_grep_pattern(&quot;osteoradionecrosis&quot;),
                          &quot;osteonecrosis&quot;
         ))</code></pre>
</div>
<div id="other-epilepsy" class="section level2">
<h2>Other epilepsy</h2>
<pre class="r"><code>gwas_study_info =
  gwas_study_info |&gt;
  mutate(collected_all_disease_terms  = 
         stringr::str_replace_all(collected_all_disease_terms,
                          vec_to_grep_pattern(
                            c(&quot;mesial temporal lobe epilepsy with hippocampal sclerosis&quot;,
                              &quot;rolandic epilepsy&quot;)
                            ),
                          &quot;epilepsy&quot;
         )) </code></pre>
</div>
<div id="other-and-unspecified-cirrhosis-of-liver"
class="section level2">
<h2>Other and unspecified cirrhosis of liver</h2>
<pre class="r"><code>gwas_study_info = gwas_study_info |&gt;
  mutate(collected_all_disease_terms  = 
         stringr::str_replace_all(collected_all_disease_terms,
                          vec_to_grep_pattern(c(&quot;hepatitis c induced liver cirrhosis&quot;,
                                                &quot;biliary liver cirrhosis&quot;)
                                              ),
                          &quot;other and unspecified cirrhosis of liver&quot;
         ))</code></pre>
</div>
<div id="other-cardiac-conduction-disorders" class="section level2">
<h2>Other cardiac conduction disorders</h2>
<pre class="r"><code>gwas_study_info = gwas_study_info |&gt;
  mutate(collected_all_disease_terms  = 
         stringr::str_replace_all(collected_all_disease_terms,
                          vec_to_grep_pattern(c(&quot;familial long qt syndrome&quot;)
                                              ),
                          &quot;other cardiac conduction disorders&quot;
         ))</code></pre>
</div>
<div id="other-cerebral-degenerations" class="section level2">
<h2>Other cerebral degenerations</h2>
<pre class="r"><code>gwas_study_info = gwas_study_info |&gt;
  mutate(collected_all_disease_terms  = 
         stringr::str_replace_all(collected_all_disease_terms,
                          vec_to_grep_pattern(c(&quot;brain atrophy&quot;,
                                                &quot;hippocampal atrophy&quot;
                                                )
                                              ),
                          &quot;other cerebral degenerations&quot;
         ))</code></pre>
</div>
<div id="other-chronic-nonalcoholic-liver-disease"
class="section level2">
<h2>Other chronic nonalcoholic liver disease</h2>
<pre class="r"><code>gwas_study_info = gwas_study_info |&gt;
  mutate(collected_all_disease_terms  = 
         stringr::str_replace_all(collected_all_disease_terms,
                          vec_to_grep_pattern(c(&quot;non-alcoholic fatty liver disease&quot;
                                                )),
                          &quot;other chronic nonalcoholic liver disease&quot;
         ))</code></pre>
</div>
<div id="other-disorders-of-bone-and-cartilage" class="section level2">
<h2>Other disorders of bone and cartilage</h2>
<pre class="r"><code>other_bone_cartilage_terms &lt;- c(&quot;tietze syndrome&quot;
                               )

gwas_study_info = gwas_study_info |&gt;
  mutate(collected_all_disease_terms  = 
         stringr::str_replace_all(collected_all_disease_terms,
                          pattern = vec_to_grep_pattern(other_bone_cartilage_terms),
                          &quot;other disorders of bone and cartilage&quot;
         )
  )</code></pre>
</div>
<div id="other-disorders-of-eyelids" class="section level2">
<h2>Other disorders of eyelids</h2>
<pre class="r"><code>gwas_study_info = gwas_study_info |&gt;
  mutate(collected_all_disease_terms  = 
         stringr::str_replace_all(collected_all_disease_terms,
                          vec_to_grep_pattern(c(&quot;dermatochalasis&quot;,
                                                &quot;filarial elephantiasis&quot;
                                                )
                                              ),
                          &quot;other disorders of eyelids&quot;
         ))</code></pre>
</div>
<div id="other-disorders-of-iris-and-ciliary-body"
class="section level2">
<h2>Other disorders of iris and ciliary body</h2>
<pre class="r"><code>gwas_study_info = gwas_study_info |&gt;
  mutate(collected_all_disease_terms  = 
         stringr::str_replace_all(collected_all_disease_terms,
                          vec_to_grep_pattern(c(&quot;iris disorder&quot;
                                                )
                                              ),
                          &quot;other disorders of iris and ciliary body&quot;
         ))</code></pre>
</div>
<div id="other-eating-disorders" class="section level2">
<h2>Other eating disorders</h2>
<pre class="r"><code>gwas_study_info = gwas_study_info |&gt;
  mutate(collected_all_disease_terms  = 
         stringr::str_replace_all(collected_all_disease_terms,
                          vec_to_grep_pattern(c(&quot;binge eating&quot;)
                                              ),
                          &quot;other eating disorders&quot;
         ))</code></pre>
</div>
<div id="other-haemoglobinopathies" class="section level2">
<h2>Other haemoglobinopathies</h2>
<pre class="r"><code>gwas_study_info = gwas_study_info |&gt;
  mutate(collected_all_disease_terms  = 
         stringr::str_replace_all(collected_all_disease_terms,
                          vec_to_grep_pattern(&quot;hemoglobin e disease&quot;),
                          &quot;other haemoglobinopathies&quot;
         ))</code></pre>
</div>
<div id="other-paralytic-syndromes" class="section level2">
<h2>Other paralytic syndromes</h2>
<pre class="r"><code>gwas_study_info = gwas_study_info |&gt;
  mutate(collected_all_disease_terms  = 
         stringr::str_replace_all(collected_all_disease_terms,
                          vec_to_grep_pattern(
                            c(&quot;paraplegia&quot;,
                              &quot;quadriplegia&quot;)
                            ),
                          &quot;other paralytic syndromes&quot;
         ))</code></pre>
</div>
<div id="other-specified-degenerative-diseases-of-nervous-system"
class="section level2">
<h2>Other specified degenerative diseases of nervous system</h2>
<pre class="r"><code>gwas_study_info = gwas_study_info |&gt;
  mutate(collected_all_disease_terms  = 
         stringr::str_replace_all(collected_all_disease_terms,
                          vec_to_grep_pattern(c(&quot;corticobasal degeneration disorder&quot;
                                                )
                                              ),
                          &quot;other specified degenerative diseases of nervous system&quot;
         ))

# progressive supranuclear palsy -&gt; Dementia with cerebral degenerations

gwas_study_info = gwas_study_info |&gt;
  mutate(collected_all_disease_terms  = 
         stringr::str_replace_all(collected_all_disease_terms,
                          vec_to_grep_pattern(&quot;progressive supranuclear palsy&quot;),
                          &quot;dementia with cerebral degenerations&quot;
         ))</code></pre>
</div>
<div id="other-specified-inflammatory-liver-diseases"
class="section level2">
<h2>Other specified inflammatory liver diseases</h2>
<pre class="r"><code>gwas_study_info = gwas_study_info |&gt;
  mutate(collected_all_disease_terms  = 
         stringr::str_replace_all(collected_all_disease_terms,
                          vec_to_grep_pattern(c(&quot;primary biliary cholangitis&quot;,
                                                &quot;primary sclerosing cholangitis&quot;
                                                )
                                              ),
                          &quot;non-alcoholic steatohepatitis&quot;
         ))</code></pre>
</div>
<div id="other-specified-retinal-disorders" class="section level2">
<h2>Other specified retinal disorders</h2>
<pre class="r"><code>gwas_study_info = gwas_study_info |&gt;
  mutate(collected_all_disease_terms  = 
         stringr::str_replace_all(collected_all_disease_terms,
                          vec_to_grep_pattern(c(&quot;retinal edema&quot;
                                              )),
                          &quot;other specified retinal disorders&quot;
         ))</code></pre>
</div>
<div id="parkinsons-disease" class="section level2">
<h2>Parkinsons disease</h2>
<pre class="r"><code>gwas_study_info = gwas_study_info |&gt;
  mutate(collected_all_disease_terms  = 
         stringr::str_replace_all(collected_all_disease_terms,
                          vec_to_grep_pattern(&quot;young adult-onset parkinsonism&quot;),
                          &quot;parkinsons disease&quot;
         ))</code></pre>
</div>
<div id="perinatal-jaundice" class="section level2">
<h2>Perinatal jaundice</h2>
<pre class="r"><code>gwas_study_info = gwas_study_info |&gt;
  mutate(collected_all_disease_terms  = 
         stringr::str_replace_all(collected_all_disease_terms,
                          vec_to_grep_pattern(&quot;neonatal jaundice&quot;),
                          &quot;perinatal jaundice&quot;
         ))</code></pre>
</div>
<div id="periodontitis" class="section level2">
<h2>Periodontitis</h2>
<pre class="r"><code>gwas_study_info = gwas_study_info |&gt;
  mutate(collected_all_disease_terms  = 
         stringr::str_replace_all(collected_all_disease_terms,
                          vec_to_grep_pattern(&quot;aggressive periodontitis&quot;),
                          &quot;periodontitis&quot;
         ))</code></pre>
</div>
<div id="phlebitis-and-thrombophlebitis" class="section level2">
<h2>Phlebitis and thrombophlebitis</h2>
<pre class="r"><code>gwas_study_info = gwas_study_info |&gt;
  mutate(collected_all_disease_terms  = 
         stringr::str_replace_all(collected_all_disease_terms,
                          vec_to_grep_pattern(c(&quot;thrombophlebitis&quot;)),
                          &quot;phlebitis and thrombophlebitis&quot;
         ))</code></pre>
</div>
<div id="phobias" class="section level2">
<h2>Phobias</h2>
<pre class="r"><code># social anxiety disorder -&gt; social phobias
gwas_study_info = gwas_study_info |&gt;
  mutate(collected_all_disease_terms  = 
         stringr::str_replace_all(collected_all_disease_terms,
                          vec_to_grep_pattern(&quot;social anxiety disorder&quot;),
                          &quot;social phobias&quot;
         ))

# specific phobia -&gt; Specific \\(isolated\\) phobias

gwas_study_info = gwas_study_info |&gt;
  mutate(collected_all_disease_terms  = 
         stringr::str_replace_all(collected_all_disease_terms,
                          vec_to_grep_pattern(&quot;specific phobia&quot;),
                          &quot;specific \\(isolated\\) phobias&quot;
         ))</code></pre>
</div>
<div id="pigmentary-iris-degeneration" class="section level2">
<h2>Pigmentary iris degeneration</h2>
<pre class="r"><code># where Pigmentary iris degeneration in DISEASE/TRAIT &amp; pubmed id 39024449
# replace abnormality of the eye with pigmentary iris degeneration

gwas_study_info = gwas_study_info |&gt;
  mutate(collected_all_disease_terms  = 
         ifelse(grepl(&quot;Pigmentary iris degeneration&quot;, 
                     `DISEASE/TRAIT`,
                     ignore.case = TRUE) &amp; PUBMED_ID == &quot;39024449&quot;,
                stringr::str_replace_all(collected_all_disease_terms,
                          pattern = &quot;abnormality of the eye&quot;,
                          replacement = &quot;pigmentary iris degeneration&quot;
         ),
         collected_all_disease_terms
         )
  )</code></pre>
</div>
<div id="precocious-puberty" class="section level2">
<h2>Precocious puberty</h2>
<pre class="r"><code>gwas_study_info = gwas_study_info |&gt;
  mutate(collected_all_disease_terms  = 
         stringr::str_replace_all(collected_all_disease_terms,
                          vec_to_grep_pattern(&quot;central precocious puberty&quot;),
                          &quot;precocious puberty&quot;
         ))</code></pre>
</div>
<div id="premature-menopause-and-other-ovarian-failure"
class="section level2">
<h2>Premature menopause and other ovarian failure</h2>
<pre class="r"><code>gwas_study_info = gwas_study_info |&gt;
  mutate(collected_all_disease_terms  = 
         stringr::str_replace_all(collected_all_disease_terms,
                          vec_to_grep_pattern(&quot;premature menopause&quot;),
                          &quot;premature menopause and other ovarian failure&quot;
         ))</code></pre>
</div>
<div id="primary-hyperaldosteronism" class="section level2">
<h2>Primary hyperaldosteronism</h2>
<pre class="r"><code>gwas_study_info = gwas_study_info |&gt;
  mutate(collected_all_disease_terms  = 
         stringr::str_replace_all(collected_all_disease_terms,
                          vec_to_grep_pattern(&quot;primary aldosteronism&quot;),
                          &quot;primary hyperaldosteronism&quot;
         ))</code></pre>
</div>
<div id="primary-ovarian-failure" class="section level2">
<h2>Primary ovarian failure</h2>
<pre class="r"><code>gwas_study_info = gwas_study_info |&gt;
  mutate(collected_all_disease_terms  = 
         stringr::str_replace_all(collected_all_disease_terms,
                          vec_to_grep_pattern(&quot;primary ovarian insufficiency&quot;),
                          &quot;primary ovarian failure&quot;
         ))</code></pre>
</div>
<div id="primary-thrombophilia" class="section level2">
<h2>Primary thrombophilia</h2>
<pre class="r"><code># if DISEASE/TRAIT contains PheCode 286.8
# then replce thrombophilia with primary thrombophilia
gwas_study_info =
  gwas_study_info |&gt;
  mutate(collected_all_disease_terms  = 
         ifelse(grepl(&quot;PheCode 286.8&quot;, 
                     `DISEASE/TRAIT`,
                     ignore.case = TRUE),
                stringr::str_replace_all(collected_all_disease_terms,
                          vec_to_grep_pattern(&quot;thrombophilia&quot;),
                          &quot;primary thrombophilia&quot;
         ),
         collected_all_disease_terms
         )
  )</code></pre>
</div>
<div id="proteinuria" class="section level2">
<h2>Proteinuria</h2>
<pre class="r"><code>gwas_study_info = gwas_study_info |&gt;
  mutate(collected_all_disease_terms  = 
         stringr::str_replace_all(collected_all_disease_terms,
                          vec_to_grep_pattern(c(&quot;albuminuria&quot;,
                                                &quot;moderate albuminuria&quot;)
                                              ),
                          &quot;proteinuria&quot;
         ))</code></pre>
</div>
<div id="prurigo" class="section level2">
<h2>Prurigo</h2>
<pre class="r"><code>gwas_study_info = gwas_study_info |&gt;
  mutate(collected_all_disease_terms  = 
         stringr::str_replace_all(collected_all_disease_terms,
                          vec_to_grep_pattern(&quot;prurigo&quot;),
                          &quot;other prurigo&quot;
         ))</code></pre>
</div>
<div id="psoriasis" class="section level2">
<h2>Psoriasis</h2>
<pre class="r"><code>psoriasis_terms &lt;- c(&quot;cutaneous psoriasis&quot;)


gwas_study_info = gwas_study_info |&gt;
  mutate(collected_all_disease_terms  = 
         stringr::str_replace_all(collected_all_disease_terms,
                          pattern = vec_to_grep_pattern(psoriasis_terms),
                          &quot;psoriasis&quot;)
  )</code></pre>
</div>
<div id="psychosis-pyschotic-pyschotic-symptoms" class="section level2">
<h2>Psychosis (pyschotic, pyschotic symptoms)</h2>
<pre class="r"><code>psychosis_terms &lt;- c(&quot;psychotic&quot;,
                     &quot;psychotic symptoms&quot;
                     )

gwas_study_info = gwas_study_info |&gt;
  mutate(collected_all_disease_terms  = 
         stringr::str_replace_all(collected_all_disease_terms,
                          pattern = vec_to_grep_pattern(psychosis_terms),
                          &quot;psychosis&quot;)
  )</code></pre>
</div>
<div id="pulmonary-fibrosis" class="section level2">
<h2>Pulmonary fibrosis</h2>
<pre class="r"><code>gwas_study_info = gwas_study_info |&gt;
  mutate(collected_all_disease_terms  = 
         stringr::str_replace_all(collected_all_disease_terms,
                          vec_to_grep_pattern(&quot;idiopathic pulmonary fibrosis&quot;),
                          &quot;pulmonary fibrosis&quot;
         ))</code></pre>
</div>
<div id="rash-petechiae" class="section level2">
<h2>Rash, Petechiae</h2>
<pre class="r"><code># for pubmed id: 37469131
# and DISEASE/TRAIT contains &#39;rush&#39; (a tyop of rash)
# replace purpura with rash, petechiae

gwas_study_info = gwas_study_info |&gt;
  mutate(collected_all_disease_terms  = 
         ifelse(PUBMED_ID == 37469131 &amp; grepl(&quot;rush&quot;, `DISEASE/TRAIT`, ignore.case = TRUE),
                stringr::str_replace_all(collected_all_disease_terms,
                          vec_to_grep_pattern(&quot;purpura&quot;),
                          &quot;rash, petechiae&quot;
         ),
         collected_all_disease_terms
         )
  )</code></pre>
</div>
<div id="rash-and-other-nonspecific-skin-eruption"
class="section level2">
<h2>Rash and other nonspecific skin eruption</h2>
<pre class="r"><code>rash_terms &lt;- c(
                &quot;maculopapular eruption&quot;
                )

gwas_study_info = gwas_study_info |&gt;
  mutate(collected_all_disease_terms  = 
         stringr::str_replace_all(collected_all_disease_terms,
                          pattern = vec_to_grep_pattern(rash_terms),
                          &quot;rash and other nonspecific skin eruption&quot;
         )
  )</code></pre>
</div>
<div id="retinoschisis-and-retinoschisis-and-retinal-cysts"
class="section level2">
<h2>Retinoschisis and retinoschisis and retinal cysts</h2>
<pre class="r"><code>gwas_study_info = gwas_study_info |&gt;
  mutate(collected_all_disease_terms  = 
         stringr::str_replace_all(collected_all_disease_terms,
                          vec_to_grep_pattern(&quot;retinoschisis&quot;),
                          &quot;retinoschisis and retinal cysts&quot;
         ))</code></pre>
</div>
<div id="rheumatoid-arthritis" class="section level2">
<h2>Rheumatoid arthritis</h2>
<pre class="r"><code>ra_terms &lt;- c(&quot;acpa-positive rheumatoid arthritis&quot;,
               &quot;acpa-negative rheumatoid arthritis&quot;,
              &quot;adult-onset stills disease&quot;)

gwas_study_info = 
gwas_study_info |&gt; 
 mutate(collected_all_disease_terms  = 
          stringr::str_replace_all(collected_all_disease_terms,
                                  pattern = vec_to_grep_pattern(ra_terms),
                                   &quot;rheumatoid arthritis&quot;
                          )  
        )</code></pre>
</div>
<div id="rhinitis" class="section level2">
<h2>Rhinitis</h2>
<pre class="r"><code>rhinitis_terms &lt;- c(&quot;non-allergic rhinitis&quot;)

gwas_study_info = gwas_study_info |&gt;
  mutate(collected_all_disease_terms  = 
         stringr::str_replace_all(collected_all_disease_terms,
                          pattern = vec_to_grep_pattern(rhinitis_terms),
                          &quot;rhinitis&quot;
         )
  )</code></pre>
</div>
<div id="sciatica" class="section level2">
<h2>Sciatica</h2>
<pre class="r"><code>gwas_study_info = gwas_study_info |&gt;
  mutate(collected_all_disease_terms  = 
         stringr::str_replace_all(collected_all_disease_terms,
                          vec_to_grep_pattern(c(&quot;ldh-related sciatica&quot;)
                                              ),
                          &quot;sciatica&quot;
         )) </code></pre>
</div>
<div id="schizoaffective-disorder" class="section level2">
<h2>Schizoaffective disorder</h2>
<pre class="r"><code>gwas_study_info = gwas_study_info |&gt;
  mutate(collected_all_disease_terms  = 
         stringr::str_replace_all(collected_all_disease_terms,
                          vec_to_grep_pattern(&quot;schizoaffective disorder-bipolar type&quot;),
                          &quot;schizoaffective disorder&quot;)
         )</code></pre>
</div>
<div id="schizophrenia" class="section level2">
<h2>Schizophrenia</h2>
<pre class="r"><code>gwas_study_info = gwas_study_info |&gt;
  mutate(collected_all_disease_terms  = 
         stringr::str_replace_all(collected_all_disease_terms,
                          vec_to_grep_pattern(&quot;treatment refractory schizophrenia&quot;),
                          &quot;schizophrenia&quot;)
         )</code></pre>
</div>
<div id="scoliosis" class="section level2">
<h2>Scoliosis</h2>
<pre class="r"><code>gwas_study_info = gwas_study_info |&gt;
  mutate(collected_all_disease_terms  = 
         stringr::str_replace_all(collected_all_disease_terms,
                          vec_to_grep_pattern(&quot;adolescent idiopathic scoliosis&quot;),
                          &quot;scoliosis&quot;)
         )</code></pre>
</div>
<div id="separation-of-retinal-layers" class="section level2">
<h2>Separation of retinal layers</h2>
<pre class="r"><code>gwas_study_info = gwas_study_info |&gt;
  mutate(collected_all_disease_terms  = 
         stringr::str_replace_all(collected_all_disease_terms,
                          vec_to_grep_pattern(c(&quot;central serous retinopathy&quot;,
                                              &quot;chronic central serous retinopathy&quot;)
                                              ),
                          &quot;separation of retinal layers&quot;
         ))</code></pre>
</div>
<div id="sickle-cell-disease-and-related-diseases"
class="section level2">
<h2>Sickle cell disease and related diseases</h2>
<pre class="r"><code># if DISEASE/TRAIT contains sickle cell disease, change sickle cell disease and related diseases to sickle cell anemia
gwas_study_info = gwas_study_info |&gt;
  mutate(collected_all_disease_terms  = 
         ifelse(grepl(&quot;sickle cell disease&quot;, 
                     `DISEASE/TRAIT`,
                     ignore.case = TRUE),
                stringr::str_replace_all(collected_all_disease_terms,
                          vec_to_grep_pattern(&quot;sickle cell disease and related diseases&quot;),
                          &quot;sickle cell anemia&quot;
         ),
         collected_all_disease_terms
         )
  )</code></pre>
</div>
<div id="sleep-apnea" class="section level2">
<h2>Sleep apnea</h2>
<pre class="r"><code>sleep_apnea_terms &lt;- c(&quot;sleep apnea during non-rem sleep&quot;,
                      &quot;sleep apnea during rem sleep&quot;,
                      &quot;obstructive sleep apnea&quot;)

gwas_study_info = gwas_study_info |&gt;
  mutate(collected_all_disease_terms  = 
         stringr::str_replace_all(collected_all_disease_terms,
                          pattern = vec_to_grep_pattern(sleep_apnea_terms),
                          &quot;sleep apnea&quot;)
  )</code></pre>
</div>
<div id="sleep-disorders" class="section level2">
<h2>Sleep disorders</h2>
<pre class="r"><code>sleep_disorder_terms &lt;- c(&quot;sleepiness&quot;,
                          &quot;somnambulism&quot;,
                          &quot;rem sleep behavior disorder&quot;,
                          &quot;periodic limb movement disorder&quot;,
                          &quot;bruxism&quot;
                         )


gwas_study_info = gwas_study_info |&gt;
  mutate(collected_all_disease_terms  = 
         stringr::str_replace_all(collected_all_disease_terms,
                          pattern = vec_to_grep_pattern(sleep_disorder_terms),
                          &quot;sleep disorders&quot;
         )
  )</code></pre>
</div>
<div id="speech-and-language-disorder" class="section level2">
<h2>Speech and language disorder</h2>
<pre class="r"><code>gwas_study_info = gwas_study_info |&gt;
  mutate(collected_all_disease_terms  = 
         stringr::str_replace_all(collected_all_disease_terms,
                          vec_to_grep_pattern(c(&quot;specific language impairment&quot;,
                                                &quot;language impairment&quot;,
                                                &quot;social communication impairment&quot;
                                                )
                                              ),
                          &quot;speech and language disorder&quot;
         ))

# if DISEASE/TRAIT contains Developmental stuttering
# then replace stuttering with speech and language disorder
gwas_study_info = gwas_study_info |&gt;
  mutate(collected_all_disease_terms  = 
         ifelse(grepl(&quot;Developmental stuttering&quot;, 
                     `DISEASE/TRAIT`,
                     ignore.case = TRUE),
                stringr::str_replace_all(collected_all_disease_terms,
                          vec_to_grep_pattern(&quot;stuttering&quot;),
                          &quot;speech and language disorder&quot;
         ),
         collected_all_disease_terms
         )
  )</code></pre>
</div>
<div id="staphylococcus-infections" class="section level2">
<h2>Staphylococcus infections</h2>
<pre class="r"><code>gwas_study_info = gwas_study_info |&gt;
  mutate(collected_all_disease_terms  = 
         stringr::str_replace_all(collected_all_disease_terms,
                          vec_to_grep_pattern(
                            c(&quot;staphylococcus aureus infection&quot;,
                              &quot;skin and soft tissue staphylococcus aureus infection&quot;,
                              &quot;methicillin-resistant staphylococcus aureus infection&quot;)),
                          &quot;staphylococcus infections&quot;
         ))</code></pre>
</div>
<div id="strabismus" class="section level2">
<h2>Strabismus</h2>
<pre class="r"><code>url &lt;-  &quot;http://www.ebi.ac.uk/ols4/api/ontologies/doid/terms/http%253A%252F%252Fpurl.obolibrary.org%252Fobo%252FDOID_540/descendants&quot;

strabismus_terms &lt;- get_descendants(url)</code></pre>
<pre><code>[1] &quot;Number of terms collected:&quot;
[1] 26
[1] &quot;\n Some example terms&quot;
[1] &quot;abnormal retinal correspondence&quot; &quot;brown&#39;s tendon sheath syndrome&quot; 
[3] &quot;internuclear ophthalmoplegia&quot;    &quot;duane retraction syndrome 3&quot;    
[5] &quot;duane retraction syndrome 2&quot;    </code></pre>
<pre class="r"><code>strabismus_terms = c(&quot;non-accomodative esotropia&quot;,
                     strabismus_terms)

gwas_study_info = gwas_study_info |&gt;
  mutate(collected_all_disease_terms  = 
         stringr::str_replace_all(collected_all_disease_terms,
                          pattern = vec_to_grep_pattern(strabismus_terms),
                          &quot;strabismus&quot;
         ))</code></pre>
</div>
<div id="stroke" class="section level2">
<h2>Stroke</h2>
<pre class="r"><code>other_nonspec_stroke &lt;- c(&quot;large artery stroke&quot;,
                         &quot;small vessel stroke&quot;,
                         &quot;stroke outcome&quot;,
                         &quot;stroke disorder&quot;
                         )

gwas_study_info = gwas_study_info |&gt;
  mutate(collected_all_disease_terms  = 
         stringr::str_replace_all(collected_all_disease_terms,
                          vec_to_grep_pattern(other_nonspec_stroke),
                          &quot;stroke&quot;
         ))</code></pre>
</div>
<div id="stuttering-tics---tics-and-stuttering" class="section level2">
<h2>Stuttering, tics -&gt; Tics and stuttering</h2>
<pre class="r"><code>gwas_study_info = gwas_study_info |&gt;
  mutate(collected_all_disease_terms  = 
         ifelse(grepl(&quot;PheCode 313.2&quot;, 
                     `DISEASE/TRAIT`,
                     ignore.case = TRUE),
                stringr::str_replace_all(collected_all_disease_terms,
                          vec_to_grep_pattern(c(&quot;stuttering, tics&quot;)),
                          &quot;tics and stuttering&quot;
                          ),
         collected_all_disease_terms
)
)


gwas_study_info = gwas_study_info |&gt;
  mutate(collected_all_disease_terms  = 
         ifelse(grepl(&quot;PheCode 333.3&quot;, 
                     `DISEASE/TRAIT`,
                     ignore.case = TRUE),
                stringr::str_replace_all(collected_all_disease_terms,
                          vec_to_grep_pattern(c(&quot;stuttering, tics&quot;)),
                          &quot;tics and choreas&quot;
         ),
         collected_all_disease_terms
))</code></pre>
</div>
<div id="systemic-sclerosis" class="section level2">
<h2>Systemic sclerosis</h2>
<pre class="r"><code>terms &lt;- c(&quot;diffuse scleroderma&quot;,
           &quot;limited scleroderma&quot;,
           &quot;anti-centromere-antibody-positive systemic scleroderma&quot;,
           &quot;anti-topoisomerase-i-antibody-positive systemic scleroderma&quot;)

gwas_study_info = gwas_study_info |&gt;
  mutate(collected_all_disease_terms  = 
         stringr::str_replace_all(collected_all_disease_terms,
                          vec_to_grep_pattern(terms),
                          &quot;systemic sclerosis&quot;
         ))</code></pre>
</div>
<div id="tinea" class="section level2">
<h2>Tinea</h2>
<pre class="r"><code># if DISEASE/TRAIT contains Ringworm, replace tinea with tinea corporis
gwas_study_info = gwas_study_info |&gt;
  mutate(collected_all_disease_terms  = 
         ifelse(grepl(&quot;Ringworm&quot;, 
                     `DISEASE/TRAIT`,
                     ignore.case = TRUE),
                stringr::str_replace_all(collected_all_disease_terms,
                          vec_to_grep_pattern(&quot;tinea&quot;),
                          &quot;tinea corporis&quot;
         ),
         collected_all_disease_terms
         )
  )</code></pre>
</div>
<div id="thyrotoxicosis-with-or-without-goiter" class="section level2">
<h2>Thyrotoxicosis with or without goiter</h2>
<pre class="r"><code>gwas_study_info = gwas_study_info |&gt;
  mutate(collected_all_disease_terms  = 
         stringr::str_replace_all(collected_all_disease_terms,
                          vec_to_grep_pattern(&quot;hyperthyroidism&quot;),
                          &quot;thyrotoxicosis with or without goiter&quot;
         ))</code></pre>
</div>
<div id="treatment-resistant-etc." class="section level2">
<h2>Treatment resistant (etc.)</h2>
<pre class="r"><code>gwas_study_info = gwas_study_info |&gt;
  mutate(collected_all_disease_terms  = 
         stringr::str_remove_all(collected_all_disease_terms,
                       &quot;^treatment-resistant |^treatment resistant |^treatment-resistant &quot;
         ))</code></pre>
</div>
<div id="treatment-resistant-depression" class="section level2">
<h2>Treatment resistant depression</h2>
<pre class="r"><code># if DISEASE/TRAIT contains Treatment resistant depression
# then replace depression with treatment resistant depression
gwas_study_info =
  gwas_study_info |&gt;
  mutate(collected_all_disease_terms  = 
         ifelse(grepl(&quot;Treatment resistant depression&quot;, 
                     `DISEASE/TRAIT`,
                     ignore.case = TRUE),
                stringr::str_replace_all(collected_all_disease_terms,
                          vec_to_grep_pattern(&quot;depression&quot;),
                          &quot;treatment resistant depression&quot;
         ),
         collected_all_disease_terms
         )
  )

gwas_study_info =
  gwas_study_info |&gt;
  mutate(collected_all_disease_terms  = 
         ifelse(grepl(&quot;treatment resistant depression&quot;, 
                     MAPPED_BACKGROUND_TRAIT,
                     ignore.case = TRUE),
                stringr::str_replace_all(collected_all_disease_terms,
                          vec_to_grep_pattern(&quot;depression&quot;),
                          &quot;treatment resistant depression&quot;
         ),
         collected_all_disease_terms
         )
  )</code></pre>
</div>
<div id="type-1-diabetes" class="section level2">
<h2>Type 1 diabetes</h2>
<pre class="r"><code>gwas_study_info = gwas_study_info |&gt;
  mutate(collected_all_disease_terms  = 
         stringr::str_replace_all(collected_all_disease_terms,
                          vec_to_grep_pattern(&quot;latent autoimmune diabetes in adults&quot;),
                          &quot;type 1 diabetes mellitus&quot;
         ))</code></pre>
<div
id="diabetic-foot-neuropathy-type-1-diabetes-mellitus-type-2-diabetes-mellitus"
class="section level4">
<h4>Diabetic foot, neuropathy, type 1 diabetes mellitus, type 2 diabetes
mellitus</h4>
<pre class="r"><code>icd_terms &lt;- c(&quot;type 1 diabetes with foot ulcer&quot;,
               &quot;type 2 diabetes with foot ulcer&quot;,
               &quot;type 1 diabetes with diabetic neuropathy&quot;,
               &quot;type 2 diabetes with diabetic neuropathy&quot;)

icd_replacement &lt;- paste0(icd_terms, collapse = &quot;, &quot;)

gwas_study_info = gwas_study_info |&gt;
  mutate(collected_all_disease_terms  = 
         stringr::str_replace_all(collected_all_disease_terms,
                          vec_to_grep_pattern(&quot;diabetic foot, neuropathy, type 1 diabetes mellitus, type 2 diabetes mellitus&quot;),
                          icd_replacement
         ))</code></pre>
</div>
</div>
<div id="type-2-diabetes-with-a-ophthalmic-manifestations"
class="section level2">
<h2>Type 2 diabetes with a ophthalmic manifestations</h2>
<pre class="r"><code>type_2_eye_terms &lt;- c(&quot;diabetes mellitus type 2 associated cataract&quot;,
                      &quot;diabetic maculopathy, type 2 diabetes mellitus&quot;,
                      &quot;diabetic macular edema, type 2 diabetes mellitus&quot;,
                      &quot;proliferative diabetic retinopathy, type 2 diabetes mellitus&quot;,
                      &quot;macrovascular complications of diabetes, type 2 diabetes mellitus&quot;
                     )

gwas_study_info = gwas_study_info |&gt;
  mutate(collected_all_disease_terms  = 
         stringr::str_replace_all(collected_all_disease_terms,
                          vec_to_grep_pattern(type_2_eye_terms),
                          &quot;type 2 diabetes with ophthalmic manifestations&quot;
         ))

gwas_study_info = gwas_study_info |&gt;
  mutate(collected_all_disease_terms  = 
         stringr::str_replace_all(collected_all_disease_terms,
                          vec_to_grep_pattern(type_2_eye_terms),
                          &quot;type 2 diabetes with ophthalmic manifestations&quot;
         ))

# for 30487263, all discovery samples are type 2 diabetes - so 
# replace proliferative diabetic retinopathy with type 2 diabetes with ophthalmic manifestations
gwas_study_info = gwas_study_info |&gt;
  mutate(collected_all_disease_terms  = 
         ifelse(PUBMED_ID == 30487263,
                stringr::str_replace_all(collected_all_disease_terms,
                          vec_to_grep_pattern(&quot;proliferative diabetic retinopathy&quot;),
                          &quot;type 2 diabetes with ophthalmic manifestations&quot;
         ),
         collected_all_disease_terms
         )
  )

# for pubmed id: 31482010
# all samples are type 2 diabetes
# so replace diabetic retinopathy with type 2 diabetes with ophthalmic manifestations
gwas_study_info = gwas_study_info |&gt;
  mutate(collected_all_disease_terms  = 
         ifelse(PUBMED_ID == 31482010,
                stringr::str_replace_all(collected_all_disease_terms,
                          vec_to_grep_pattern(&quot;proliferative diabetic retinopathy&quot;),
                          &quot;type 2 diabetes with ophthalmic manifestations&quot;
         ),
         collected_all_disease_terms
         )
)

# neuropathic pain, type 2 diabetes mellitus
# change to type 2 diabetes with diabetic neuropathy
gwas_study_info = gwas_study_info |&gt;
  mutate(collected_all_disease_terms  = 
                stringr::str_replace_all(collected_all_disease_terms,
                          vec_to_grep_pattern(&quot;neuropathic pain, type 2 diabetes mellitus&quot;),
                          &quot;type 2 diabetes with ophthalmic manifestations&quot;
         )
  )</code></pre>
</div>
<div
id="unspecified-condition-associated-with-female-genital-organs-and-menstrual-cycle"
class="section level2">
<h2>Unspecified condition associated with female genital organs and
menstrual cycle</h2>
<pre class="r"><code>gwas_study_info = 
  gwas_study_info |&gt;
  mutate(collected_all_disease_terms = 
    ifelse(grepl(&quot;Menstruation&quot;, 
                `DISEASE/TRAIT`,
                 ignore.case = TRUE),
           str_replace_all(collected_all_disease_terms,
                           pattern = vec_to_grep_pattern(&quot;decreased attention&quot;),
                           &quot;unspecified condition associated with female genital organs and menstrual cycle&quot;),
           collected_all_disease_terms
    )
    )</code></pre>
</div>
<div id="uveitis" class="section level2">
<h2>Uveitis</h2>
<pre class="r"><code>uveitis_terms &lt;- c(&quot;anterior uveitis&quot;,
                   &quot;iritis&quot;,
                   &quot;vogt-koyanagi-harada disease&quot;,
                   &quot;birdshot chorioretinopathy&quot;,
                   &quot;multifocal choroiditis&quot;
                   )

gwas_study_info = gwas_study_info |&gt;
  mutate(collected_all_disease_terms  = 
         stringr::str_replace_all(collected_all_disease_terms,
                          pattern = vec_to_grep_pattern(uveitis_terms),
                          &quot;uveitis&quot;
         ))</code></pre>
</div>
<div id="vasculitis" class="section level2">
<h2>Vasculitis</h2>
<pre class="r"><code>gwas_study_info =
  gwas_study_info |&gt;
  mutate(collected_all_disease_terms  = 
                stringr::str_replace_all(collected_all_disease_terms,
                          vec_to_grep_pattern(&quot;anti-neutrophil antibody associated vasculitis&quot;),
                          &quot;vasculitis&quot;
         )
  )</code></pre>
</div>
</div>
<div id="save" class="section level1">
<h1>Save</h1>
<div id="how-many-unique-traits-are-there-now-1" class="section level2">
<h2>How many unique traits are there now?</h2>
<pre class="r"><code>diseases &lt;- stringr::str_split(pattern = &quot;, &quot;,
                               gwas_study_info$collected_all_disease_terms[gwas_study_info$collected_all_disease_terms != &quot;&quot;])  |&gt;
  unlist() |&gt;
  stringr::str_trim()

diseases &lt;- unique(diseases)

print(length(diseases))</code></pre>
<pre><code>[1] 1959</code></pre>
<pre class="r"><code>fwrite(
  gwas_study_info,
  here::here(&quot;output/gwas_cat/gwas_study_all_group.csv&quot;)
  )</code></pre>
<br>
<p>
<button type="button" class="btn btn-default btn-workflowr btn-workflowr-sessioninfo" data-toggle="collapse" data-target="#workflowr-sessioninfo" style="display: block;">
<span class="glyphicon glyphicon-wrench" aria-hidden="true"></span>
Session information
</button>
</p>
<div id="workflowr-sessioninfo" class="collapse">
<pre class="r"><code>sessionInfo()</code></pre>
<pre><code>R version 4.3.1 (2023-06-16)
Platform: aarch64-apple-darwin20 (64-bit)
Running under: macOS 15.7.3

Matrix products: default
BLAS:   /Library/Frameworks/R.framework/Versions/4.3-arm64/Resources/lib/libRblas.0.dylib 
LAPACK: /Library/Frameworks/R.framework/Versions/4.3-arm64/Resources/lib/libRlapack.dylib;  LAPACK version 3.11.0

locale:
[1] en_US.UTF-8/en_US.UTF-8/en_US.UTF-8/C/en_US.UTF-8/en_US.UTF-8

time zone: America/Los_Angeles
tzcode source: internal

attached base packages:
[1] stats     graphics  grDevices datasets  utils     methods   base     

other attached packages:
[1] jsonlite_2.0.0    httr_1.4.7        data.table_1.17.8 stringr_1.6.0    
[5] dplyr_1.1.4       workflowr_1.7.1  

loaded via a namespace (and not attached):
 [1] compiler_4.3.1      BiocManager_1.30.26 renv_1.0.3         
 [4] promises_1.3.3      tidyselect_1.2.1    Rcpp_1.1.0         
 [7] git2r_0.36.2        callr_3.7.6         later_1.4.4        
[10] jquerylib_0.1.4     yaml_2.3.10         fastmap_1.2.0      
[13] here_1.0.1          R6_2.6.1            generics_0.1.4     
[16] curl_7.0.0          knitr_1.50          tibble_3.3.0       
[19] rprojroot_2.1.0     bslib_0.9.0         pillar_1.11.1      
[22] rlang_1.1.6         cachem_1.1.0        stringi_1.8.7      
[25] httpuv_1.6.16       xfun_0.55           getPass_0.2-4      
[28] fs_1.6.6            sass_0.4.10         cli_3.6.5          
[31] withr_3.0.2         magrittr_2.0.4      ps_1.9.1           
[34] digest_0.6.37       processx_3.8.6      rstudioapi_0.17.1  
[37] lifecycle_1.0.4     vctrs_0.6.5         evaluate_1.0.5     
[40] glue_1.8.0          whisker_0.4.1       rmarkdown_2.30     
[43] tools_4.3.1         pkgconfig_2.0.3     htmltools_0.5.8.1  </code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>


<!-- Adjust MathJax settings so that all math formulae are shown using
TeX fonts only; see
https://docs.mathjax.org/en/latest/web/configuration.html. This will make
the presentation more consistent at the cost of the webpage sometimes
taking slightly longer to load. Note that this only works because the
footer is added to webpages before the MathJax javascript. -->
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    "HTML-CSS": { availableFonts: ["TeX"] }
  });
</script>




</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->

<script>
$(document).ready(function ()  {

    // temporarily add toc-ignore selector to headers for the consistency with Pandoc
    $('.unlisted.unnumbered').addClass('toc-ignore')

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
