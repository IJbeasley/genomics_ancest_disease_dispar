---
title: "Global burden of disease statistics"
author: "Isobel Beasley"
date: "2025-09-11"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```


```{r setup_packages}

library(data.table)
library(dplyr)
library(ggplot2)
library(stringr)

```

# Global burden of disease statistics

```{r load_data}

gbd_data <- data.table::fread(here::here("data/gbd/IHME-GBD_2021_DATA-aa22a7fd-1.csv"))

```


## Top non-communicable diseases by DALYs (2019)

```{r}

top_non_comm_diseases = 
  gbd_data |>
  slice_max(n = 15, order_by = val) |>
  pull(cause)

print(top_non_comm_diseases)

```

### Global disease burden - top 15 non-communicable diseases by DALYs (2019)

```{r}

gbd_data |>
slice_max(n = 15, order_by = val) |>
ggplot(aes(x = reorder(cause, val), y = val)) +
  geom_col(fill = "steelblue") +
  geom_errorbar(aes(ymin = lower, ymax = upper), width = 0.3) +
  coord_flip() +
  labs(
    x = "Disease",
    y = "DALYs (rate per 100,000)",
    title = "Non-communicable diseases with the greatest global disease durden (DALYs - 2019)"
  ) +
  theme_minimal(base_size = 14)

```
## Distribution of DALYs (rate per 100,000) for non-communicable diseases (2019)


```{r}

gbd_data |>
  ggplot(aes(x = val)) +
  geom_histogram(bins = 30, fill = "steelblue", color = "black") +
  labs(
    x = "DALYs (rate per 100,000)",
    y = "# non-communicable diseases",
    title = "Distribution of DALYs (rate per 100,000) for non-communicable diseases (2019)"
  ) +
  theme_minimal(base_size = 14)


```


# Population Attributable Fraction (PAF) for risk factors for non-communicable diseases (2021)

## Load PAF data + intergrate with DALY data

```{r}

gbd_paf_data <- data.table::fread(here::here(paste0("data/gbd/IHME-GBD_2021_DATA-923822a5-1.csv")))

gbd_paf_data |> head()

gbd_paf_data =
left_join(gbd_paf_data,
          gbd_data |> select(cause, daly_rate = val)) |>
  mutate(across(c(val, lower, upper), ~ ifelse(.x < 0, 0, .x))) |>
  mutate(paf_total = daly_rate * (1- val)) |>
  mutate(paf_total_lower = daly_rate * (1-lower)  ) |>
  mutate(paf_total_upper = daly_rate * (1-upper)  ) 

```


### Top 25 non-communicable diseases by % DALYs explained by all risk factors (2019)

```{r}
gbd_paf_data |>
  slice_max(n = 25, order_by = val) |>
  ggplot(aes(y = val, x = reorder(cause, val))) + 
  geom_col(fill = "steelblue") +
  theme_bw() +
  geom_errorbar(aes(ymin = lower, ymax = upper), width = 0.3) +
  coord_flip() +
  labs(y = "% DALYs explained by all risk factors",
       x = "Disease"
       )


```


### Top 15 non-communicable diseases by DALYs not explained by measured environmental risk factors (2019)

```{r}

gbd_paf_data |>
  slice_max(n = 15, order_by = paf_total) |>
  ggplot(aes(y= paf_total, x = reorder(cause, paf_total))) +
  geom_col(fill = "steelblue") +
  theme_bw() +
  geom_errorbar(aes(ymin = paf_total_lower, 
                    ymax = paf_total_upper), width = 0.3) +
  coord_flip() +
  labs(y = "DALYs (rate per 100,000) not explained by measured environmental risk factors",
       x = "Disease",
       title = "Non-communicable diseases with the greatest global disease durden (DALYs - 2019)")


```

### Distribution of DALYs not explained by measured environmental risk factors (2019)
```{r}

gbd_paf_data |>
  ggplot(aes(x = paf_total)) +
  geom_histogram(bins = 30, fill = "steelblue", color = "black") +
  labs(
    x = "DALYs (rate per 100,000) not explained by measured environmental risk factors",
    y = "# non-communicable diseases",
    title = "Distribution of DALYs (rate per 100,000) not explained by measured environmental risk factors (2019)"
  ) +
  theme_minimal(base_size = 14)

```


### Dalys not explained by measured environmental risk factors for top non-communicable diseases by DALYs (2019)

```{r}

gbd_paf_data |>
  filter(cause %in% top_non_comm_diseases) |>
  ggplot(aes(x= reorder(cause, daly_rate), y = paf_total)) +
  geom_col(fill = "steelblue") +
  theme_bw() +
  coord_flip() +
  labs(y = "DALYs (rate per 100,000)",
       x = "Disease",
       title = "DALYs (rate per 100,000) for top non-communicable diseases (2019)")
 
```
